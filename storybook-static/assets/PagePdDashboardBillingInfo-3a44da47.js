import{f as q,G as i,H as j,K as s,Y as K,P as U,S as B,N as L,b as Q,e as r,Q as S,R as u,J as y,U as c,A as d,I,L as W,M as J,O as X,F as Z}from"./vue.esm-bundler-33967e91.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";import{u as V,fM as ee,a2 as ae,fN as ne,fO as le,fP as A,fQ as te,aY as z,fR as O,ft as oe,fS as re,bD as ie,fK as se,by as ue,ev as de}from"./ModalPvLimitAlertView-cb9178ae.js";import{P as ce,d as pe,a as me}from"./PdSectionTitle-5e0aef1e.js";import{u as fe}from"./vue-i18n.cjs-bd62fc86.js";import{u as D,B as ge}from"./BasicModal-000dc82b.js";import"./ModalUpgradeRequired-a455cfd7.js";import"./PfButton-db6d6722.js";import"./PfIconContext-bd54ca9b.js";import"./_commonjsHelpers-042e6b4d.js";import"./lodash-bf1bac5c.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./iframe-4066d2cc.js";import"../sb-preview/runtime.js";import"./PfIcon-bb1c3c10.js";import"./mapValues-a1d744f5.js";const H=q({props:{size:{type:String,default:"medium",required:!1},type:{type:String,default:"default",required:!1},plain:{type:Boolean,default:!1,required:!1},loading:{type:Boolean,default:!1,required:!1},disabled:{type:Boolean,default:!1,required:!1},current:{type:Boolean,default:!1,required:!1},round:{type:Boolean,default:!1,required:!1},icon:{type:String,default:"",required:!1},width:{type:String,required:!1}},computed:{styles(){const a=`var(--color-${this.type}-main)`,n=`var(--color-${this.type}-main-hover)`,o=`var(--color-${this.type}-alpha-hover)`,m=`var(--color-${this.type}-text)`,f=`var(--color-${this.type}-text-hover)`,p=this.plain?{"border-width":"1px","--color":a,"--color-hover":n,"--border":a,"--background":"transparent","--background-hover":o}:{},k=this.current?{"pointer-events":"none"}:{},b=this.type==="studio"?{"--border":"transparent","--border-hover":"transparent","--box-shadow":"var(--box-shadow-pink)"}:{},v=this.type==="default"?{"--color":"var(--color-default-text)","--color-hover":"var(--color-default-text-hover)","border-width":"1px","--border":"#363636","--border-hover":"var(--color-default-main-hover)","--background":"transparent","--background-hover":"var(--color-default-alpha-hover)"}:{},h=[{id:"medium",fontSize:"14px"},{id:"small",fontSize:"12px"},{id:"mini",fontSize:"10px"}].find(C=>C.id===this.size),_=h&&h.fontSize;return{width:this.width,"--color":m,"--color-hover":f,"--border":a,"--border-hover":n,"--background":a,"--background-hover":n,fontSize:_,...p,...k,...b,...v}},spinnerStyle(){const a=`var(--color-${this.type}-text)`,n=`var(--color-${this.type}-main)`,o=this.plain?n:a;return{borderLeftColor:o,borderTopColor:o}}},watch:{loading(a){}}});const ye=["data-type","disabled"],ve={class:"text"},he={class:"spinner-wrap"};function _e(a,n,o,m,f,p){return i(),j("button",{class:L(["BaseButton button",{loading:a.loading,round:a.round}]),"data-type":a.type,style:U(a.styles),disabled:a.disabled||a.loading},[s("span",ve,[K(a.$slots,"default",{},void 0,!0)]),s("span",he,[a.loading?(i(),j("span",{key:0,style:U(a.spinnerStyle),class:"spinner"},null,4)):B("",!0)])],14,ye)}const M=N(H,[["render",_e],["__scopeId","data-v-3cc42983"]]);H.__docgenInfo={exportName:"default",displayName:"BaseButton",description:"",tags:{},props:[{name:"size",values:["medium","small","mini"],type:{name:"string"},required:!1,defaultValue:{func:!1,value:"'medium'"}},{name:"type",type:{name:"ColorTypeEnum | 'text'"},required:!1,defaultValue:{func:!1,value:"'default'"}},{name:"plain",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"loading",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"disabled",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"current",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"round",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"icon",type:{name:"string"},required:!1,defaultValue:{func:!1,value:"''"}},{name:"width",type:{name:"string"},required:!1}],slots:[{name:"default"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Pd/common/BaseButton.vue"]};const Be=a=>(W("data-v-41a5642f"),a=a(),J(),a),be={class:"ModalChangeProjectBillingUser"},Ce={class:"modal-title"},Pe=Be(()=>s("div",{class:"change-card"},[s("i",{class:"icon material-icons"},"arrow_forward")],-1)),we={key:0,class:"_mb-20 _flex _items-center _justify-end _gap-8"},$e={class:"btn-wrap"},x=q({__name:"ModalChangeProjectBillingUser",props:{currentBilling:{}},setup(a){const{account:n}=V(),{projectPlan:o}=ee(),m=D(),{t:f}=fe(),p=ae("projectId"),{changeBillingOwner:k}=ne(),{changeTeamProjectBillingOwner:b}=le(),{isSameCurrencyWithCurrentPlan:v}=A(),{changeableTeamBillings:h,selectedBillingType:_}=te(),{project:C}=z(),P=Q(!1),T=r(()=>!!(n.value.myBilling&&n.value.myBilling.country&&Array.isArray(n.value.myBilling.cards)&&n.value.myBilling.cards[0])),e=r(()=>T.value?{name:n.value.name,email:n.value.email,avatar:n.value.avatar,cards:n.value.myBilling?.cards,accountId:n.value.id,country:n.value.myBilling?.country}:void 0),w=r(()=>C.value.billing_owner_user_id),$=r(()=>[...!e.value||e.value.country&&v(e.value.country)?[{id:"user",label:f("My Account"),accountId:n.value.id}]:[],...h.value.map(t=>({...t,id:t.teamId,label:t.teamName,accountId:t.accountId}))].filter(t=>t.accountId!==w.value).map(t=>({id:t.id,label:t.label}))),g=r(()=>$.value.find(l=>l.id===_.value)??$.value[0]),G=r(()=>{if(g.value?.id==="user")return e.value;const l=h.value.find(t=>t.teamId===g.value?.id);if(l)return{...l,name:l?.teamName}}),R=l=>{const t=re(o.value.currency);l!==t&&m.push("ModalConfirmdifferentCurrency")},Y=l=>{_.value=l.id},E=async()=>{const l=f("Project billing owner has been changed.");if(P.value=!0,!!g.value?.id)try{g.value?.id==="user"?await k({projectId:p.value}):await b({projectId:p.value,teamId:g.value.id}),ie({type:"success",text:l,duration:4e3}),m.pop()}catch(t){console.log(t)}finally{P.value=!1}};return(l,t)=>(i(),S(ge,{name:"ModalChangeProjectBillingUser"},{default:u(()=>[s("div",be,[s("h1",Ce,y(l.$t("Change Project Billing Owner")),1),c(O,{billing:l.currentBilling,title:l.$t("Current Billing Owner")},null,8,["billing","title"]),Pe,d($).length>1?(i(),j("div",we,[s("p",null,y(l.$t("Select Billing Account")),1),d(g)?(i(),S(oe,{key:0,options:d($),value:d(g),class:"_min-w-[128px] _max-w-[258px]",onChange:Y},null,8,["options","value"])):B("",!0)])):B("",!0),c(O,{billing:d(G),title:l.$t("New Billing Owner"),onOnSelectCountry:R},null,8,["billing","title"]),s("div",$e,[c(M,{"data-test":"cancel",type:l.$_enum.ColorType.Info,plain:!0,size:"small",disabled:d(P),onClick:l.$modal.pop},{default:u(()=>[I(y(l.$t("Cancel")),1)]),_:1},8,["type","disabled","onClick"]),c(M,{"data-test":"submit",type:l.$_enum.ColorType.Studio,size:"small",disabled:!d(T),loading:d(P),onClick:E},{default:u(()=>[I(y(l.$t("Change Billing Owner")),1)]),_:1},8,["type","disabled","loading"])])])]),_:1}))}});const Se=N(x,[["__scopeId","data-v-41a5642f"]]);x.__docgenInfo={exportName:"default",displayName:"ModalChangeProjectBillingUser",description:"",tags:{},props:[{name:"currentBilling",required:!0,type:{name:"BillingUserType"}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Pd/PdDashboard/PageBillingInfo/ModalChangeProjectBillingUser.vue"]};const Ie={id:"PagePdDashboardBillingInfo"},je={class:"billing-wrap-flex"},ke={class:"container"},Me={key:1,class:"_flex _gap-8"},F=q({__name:"PagePdDashboardBillingInfo",setup(a){const n=A(),{account:o}=V(),{project:m,projectBilling:f}=z(),p=D();n.reload();const k=r(()=>f.value?n.changeableTeamBillings.length>0:!1);r(()=>!!!m.value.current_plan?.plan||m.value.current_plan?.plan===de.Free);const b=r(()=>m.value.billing_owner_user_id),v=r(()=>(console.log("projectBilling.value",f.value),f.value)),h=r(()=>b.value===o.value.id),_=r(()=>!!(o.value.myBilling&&o.value.myBilling.country&&Array.isArray(o.value.myBilling.cards)&&o.value.myBilling.cards[0])),C=r(()=>[{accountId:o.value.id,...o.value.myBilling},...n.changeableTeamBillings].some(e=>e.accountId!==b.value&&n.isSameCurrencyWithCurrentPlan(e?.country))),P=()=>{p.pop(),p.push("ModalChangeProjectBillingUser")},T=()=>{p.pop(),p.push("ModalChangeProjectBillingUser")};return(e,w)=>{const $=X("CanUse");return i(),j("div",Ie,[c(d(me),null,{default:u(()=>[c(d(ce),null,{default:u(()=>[I(y(e.$t("Billing Info")),1)]),_:1}),s("div",null,[c($,{permission:e.$_enum.PermissionType.ProductOwner},{no:u(()=>[c(d(pe),null,{default:u(()=>[s("p",null,y(e.$t("You need Owner permission to view and change the settings.")),1)]),_:1})]),yes:u(()=>[s("div",je,[s("div",ke,[v.value?(i(),S(O,{key:0,billing:v.value,"data-test":"projectBillingV2",title:e.$t("Billing Owner")},null,8,["billing","title"])):B("",!0),h.value?(i(),j("div",Me,[k.value?(i(),S(M,{key:0,type:e.$_enum.ColorType.Cancel,width:"auto","data-test":"change-card",onClick:T},{default:u(()=>[I(y(e.$t("Switch to team payment")),1)]),_:1},8,["type"])):B("",!0),c(M,{type:e.$_enum.ColorType.Cancel,width:"auto","data-test":"change-card",onClick:w[0]||(w[0]=g=>e.$store.dispatch("v2/showAccountModal"))},{default:u(()=>[I(y(e.$t("Change credit card information")),1)]),_:1},8,["type"])])):(i(),j(Z,{key:2},[c(M,{type:e.$_enum.ColorType.Cancel,"min-width":"310px",width:"auto",disabled:!C.value&&_.value,"data-test":"change-project-billing-user",onClick:w[1]||(w[1]=g=>e.$modal.push("ModalChangeProjectBillingUser"))},{default:u(()=>[I(y(e.$t("Asign myself as a billing owner")),1)]),_:1},8,["type","disabled"]),!C.value&&_.value?(i(),S(se,{key:0,text:e.$t("You can not change the currency in the current project.")},null,8,["text"])):B("",!0),c(ue,{name:"ModalConfirmdifferentCurrency","raw-msg":e.$t("Sorry, you cannot become the Billing Owner of this project due to the different settlement currency."),"ok-label":"OK","ok-label-color":"green","show-cancel":!1,onConfirm:P},null,8,["raw-msg"])],64)),v.value?(i(),S(Se,{key:3,"current-billing":v.value},null,8,["current-billing"])):B("",!0)])])]),_:1},8,["permission"])])]),_:1})])}}});const Ke=N(F,[["__scopeId","data-v-9f29eadc"]]);F.__docgenInfo={exportName:"default",displayName:"PagePdDashboardBillingInfo",description:"",tags:{},sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Pd/PdDashboard/PageBillingInfo/PagePdDashboardBillingInfo.vue"]};export{Ke as default};
