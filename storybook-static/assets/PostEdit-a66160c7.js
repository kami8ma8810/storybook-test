import{b,f as ee,e as T,O as te,a7 as Me,H as y,K as e,N as Q,A as s,U as R,_ as me,J as E,F as le,G as n,L as $e,M as Ie,S as D,o as Pe,W as V,w as X,aa as Te,Q as H,R as Z,V as ft,P as se,x as he,Z as Ce,$ as Xe,a8 as Ee,I as Ye,n as Rt,q as dt,a9 as kt,g as st,p as lt,Y as Yo,ad as qe,h as Zo,T as Fe,s as en}from"./vue.esm-bundler-33967e91.js";import{d_ as We,d$ as Pt,e0 as wt,ay as tn,G as Ue,bI as $t,$ as Ve,dy as Mt,X as on,bu as nn,cD as sn,e1 as ln,cE as an,aA as rn,cN as ct,aB as dn,aC as un,aD as cn,R as at,e2 as It,bq as mn,b8 as vt,a0 as Nt,s as _t,e3 as gt,cO as ht,e4 as pn,e5 as At,aO as fn,e6 as vn,e7 as _n,aQ as Bt,aT as mt,e8 as gn,e9 as hn,aR as yn,aS as bn,dc as Ge,c4 as Cn,aG as kn,dQ as Pn,cf as xt,aY as Dt,dh as Ne,dO as wn,dK as $n,dJ as In,ea as Sn,dL as Tn,eb as En,dw as Fn,ec as Rn,dx as Mn,dz as it,ed as Nn,ee as An,aq as yt,db as St,ef as ut,eg as Oe,ds as ze,d8 as Tt,dt as Bn,du as xn,dv as Dn,dA as Hn,bp as Ht,dD as qn,eh as qt,bT as Lt,dB as Ut,ei as Ln,ej as Un,dC as Et,d4 as On,bD as zn,cg as Kn,ek as jn,dH as Gn,dI as Wn,el as Vn,em as Jn,bY as He,d9 as Qn,dN as Xn,en as Yn,eo as pt,di as Zn,dj as es,dk as ts,ep as os,eq as ns,f as ss,dT as ls,dU as as,bG as is,er as rs,dX as ds}from"./ModalPvLimitAlertView-cb9178ae.js";import{u as us,P as Ot,a as cs}from"./ModalUpgradeRequired-a455cfd7.js";import{u as ms}from"./draggable-203bb716.js";import{P as ce,H as nt,i as Le,I as zt,J as ps,_ as fs,c as vs,K as _s,L as Kt,D as gs,E as hs,y as ys,o as bs,p as Cs,q as ks,r as Ps,t as ws,S as $s,N as Is,f as jt,O as Gt,Q as Ss,R as Ts,k as Es}from"./SelectSwitch-b6107958.js";import{g as Fs,a1 as Rs,N as Ms,a2 as Ns,X as Wt,$ as As,a0 as Bs}from"./tiptap-extension-paragraph.esm-72054cce.js";import{l as Vt}from"./lodash-bf1bac5c.js";import{_ as ie}from"./_plugin-vue_export-helper-c27b6911.js";import{u as xe}from"./vue-i18n.cjs-bd62fc86.js";import{u as xs}from"./BasicModal-000dc82b.js";const Ds=()=>{const t=b(null),f=b(We),o=b(We),r=b(!1),u=()=>{o.value=We,f.value=We};return ms(t,{start:()=>{r.value=!0},change:({x:d})=>{o.value=f.value-d,o.value<Pt?o.value=Pt:o.value>wt&&(o.value=wt)},end:()=>{f.value=o.value,setTimeout(()=>{r.value=!1},100)}}),{handleRef:t,isChangingPostEditRightWidth:r,changedPostEditRightWidth:o,resetPostEditRightWidth:u}},De=t=>($e("data-v-359794fc"),t=t(),Ie(),t),Hs=De(()=>e("i",{class:"material-icons"},"add",-1)),qs=[Hs],Ls={key:0},Us=De(()=>e("i",{class:"material-icons"},"code",-1)),Os=[Us],zs={key:1},Ks=De(()=>e("i",{class:"material-icons"},"insert_photo",-1)),js=[Ks],Gs={key:2},Ws=De(()=>e("i",{class:"material-icons"},"toc",-1)),Vs=[Ws],Js={key:3},Qs={key:4,class:"material-icons"},Xs={key:0},Ys={key:1},Zs={key:2},el=De(()=>e("i",{class:"material-icons"},"format_list_bulleted",-1)),tl=[el],ol={key:3},nl=De(()=>e("i",{class:"material-icons"},"format_list_numbered",-1)),sl=[nl],ll={key:4},al=De(()=>e("i",{class:"material-icons"},"format_quote",-1)),il=[al],rl={key:5},dl=De(()=>e("i",{class:"material-icons"},"code",-1)),ul=[dl],cl={key:6,class:"material-icons"},Jt=ee({__name:"BlockPanelFloatingButton",props:{isEmpty:{type:Boolean,required:!0},currentNodeName:{type:String,required:!0}},emits:["toggleMenu","toggleTagMenu"],setup(t,{emit:f}){const o=t,r=f,u=T(()=>{const l=tn[o.currentNodeName];return l?l.charAt(0).toUpperCase()+l.slice(1):""}),d=T(()=>["embed_code","figure","table_of_contents","table"].includes(o.currentNodeName));return(l,v)=>{const i=te("PfIcon"),g=Me("tooltip");return t.isEmpty&&t.currentNodeName==="paragraph"?(n(),y("div",{key:0,class:"opener-block",onClick:v[0]||(v[0]=h=>r("toggleMenu"))},qs)):(n(),y(le,{key:1},[e("div",{key:"bar",class:Q(["bar",{isTable:t.currentNodeName==="table"}])},null,2),s(d)?(n(),y("div",{key:0,class:"tag-label",onClick:v[1]||(v[1]=h=>r("toggleTagMenu"))},[t.currentNodeName==="embed_code"?(n(),y("p",Ls,Os)):t.currentNodeName==="figure"?(n(),y("p",zs,js)):t.currentNodeName==="table_of_contents"?(n(),y("p",Gs,Vs)):t.currentNodeName==="table"?(n(),y("p",Js,[R(i,{class:"_pointer-events-none",icon:"addTable",size:"20","icon-color":"gray-500"})])):(n(),y("i",Qs,"drag_indicator"))])):me((n(),y("div",{key:1,class:"tag-label",onClick:v[2]||(v[2]=h=>r("toggleTagMenu"))},[t.currentNodeName==="paragraph"?(n(),y("p",Xs,E(s(u)),1)):/^heading\d/.test(t.currentNodeName)?(n(),y("p",Ys,E(s(u)),1)):t.currentNodeName==="bullet_list"?(n(),y("p",Zs,tl)):t.currentNodeName==="ordered_list"?(n(),y("p",ol,sl)):t.currentNodeName==="blockquote"?(n(),y("p",ll,il)):t.currentNodeName==="code_block"?(n(),y("p",rl,ul)):(n(),y("i",cl,"drag_indicator"))])),[[g,l.$t("TOOLTIP:CHANGE_FORMAT"),void 0,{top:!0}]])],64))}}});const ml=ie(Jt,[["__scopeId","data-v-359794fc"]]);Jt.__docgenInfo={exportName:"default",displayName:"BlockPanelFloatingButton",description:"",tags:{},props:[{name:"isEmpty",type:{name:"boolean"},required:!0},{name:"currentNodeName",type:{name:"RichtextTagNameType"},required:!0}],events:[{name:"toggleMenu"},{name:"toggleTagMenu"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/BlockPanel/BlockPanelFloatingButton.vue"]};const pl=()=>{const t=Ue();return{isBeta:T(()=>t.getters["studioProduct/isComponentInRichTextBeta"])}},ke=t=>($e("data-v-e3e43383"),t=t(),Ie(),t),fl={class:"add-menu"},vl={class:"menu__button"},_l=ke(()=>e("i",{class:"material-icons"},"insert_photo",-1)),gl=ke(()=>e("i",{class:""},[e("svg",{width:"25",height:"25"},[e("use",{href:"#i-25-custom"})])],-1)),hl=ke(()=>e("i",{class:"material-icons"},"format_list_bulleted",-1)),yl=ke(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},"-"),e("span",{class:"item"},"Space")],-1)),bl=ke(()=>e("i",{class:"material-icons"},"format_list_numbered",-1)),Cl=ke(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},"1."),e("span",{class:"item"},"Space")],-1)),kl=ke(()=>e("i",null,"H2",-1)),Pl=ke(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},"##"),e("span",{class:"item"},"Space")],-1)),wl=ke(()=>e("i",null,"H3",-1)),$l=ke(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},"###"),e("span",{class:"item"},"Space")],-1)),Il=ke(()=>e("i",{class:"material-icons"},"format_quote",-1)),Sl=ke(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},">"),e("span",{class:"item"},"Space")],-1)),Tl=ke(()=>e("i",{class:"material-icons"},"remove",-1)),El=ke(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},"---")],-1)),Fl=ke(()=>e("i",{class:"material-icons"},"toc",-1)),Rl=ke(()=>e("i",{class:"material-icons"},"widgets",-1)),Qt=ee({__name:"BlockPanelMenuAdd",props:{editor:{type:Object,default:null,required:!0},isEditingFigure:{type:Boolean}},emits:["commandHandler","setFocusPanel","closeMenu"],setup(t,{emit:f}){const o=t,r=f,{isBeta:u}=pl(),d=()=>{o.editor.commands.createEmbedCode({src:""}),r("closeMenu"),requestAnimationFrame(()=>r("setFocusPanel",ce.EmbedPanel))},l=()=>{o.editor.commands.createStudioComponent({refUuid:""}),r("closeMenu")},v=async i=>{i.preventDefault(),o.editor.commands.addImage(i),r("closeMenu")};return(i,g)=>{const h=te("PfIcon"),p=Me("click-outside");return me((n(),y("div",fl,[e("button",vl,[_l,e("p",null,E(i.$t("CMS Menu: Image")),1),e("input",{type:"file",onChange:g[0]||(g[0]=C=>v(C))},null,32)]),e("button",{class:"menu__button",onClick:g[1]||(g[1]=C=>d())},[gl,e("p",null,E(i.$t("CMS Menu: Embed Block")),1)]),e("button",{class:"menu__button",onClick:g[2]||(g[2]=C=>r("commandHandler","insertTable"))},[R(h,{class:"_pointer-events-none",icon:"addTable",size:"24","icon-color":"gray-600"}),e("p",null,E(i.$t("CMS Menu: Table")),1)]),e("button",{class:"menu__button",onClick:g[3]||(g[3]=C=>r("commandHandler","toggleBulletList"))},[hl,e("p",null,E(i.$t("CMS Menu: Bulleted List")),1),yl]),e("button",{class:"menu__button",onClick:g[4]||(g[4]=C=>r("commandHandler","toggleOrderedList"))},[bl,e("p",null,E(i.$t("CMS Menu: Numbered List")),1),Cl]),e("button",{class:"menu__button",onClick:g[5]||(g[5]=C=>r("commandHandler","setHeading2"))},[kl,e("p",null,E(i.$t("CMS Menu: Heading 2")),1),Pl]),e("button",{class:"menu__button",onClick:g[6]||(g[6]=C=>r("commandHandler","setHeading3"))},[wl,e("p",null,E(i.$t("CMS Menu: Heading 3")),1),$l]),e("button",{class:"menu__button",onClick:g[7]||(g[7]=C=>r("commandHandler","setBlockquote"))},[Il,e("p",null,E(i.$t("CMS Menu: Quote")),1),Sl]),e("button",{class:"menu__button",onClick:g[8]||(g[8]=C=>r("commandHandler","setHorizontalRule"))},[Tl,e("p",null,E(i.$t("CMS Menu: Horizontal rule")),1),El]),e("button",{class:"menu__button",onClick:g[9]||(g[9]=C=>r("commandHandler","createTableOfContents"))},[Fl,e("p",null,E(i.$t("CMS Menu: Table Of Contents")),1)]),s(u)?(n(),y("button",{key:0,class:"menu__button",onClick:g[10]||(g[10]=C=>l())},[Rl,e("p",null,E(i.$t("CMS Menu: Component")),1)])):D("",!0)])),[[p,()=>r("closeMenu")]])}}});const Ml=ie(Qt,[["__scopeId","data-v-e3e43383"]]);Qt.__docgenInfo={exportName:"default",displayName:"BlockPanelMenuAdd",description:"",tags:{},props:[{name:"editor",type:{name:"Editor"},required:!0,defaultValue:{func:!1,value:"null"}},{name:"isEditingFigure",type:{name:"boolean"}}],events:[{name:"commandHandler",type:{names:["Command"]}},{name:"setFocusPanel",type:{names:["PanelTypeEnum"]}},{name:"closeMenu"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/BlockPanel/BlockPanelMenuAdd.vue"]};const we=t=>($e("data-v-ea19ade7"),t=t(),Ie(),t),Nl=we(()=>e("i",null,"P",-1)),Al=we(()=>e("i",null,"H1",-1)),Bl=we(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},"#"),e("span",{class:"item"},"Space")],-1)),xl=we(()=>e("i",null,"H2",-1)),Dl=we(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},"##"),e("span",{class:"item"},"Space")],-1)),Hl=we(()=>e("i",null,"H3",-1)),ql=we(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},"###"),e("span",{class:"item"},"Space")],-1)),Ll=we(()=>e("i",{class:"material-icons"},"format_list_bulleted",-1)),Ul=we(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},"-"),e("span",{class:"item"},"Space")],-1)),Ol=we(()=>e("i",{class:"material-icons"},"format_list_numbered",-1)),zl=we(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},"1."),e("span",{class:"item"},"Space")],-1)),Kl=we(()=>e("i",{class:"material-icons"},"code",-1)),jl=we(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},"```")],-1)),Gl=we(()=>e("i",{class:"material-icons"},"format_quote",-1)),Wl=we(()=>e("p",{class:"shortcut-help"},[e("span",{class:"item"},">"),e("span",{class:"item"},"Space")],-1)),Xt=ee({__name:"BlockPanelMenuChange",props:{editor:{type:Object,default:null,required:!0},isEditingFigure:{type:Boolean},currentNodeName:{type:String,required:!0}},emits:["commandHandler","setFocusPanel","closeTagMenu","toggleTagMenu"],setup(t,{emit:f}){const o=t,r=f,u=T(()=>o.currentNodeName==="figure"||o.currentNodeName==="embed_code"||o.currentNodeName==="hard_break"||o.currentNodeName==="table_of_contents");return(d,l)=>{const v=Me("click-outside");return me((n(),y("ul",{class:"edit-menu",onClick:l[8]||(l[8]=i=>r("toggleTagMenu"))},[e("li",{class:Q({active:t.currentNodeName==="paragraph",disabled:s(u)}),onClick:l[0]||(l[0]=i=>r("commandHandler","setParagraph"))},[Nl,e("p",null,E(d.$t("CMS Menu: Paragraph")),1)],2),e("li",{class:Q({active:t.currentNodeName==="heading1",disabled:s(u)}),onClick:l[1]||(l[1]=i=>r("commandHandler","toggleHeading1"))},[Al,e("p",null,E(d.$t("CMS Menu: Heading 1")),1),Bl],2),e("li",{class:Q({active:t.currentNodeName==="heading2",disabled:s(u)}),onClick:l[2]||(l[2]=i=>r("commandHandler","toggleHeading2"))},[xl,e("p",null,E(d.$t("CMS Menu: Heading 2")),1),Dl],2),e("li",{class:Q({active:t.currentNodeName==="heading3",disabled:s(u)}),onClick:l[3]||(l[3]=i=>r("commandHandler","toggleHeading3"))},[Hl,e("p",null,E(d.$t("CMS Menu: Heading 3")),1),ql],2),e("li",{class:Q({active:t.currentNodeName==="bullet_list",disabled:s(u)}),onClick:l[4]||(l[4]=i=>r("commandHandler","toggleBulletList"))},[Ll,e("p",null,E(d.$t("CMS Menu: Bulleted List")),1),Ul],2),e("li",{class:Q({active:t.currentNodeName==="ordered_list",disabled:s(u)}),onClick:l[5]||(l[5]=i=>r("commandHandler","toggleOrderedList"))},[Ol,e("p",null,E(d.$t("CMS Menu: Numbered List")),1),zl],2),e("li",{class:Q({active:t.currentNodeName==="code_block",disabled:s(u)}),onClick:l[6]||(l[6]=i=>r("commandHandler","toggleCodeBlock"))},[Kl,e("p",null,E(d.$t("CMS Menu: Code")),1),jl],2),e("li",{class:Q({active:t.currentNodeName==="blockquote",disabled:s(u)}),onClick:l[7]||(l[7]=i=>r("commandHandler","toggleBlockquote"))},[Gl,e("p",null,E(d.$t("CMS Menu: Quote")),1),Wl],2)])),[[v,()=>r("closeTagMenu")]])}}});const Vl=ie(Xt,[["__scopeId","data-v-ea19ade7"]]);Xt.__docgenInfo={exportName:"default",displayName:"BlockPanelMenuChange",description:"",tags:{},props:[{name:"editor",type:{name:"Editor"},required:!0,defaultValue:{func:!1,value:"null"}},{name:"isEditingFigure",type:{name:"boolean"}},{name:"currentNodeName",type:{name:"RichtextTagNameType"},required:!0}],events:[{name:"commandHandler",type:{names:["Command"]}},{name:"setFocusPanel",type:{names:["PanelTypeEnum"]}},{name:"closeTagMenu"},{name:"toggleTagMenu"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/BlockPanel/BlockPanelMenuChange.vue"]};const Jl={class:"BlockPanelMenuTable"},Ql={class:"menu"},Xl={class:"group"},Yl={class:"_flex _flex-row _items-center _gap-8"},Zl={class:"label-sm2-normal _text-black"},ea={class:"_flex _flex-row _items-center _gap-8"},ta={class:"label-sm2-normal _text-black"},oa={class:"text"},Yt=ee({__name:"BlockPanelMenuTable",props:{editor:{type:Object,default:null,required:!0}},emits:["commandHandler","setFocusPanel","closeMenu"],setup(t,{emit:f}){const o=t,r=b(!1),u=b(!1),d=f;Pe(()=>{const v=nt(o.editor.state);r.value=v?.table.firstChild?.lastChild?.type.name==="tableHeader",u.value=v?.table.lastChild?.firstChild?.type.name==="tableHeader",o.editor.commands.selectAllCell()});const l=v=>{switch(v){case"addRowBefore":o.editor.chain().focus().addRowBefore().run();break;case"addRowAfter":o.editor.chain().focus().addRowAfter().run();break;case"addColumnBefore":o.editor.chain().focus().addColumnBefore().run();break;case"addColumnAfter":o.editor.chain().focus().addColumnAfter().run();break;case"deleteColumn":o.editor.chain().focus().deleteColumn().run();break;case"toggleHeaderColumn":{u.value=!u.value,o.editor.chain().focus().toggleHeaderColumn().run();break}case"toggleHeaderRow":{r.value=!r.value,o.editor.chain().focus().toggleHeaderRow().run();break}case"toggleHeaderCell":o.editor.chain().focus().toggleHeaderCell().run();break;case"deleteTheTable":{o.editor.chain().focus().deleteTheTable().run(),d("closeMenu");break}}};return(v,i)=>{const g=te("PfIcon"),h=te("PfToggleSwitch"),p=Me("click-outside");return me((n(),y("div",Jl,[e("div",Ql,[e("div",Xl,E(v.$t("CMS TablePanel: Edit table")),1),e("label",{class:"button-common _flex _w-full _flex-row _items-center _justify-between _px-16 _py-8",onClick:i[0]||(i[0]=V(C=>l("toggleHeaderRow"),["stop"]))},[e("div",Yl,[R(g,{class:"_pointer-events-none",icon:"tableHeaderRow",size:"16"}),e("span",Zl,E(v.$t("CMS TablePanel: Header row")),1)]),R(h,{class:"_pointer-events-none","model-value":s(r)},null,8,["model-value"])]),e("label",{class:"button-common _flex _w-full _flex-row _items-center _justify-between _px-16 _py-8",onClick:i[1]||(i[1]=V(C=>l("toggleHeaderColumn"),["stop"]))},[e("div",ea,[R(g,{class:"_pointer-events-none",icon:"tableHeaderColumn",size:"16"}),e("span",ta,E(v.$t("CMS TablePanel: Header column")),1)]),R(h,{class:"_pointer-events-none","model-value":s(u)},null,8,["model-value"])]),e("button",{class:"button-common",onClick:i[2]||(i[2]=C=>l("deleteTheTable"))},[R(g,{class:"_pointer-events-none",icon:"dustbox",size:"16"}),e("span",oa,E(v.$t("CMS TablePanel: Delete table")),1)])])])),[[p,()=>d("closeMenu")]])}}});const na=ie(Yt,[["__scopeId","data-v-e6c907c0"]]);Yt.__docgenInfo={exportName:"default",displayName:"BlockPanelMenuTable",description:"",tags:{},props:[{name:"editor",type:{name:"Editor"},required:!0,defaultValue:{func:!1,value:"null"}}],events:[{name:"commandHandler",type:{names:["Command"]}},{name:"setFocusPanel",type:{names:["PanelTypeEnum"]}},{name:"closeMenu"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/BlockPanel/BlockPanelMenuTable.vue"]};const sa={key:0,class:"blockPanel"},Zt=ee({__name:"BlockPanel",props:{editor:{type:Object,default:null,required:!0},isEditingFigure:{type:Boolean}},emits:["setFocusPanel"],setup(t,{emit:f}){const o=t,r=b({top:"",height:""}),u=b(""),d=b(!1),l=b(null),v=b(!1),[i,g]=$t(!1),[h,p]=$t(!1),C=T(()=>o.editor.state.doc.nodeSize),_=S=>{switch(S){case"insertTable":o.editor.chain().insertTable({rows:3,cols:3,withHeaderRow:!0}).focus().run();break;case"setBlockquote":o.editor.chain().setBlockquote().focus().run();break;case"toggleBlockquote":o.editor.chain().toggleBlockquote().focus().run();break;case"unsetBlockquote":o.editor.chain().unsetBlockquote().focus().run();break;case"toggleBulletList":o.editor.chain().toggleBulletList().focus().run();break;case"setCodeBlock":o.editor.chain().setCodeBlock().focus().run();break;case"toggleCodeBlock":o.editor.chain().toggleCodeBlock().focus().run();break;case"setHardBreak":o.editor.chain().setHardBreak().focus().run();break;case"setHeading1":o.editor.chain().setHeading1().focus().run();break;case"setHeading2":o.editor.chain().setHeading2().focus().run();break;case"setHeading3":o.editor.chain().setHeading3().focus().run();break;case"setHeading4":o.editor.chain().setHeading4().focus().run();break;case"setHeading5":o.editor.chain().setHeading5().focus().run();break;case"setHeading6":o.editor.chain().setHeading6().focus().run();break;case"toggleHeading1":o.editor.chain().toggleHeading1().focus().run();break;case"toggleHeading2":o.editor.chain().toggleHeading2().focus().run();break;case"toggleHeading3":o.editor.chain().toggleHeading3().focus().run();break;case"toggleHeading4":o.editor.chain().toggleHeading4().focus().run();break;case"toggleHeading5":o.editor.chain().toggleHeading5().focus().run();break;case"toggleHeading6":o.editor.chain().toggleHeading6().focus().run();break;case"setHorizontalRule":o.editor.chain().setHorizontalRule().focus().run();break;case"toggleOrderedList":o.editor.chain().toggleOrderedList().focus().run();break;case"setParagraph":o.editor.chain().setParagraph().focus().run();break;case"createTableOfContents":o.editor.chain().createTableOfContents().focus().run();break}i.value=!1,c()};X(()=>o.editor.state.selection,(S,B)=>{(B.from!==S.from||B.to!==S.to)&&c()},{deep:!0}),X(C,()=>{c()}),X(()=>o.isEditingFigure,S=>{S||c()}),Pe(()=>{c(),window.addEventListener("resize",c)}),Te(()=>{window.removeEventListener("resize",c)});const c=Ve(100,function(){const{state:S,dom:B}=o.editor.view,A=S.selection.$anchor,F=Le(S.selection)?S.selection.node:A.node(A.depth),P=zt(S.doc,F);P&&setTimeout(()=>{const a=B.querySelector(`[data-uid="${P.attrs.blockUid}"]`);if(l.value=a,!a||!B)return;const m=a.getBoundingClientRect(),q=B.getBoundingClientRect();if(!m||!q)return;const $=m.top-q.top,j=m.height;r.value.top=`${$}px`,r.value.height=`${j}px`,u.value=P.type.name,["figure","embed_code"].some(w=>w===u.value)?d.value=!1:d.value=/is-empty/.test(a.className)||a.textContent==="",v.value=!0},0)});return(S,B)=>(n(),H(ft,null,{default:Z(()=>[!t.isEditingFigure&&s(v)?(n(),y("div",sa,[e("div",{class:"floating-menu",style:se(s(r))},[R(ml,{"is-empty":s(d),"current-node-name":s(u),onToggleMenu:s(g),onToggleTagMenu:s(p)},null,8,["is-empty","current-node-name","onToggleMenu","onToggleTagMenu"]),s(i)?(n(),H(Ml,{key:0,editor:t.editor,onCommandHandler:_,onCloseMenu:B[0]||(B[0]=A=>i.value=!1)},null,8,["editor"])):s(h)?(n(),y(le,{key:1},[s(u)==="table"?(n(),H(na,{key:0,editor:t.editor,onCloseMenu:B[1]||(B[1]=A=>h.value=!1)},null,8,["editor"])):(n(),H(Vl,{key:1,"current-node-name":s(u),onCommandHandler:_,onCloseTagMenu:B[2]||(B[2]=A=>h.value=!1),onToggleTagMenu:s(p)},null,8,["current-node-name","onToggleTagMenu"]))],64)):D("",!0)],4)])):D("",!0)]),_:1}))}});const la=ie(Zt,[["__scopeId","data-v-608de679"]]);Zt.__docgenInfo={exportName:"default",displayName:"BlockPanel",description:"",tags:{},props:[{name:"editor",type:{name:"Editor"},required:!0,defaultValue:{func:!1,value:"null"}},{name:"isEditingFigure",type:{name:"boolean"}}],events:[{name:"setFocusPanel",type:{names:["PanelTypeEnum"]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/BlockPanel/BlockPanel.vue"]};const aa={class:"resolve-header"},ia={key:0,class:"comment-diff"},ra={class:"deletion"},da={class:"addition"},ua={class:"comment-header"},ca={class:"header-left"},ma={class:"header-center"},pa={class:"authorName"},fa={class:"createdAt"},va=["onClick"],_a={key:0,class:"menu"},ga=["onClick"],ha=["onClick"],ya={class:"comment-content"},ba=["placeholder","onBlur"],Ca={class:"textarea-spacer"},ka={key:1,class:"content"},Pa=["placeholder"],wa={class:"textarea-spacer"},eo=ee({__name:"CommentsPanel",props:{editor:{},comments:{},focusedPanelType:{},panelBellowLink:{type:Boolean}},emits:["addComment","deleteComment","updateComment","resolveThread","setFocusPanel"],setup(t,{emit:f}){const o=t,r=f,u=Ue(),{editor:d,comments:l,focusedPanelType:v,panelBellowLink:i}=he(o),g=b(null),h=b(null),p=b(null),C=b(null),_=b(""),c=b(""),S=b(""),B=b(""),A=b(!1),F=b({left:"",top:""}),P=b(""),a=b(""),m=T(()=>u.state.v2.account),q=T(()=>l.value.filter(N=>N.comment.threadId===$.value).sort((N,Y)=>N.comment.createdAt>Y.comment.createdAt?1:-1).map((N,Y,_e)=>({...N,isOpenMenu:N.comment.commentId===P.value,createdAtString:Mt.toDefaultFormat(N.comment.createdAt),hasDiff:Y!==0&&_e[Y-1].comment.targetText!==N.comment.targetText,deletion:Y!==0&&_e[Y-1].comment.targetText,addition:N.comment.targetText}))),$=T(()=>{const N=d.value?.state?.selection;return Le(N)?N?.node?.attrs?.threadId||"":d.value.getAttributes("comments")?.threadId||""}),j=()=>{const{view:N}=d.value,{state:Y,dom:_e}=N;N.composing||(requestAnimationFrame(()=>{if(!g.value||!_e)return;const k=_e.getBoundingClientRect(),K=g.value.getBoundingClientRect(),{selection:de}=Y,{from:ge,to:be}=de,Se=N.coordsAtPos(ge),Re=N.coordsAtPos(be);if(Le(de))F.value.left=`${Math.round(k.width-K.width/2+5)}px`,F.value.top=`${Math.round(Se.bottom+Se.top-Se.bottom-k.top-15)}px`;else{const Je=(Se.left+Re.left)/2-k.left;F.value.left=`${Math.round(Math.min(k.width-K.width/2,Math.max(Je,K.width/2)))}px`;const Xo=i.value?50:0;F.value.top=`${Math.round(Re.bottom-k.top+Xo)}px`}A.value=!0}),O())},O=()=>{requestAnimationFrame(()=>{const N=C.value;N&&(N.scrollTop=N.scrollHeight)})},w=(N,Y,_e)=>{d.value.commands.addComment({threadId:N}),r("addComment",{threadId:N,targetText:Y,content:_e})},x=N=>{r("deleteComment",{commentId:N}),!(q.value.length>1)&&d.value.commands.deleteThread()},G=(N,Y)=>{console.log("updateComment",N,Y),r("updateComment",{commentId:N,content:Y})},z=()=>{const N=$.value;N&&(d.value.commands.resolveThread({threadId:N}),r("resolveThread",{threadId:N}))},re=N=>{P.value===N&&(P.value="")},L=N=>{P.value=N},M=N=>{a.value=N.commentId,P.value="",requestAnimationFrame(()=>{const Y=h.value?.[0];Y&&(_.value=N.content,c.value=N.content,Y.focus(),Y.select())})},I=N=>{P.value="",x(N)},U=N=>{if(a.value!==N)return;const _e=(h.value?.[0]).value;G(N,_e),a.value="",_.value="",c.value=""},W=()=>{a.value="",h.value?.blur()},J=()=>{h.value?.[0]?.blur()},ne=()=>{requestAnimationFrame(()=>{const N=h.value?.[0];if(!N)return;const Y=N.value!==N.value?.trim();c.value=Y?`${N.value} 1`:N.value})},ye=N=>{N.isComposing||N.shiftKey||(J(),N.preventDefault(),N.stopPropagation())},ue=()=>{const N=$.value||on.generateUid(),Y=ps(d.value.state,d.value.state.schema.marks.comments);w(N,Y,S.value),S.value="",B.value="",pe()},pe=()=>{requestAnimationFrame(()=>{p.value?.focus()})},oe=()=>{},ae=()=>{requestAnimationFrame(()=>{const N=p.value;if(!N)return;const Y=N.value!==N.value?.trim();B.value=Y?`${N.value} 1`:N.value})},fe=()=>{p.value.blur(),r("setFocusPanel",ce.None)},ve=N=>{N.isComposing||N.shiftKey||(ue(),N.preventDefault(),N.stopPropagation())};return X(()=>d.value.state.selection,(N,Y)=>{(Y.from!==N.from||Y.to!==N.to)&&j()}),X(q,(N,Y)=>{N.length>Y.length&&O()},{deep:!0}),Pe(()=>{j(),($.value===""||v.value===ce.CommentsPanel)&&pe(),window.addEventListener("resize",j)}),Te(()=>{window.removeEventListener("resize",j)}),(N,Y)=>{const _e=Me("click-outside");return n(),y("div",{ref_key:"rootEl",ref:g,class:Q(["CommentsPanel",{"is-active":A.value}]),style:se(F.value)},[q.value.length>0?(n(),y(le,{key:0},[e("div",aa,[e("div",{class:"resolve",onClick:z},E(N.$t("CMS CommentsPanel: Resolve")),1)]),e("ul",{ref_key:"thread",ref:C,class:"thread"},[(n(!0),y(le,null,Ce(q.value,k=>(n(),y("li",{key:k.comment.commentId,class:"comment"},[k.hasDiff?(n(),y("div",ia,[e("div",ra,E(k.deletion),1),e("div",da,E(k.addition),1)])):D("",!0),e("div",ua,[e("div",ca,[e("div",{class:"icon",style:se({backgroundImage:`url('${k.author.avatar}')`})},null,4)]),e("div",ma,[e("div",pa,E(k.author.name),1),e("div",fa,E(k.createdAtString),1)]),q.value.length>0&&k.comment.authorId===m.value.id?(n(),y("div",{key:0,class:Q(["header-menu",{isOpen:k.isOpenMenu}])},[me((n(),y("span",{class:"material-icons",onClick:K=>L(k.comment.commentId)},[Ye(" more_vert ")],8,va)),[[_e,()=>re(k.comment.commentId)]]),R(ft,null,{default:Z(()=>[k.isOpenMenu?(n(),y("div",_a,[e("ul",null,[e("li",{onClick:K=>M(k.comment)},E(N.$t("CMS CommentsPanel: Edit Comment")),9,ga),e("li",{onClick:K=>I(k.comment.commentId)},E(N.$t("CMS CommentsPanel: Delete Comment")),9,ha)])])):D("",!0)]),_:2},1024)],2)):D("",!0)]),e("div",ya,[a.value===k.comment.commentId?(n(),y("form",{key:0,class:"formEditComment",onSubmit:Y[1]||(Y[1]=V(()=>{},["prevent","stop"]))},[me(e("textarea",{ref_for:!0,ref_key:"editCommentInput",ref:h,"onUpdate:modelValue":Y[0]||(Y[0]=K=>_.value=K),class:"comment-input",type:"text",placeholder:N.$t("CMS CommentsPanel: Edit Comment"),onBlur:K=>U(k.comment.commentId),onPaste:ne,onKeydown:[ne,Ee(W,["esc"]),Ee(ye,["enter"])]},null,40,ba),[[Xe,_.value]]),e("div",Ca,E(c.value),1)],32)):(n(),y("p",ka,E(k.comment.content),1))])]))),128))],512)],64)):D("",!0),e("form",{class:"formNewComment",onSubmit:Y[3]||(Y[3]=V(()=>{},["prevent","stop"]))},[e("div",{class:"icon",style:se({backgroundImage:`url('${m.value.avatar}')`})},null,4),me(e("textarea",{ref_key:"newCommentInput",ref:p,"onUpdate:modelValue":Y[2]||(Y[2]=k=>S.value=k),class:"comment-input",placeholder:N.$t("CMS CommentsPanel: Add Comment"),onBlur:oe,onPaste:ae,onKeydown:[ae,Ee(fe,["esc"]),Ee(ve,["enter"])]},null,40,Pa),[[Xe,S.value]]),e("div",wa,E(B.value),1)],32)],6)}}});const $a=ie(eo,[["__scopeId","data-v-119b7e96"]]);eo.__docgenInfo={exportName:"default",displayName:"CommentsPanel",description:"",tags:{},props:[{name:"editor",required:!0,type:{name:"Editor"}},{name:"comments",required:!0,type:{name:"Array",elements:[{name:"CmsComment"}]}},{name:"focusedPanelType",required:!0,type:{name:"PanelTypeEnum"}},{name:"panelBellowLink",required:!0,type:{name:"boolean"}}],events:[{name:"addComment"},{name:"deleteComment"},{name:"updateComment"},{name:"resolveThread"},{name:"setFocusPanel"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/CommentsPanel.vue"]};const to=ee({__name:"EmbedCodeIcon",props:{embedCodeType:{}},setup(t){const{isDarkMode:f}=nn();return(o,r)=>(n(),y("i",{class:Q([o.embedCodeType,s(f)?"dark":""])},null,2))}});const Ia=ie(to,[["__scopeId","data-v-6987be6e"]]);to.__docgenInfo={exportName:"default",displayName:"EmbedCodeIcon",description:"",tags:{},props:[{name:"embedCodeType",required:!0,type:{name:"EmbedCodeEnum"}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/common/EmbedCodeIcon.vue"]};const Sa={class:"header"},Ta={class:"title"},Ea={key:0,class:"input-area"},Fa={class:"embed_code"},Ra={class:"btn-wrap"},Ma=["disabled"],oo=ee({__name:"EmbedPanel",props:{editor:{default:null},focusedPanelType:{default:null}},emits:["setFocusPanel"],setup(t,{emit:f}){const o=t,r=f,u=b(null),d=b(null),{editor:l,focusedPanelType:v}=he(o),i=b(""),g=b(""),h=b(!1),p=b({left:"",top:""}),C=b(!1),_=T(()=>l.value.commands),c=T(()=>sn(g.value)),S=T(()=>ln(c.value)),B=()=>{const w=_.value.getEmbedCodeAttrs();i.value=w.src,g.value=w.src},A=()=>{const{view:w}=l.value,{state:x,dom:G}=w;setTimeout(()=>{if(!u.value)return;const{from:z,to:re}=x.selection,L=w.coordsAtPos(z),M=w.coordsAtPos(re),I=G.getBoundingClientRect(),U=u.value.getBoundingClientRect(),W=(L.left+M.left)/2-I.left;p.value.left=`${Math.round(Math.min(I.width-U.width/2,Math.max(W,U.width/2)))}px`,p.value.top=`${Math.round(L.top-I.top)}px`,h.value=!0},0)},F=()=>{C.value=!0,Rt(()=>{d.value.focus()})},P=()=>{an(i.value)==="iframe"||!i.value?_.value.updateEmbedCode({src:i.value}):_.value.updateEmbedCodeSandbox({src:i.value})},a=w=>{w.target.select()},m=w=>{w?.isComposing||w?.shiftKey||(w.preventDefault(),w.stopPropagation(),$())},q=()=>{$()},$=()=>{if(i.value===g.value){B(),C.value=!1,l?.value?.commands.focus();return}C.value=!1,P(),l?.value?.commands.focus()},j=()=>{C.value=!1},O=()=>{d.value?.blur(),i.value=g.value,C.value=!1,l.value.commands.focus()};return X(()=>l.value.state.selection,(w,x)=>{(w.from!==x.from||w.to!==x.to)&&(C.value=!1,B(),A())}),X(v,w=>{w==="EmbedPanel"&&(B(),A(),i.value||(C.value=!0,requestAnimationFrame(()=>{d.value?.focus()})))},{immediate:!0}),Pe(()=>{B(),A(),window.addEventListener("resize",A)}),Te(()=>{r("setFocusPanel",ce.None),window.removeEventListener("resize",A)}),(w,x)=>(n(),y("div",{ref_key:"rootEl",ref:u,class:Q(["EmbedPanel",{"is-active":h.value}]),style:se(p.value)},[e("div",Sa,[e("div",Ta,[R(Ia,{"embed-code-type":c.value},null,8,["embed-code-type"]),e("p",null,E(S.value||"Input Embed Code"),1)]),C.value?(n(),y("button",{key:0,onClick:j},E(w.$t("CMS EmbedPanel: Cancel")),1)):(n(),y("button",{key:1,onClick:F},E(w.$t("CMS EmbedPanel: Edit")),1))]),C.value?(n(),y("div",Ea,[e("div",Fa,[me(e("textarea",{ref_key:"embedCodeInput",ref:d,"onUpdate:modelValue":x[0]||(x[0]=G=>i.value=G),class:"code-input",placeholder:"<iframe></iframe>",onFocus:a,onKeydown:[Ee(O,["esc"]),Ee(m,["enter"])]},null,544),[[Xe,i.value]]),e("div",Ra,[e("button",{class:"btn-submit",disabled:g.value===i.value,type:"submit",onClick:q},E(w.$t("CMS EmbedPanel: Update")),9,Ma)])])])):D("",!0)],6))}});const Na=ie(oo,[["__scopeId","data-v-157e88b0"]]);oo.__docgenInfo={exportName:"default",displayName:"EmbedPanel",description:"",tags:{},props:[{name:"editor",required:!1,type:{name:"Editor"},defaultValue:{func:!1,value:"null"}},{name:"focusedPanelType",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"null"}}],events:[{name:"setFocusPanel"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/EmbedPanel.vue"]};const bt=t=>($e("data-v-c0db393a"),t=t(),Ie(),t),Aa={class:"left"},Ba={class:"form-label"},xa=["placeholder"],Da={class:"right"},Ha={class:"label"},qa={class:"label"},La={class:"textAlign_menu"},Ua=bt(()=>e("use",{href:"#i-21-align-left"},null,-1)),Oa=[Ua],za=bt(()=>e("use",{href:"#i-21-align-center"},null,-1)),Ka=[za],ja=bt(()=>e("use",{href:"#i-21-align-right"},null,-1)),Ga=[ja],no=ee({__name:"ImagePanel",props:{editor:{},editorBody:{},comments:{},upload:{},focusedPanelType:{}},emits:["setFocusPanel"],setup(t,{emit:f}){const o=t,r=f,u=b(null),d=b(null),{editor:l,editorBody:v,comments:i,upload:g,focusedPanelType:h}=he(o),p=b(ce),C=b(!1),_=b(""),c=b(!1),S=b(""),B=b(""),A=b(""),F=b(""),P=b(""),a=b(""),m=b({left:"",top:"",width:""}),q=T(()=>i.value.filter(I=>I.comment.threadId===a.value).length>0),$=I=>{I===h.value?r("setFocusPanel",ce.None):r("setFocusPanel",I)},j=()=>{C.value=!1;const{view:I}=l.value,{state:U,dom:W}=I;if(!l.value.view.composing){if(U.selection.empty){C.value=!1;return}setTimeout(()=>{if(!u.value)return;const{from:J,to:ne}=U.selection,ye=I.coordsAtPos(J),ue=I.coordsAtPos(ne),pe=W.getBoundingClientRect(),oe=u.value.getBoundingClientRect(),ae=(ye.left+ue.left)/2-pe.left;m.value.left=`${Math.round(Math.min(pe.width-oe.width/2,Math.max(ae,oe.width/2)))}px`,m.value.left="0",m.value.top=`${Math.round(ye.top-pe.top)}px`,m.value.width=`${Math.round(pe.width)}px`,C.value=!0},0)}},O=()=>{l.value.isActive("figure")&&x()},w=(I,U=!1)=>{l.value.commands.setImageAttrs(I),U&&l.value.commands.focus()},x=()=>{const I=l.value.commands.getImageAttrs()||{},{blockUid:U,alt:W,href:J,textAlign:ne,threadId:ye}=I;_.value=U||"",S.value=W||"",A.value=J||"",P.value=ne||"",a.value=ye||"",B.value=W||"",F.value=J||""},G=()=>{c.value=!1},z=()=>{c.value=!0,w({alt:S.value},!0)},re=I=>{c.value||S.value!==B.value&&w({alt:S.value})},L=()=>{c.value=!0,S.value=B.value,w({alt:S.value},!0)},M=I=>{c.value=!0,P.value=P.value===I?null:I,w({textAlign:P.value},!0)};return X(()=>l.value.state.selection,(I,U)=>{(I.from!==U.from||I.to!==U.to)&&(j(),O())},{immediate:!1}),X(v,(I,U)=>{I!==U&&x()},{}),X(i,()=>{x()},{deep:!0}),Pe(()=>{j(),O(),window.addEventListener("resize",j)}),Te(()=>{window.removeEventListener("resize",j)}),(I,U)=>(n(),y("div",{ref_key:"rootEl",ref:u,key:_.value,class:Q(["ImagePanel",{"is-active":C.value}]),style:se(m.value)},[e("div",Aa,[e("form",{class:"alt_menu form-common",onSubmit:V(z,["prevent","stop"])},[e("label",Ba,[me(e("input",{ref_key:"altInput",ref:d,"onUpdate:modelValue":U[0]||(U[0]=W=>S.value=W),class:"form-input",type:"text",placeholder:I.$t("CMS ImagePanel: Add alt"),onFocus:G,onBlur:re,onKeydown:Ee(L,["esc"])},null,40,xa),[[Xe,S.value]])])],32)]),e("div",Da,[e("button",{class:Q(["button-common link_menu",{"has-link":!!A.value}]),onClick:U[1]||(U[1]=W=>$(p.value.LinkPanel))},[e("span",Ha,E(I.$t("CMS InlinePanel: Link")),1)],2),e("button",{class:Q(["button-common comment_menu",{"has-thread":q.value}]),onClick:U[2]||(U[2]=W=>$(p.value.CommentsPanel))},[e("span",qa,E(I.$t("CMS InlinePanel: Comment")),1)],2),e("div",La,[e("button",{class:"button-common",onClick:U[3]||(U[3]=W=>M("left"))},[(n(),y("svg",{width:"17",height:"17",class:Q({active:P.value==="left"})},Oa,2))]),e("button",{class:"button-common",onClick:U[4]||(U[4]=W=>M("center"))},[(n(),y("svg",{width:"17",height:"17",class:Q({active:P.value==="center"})},Ka,2))]),e("button",{class:"button-common",onClick:U[5]||(U[5]=W=>M("right"))},[(n(),y("svg",{width:"17",height:"17",class:Q({active:P.value==="right"})},Ga,2))])])])],6))}});const Wa=ie(no,[["__scopeId","data-v-c0db393a"]]);no.__docgenInfo={exportName:"default",displayName:"ImagePanel",description:"",tags:{},props:[{name:"editor",required:!0,type:{name:"Editor"}},{name:"editorBody",required:!0,type:{name:"string"}},{name:"comments",required:!0,type:{name:"Array",elements:[{name:"CmsComment"}]}},{name:"upload",required:!0,type:{name:"TSFunctionType"}},{name:"focusedPanelType",required:!0,type:{name:"PanelTypeEnum"}}],events:[{name:"setFocusPanel"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/ImagePanel.vue"]};const Ze=t=>($e("data-v-369736c0"),t=t(),Ie(),t),Va=Ze(()=>e("i",{class:"-bold"},"B",-1)),Ja=[Va],Qa=Ze(()=>e("i",{class:"-italic"},"i",-1)),Xa=[Qa],Ya=Ze(()=>e("i",{class:"-strike"},"S",-1)),Za=[Ya],ei=Ze(()=>e("i",{class:"-underline"},"U",-1)),ti=[ei],oi=Ze(()=>e("i",{class:"-code"},"<>",-1)),ni=[oi],si={class:"-link"},so=ee({__name:"InlinePanel",props:{editor:{}},emits:["setFocusPanel"],setup(t,{emit:f}){const o={heading1:{bold:!0,italic:!0,strike:!0,underline:!0,code:!0,link:!1,comments:!1},heading2:{bold:!0,italic:!0,strike:!0,underline:!0,code:!0,link:!1,comments:!1},heading3:{bold:!0,italic:!0,strike:!0,underline:!0,code:!0,link:!1,comments:!1},heading4:{bold:!0,italic:!0,strike:!0,underline:!0,code:!0,link:!1,comments:!1},heading5:{bold:!0,italic:!0,strike:!0,underline:!0,code:!0,link:!1,comments:!1},heading6:{bold:!0,italic:!0,strike:!0,underline:!0,code:!0,link:!1,comments:!1},paragraph:{bold:!1,italic:!1,strike:!1,underline:!1,code:!1,link:!1,comments:!1},bullet_list:{bold:!1,italic:!1,strike:!1,underline:!1,code:!1,link:!1,comments:!1},ordered_list:{bold:!1,italic:!1,strike:!1,underline:!1,code:!1,link:!1,comments:!1},code_block:{bold:!0,italic:!0,strike:!0,underline:!0,code:!0,link:!0,comments:!1},code:{bold:!0,italic:!0,strike:!0,underline:!0,code:!1,link:!0,comments:!1},table:{bold:!1,italic:!1,strike:!1,underline:!1,code:!1,link:!1,comments:!1},blockquote:{bold:!0,italic:!0,strike:!0,underline:!0,code:!0,link:!1,comments:!1}},r={bold:{i18nKey:"TOOLTIP:RICH_TEXT_BOLD",mac:"⌘ + B",win:"ctrl + B"},italic:{i18nKey:"TOOLTIP:RICH_TEXT_ITALIC",mac:"⌘ + I",win:"ctrl + I"},strike:{i18nKey:"TOOLTIP:RICH_TEXT_STRIKE",mac:"⌘ + shift + S",win:"ctrl + shift + S"},underline:{i18nKey:"TOOLTIP:RICH_TEXT_UNDERLINE",mac:"⌘ + U",win:"ctrl + U"},code:{i18nKey:"TOOLTIP:RICH_TEXT_CODE",mac:"⌘ + E",win:"ctrl + E"},link:{i18nKey:"TOOLTIP:RICH_TEXT_LINK",mac:"⌘ + K",win:"ctrl + K"},comments:{i18nKey:"TOOLTIP:RICH_TEXT_COMMENT",mac:"⌘ + shift + M",win:"ctrl + shift + M"}},u=t,d=f,l=xe(),v=b(null),{editor:i}=he(u),g=b(!1),h=b({left:"",bottom:""}),p=b(ce),C=T(()=>navigator.userAgent.indexOf("Mac")!==-1?"mac":"win"),_=T(()=>{const{state:A}=i.value.view,F=A.selection.$anchor,P=Le(A.selection)?A.selection.node:F.node(F.depth),a=zt(A.doc,P);let m=a.type.name;return a.type.name!=="code_block"&&i.value.isActive("code")&&(m="code"),o[m]}),c=A=>{const F=r[A],P=F.i18nKey,a=F[C.value];return`${l.t(P)} ( ${a} )`},S=()=>{const{view:A}=i.value,{state:F,dom:P}=A;if(!i.value.view.composing){if(F.selection.empty){g.value=!1;return}setTimeout(()=>{if(!v.value)return;const{from:a,to:m}=F.selection,q=A.coordsAtPos(a),$=A.coordsAtPos(m),j=P.getBoundingClientRect(),O=v.value.getBoundingClientRect(),w=(q.left+$.left)/2-j.left;h.value.left=`${Math.round(Math.min(j.width-O.width/2,Math.max(w,O.width/2)))}px`,h.value.bottom=`${Math.round(j.bottom-q.top)}px`,g.value=!0},0)}},B=A=>{d("setFocusPanel",A)};return X(()=>i.value.state.selection,(A,F)=>{(A.from!==F.from||A.to!==F.to)&&S()}),Pe(()=>{S(),window.addEventListener("resize",S)}),Te(()=>{window.removeEventListener("resize",S)}),(A,F)=>{const P=Me("tooltip");return n(),y("div",{ref_key:"rootEl",ref:v,class:Q(["InlinePanel",{"is-active":g.value}]),style:se(h.value)},[g.value&&_.value?(n(),y(le,{key:0},[me((n(),y("div",{class:Q(["decoration-item",{selected:s(i).isActive("bold"),disabled:_.value.bold}]),onClick:F[0]||(F[0]=V(()=>s(i).chain().toggleBold().focus().run(),["prevent","stop"]))},Ja,2)),[[P,c("bold"),void 0,{top:!0}]]),me((n(),y("div",{class:Q(["decoration-item",{selected:s(i).isActive("italic"),disabled:_.value.italic}]),onClick:F[1]||(F[1]=V(()=>s(i).chain().toggleItalic().focus().run(),["prevent","stop"]))},Xa,2)),[[P,c("italic"),void 0,{top:!0}]]),me((n(),y("div",{class:Q(["decoration-item",{selected:s(i).isActive("strike"),disabled:_.value.strike}]),onClick:F[2]||(F[2]=V(()=>s(i).chain().toggleStrike().focus().run(),["prevent","stop"]))},Za,2)),[[P,c("strike"),void 0,{top:!0}]]),me((n(),y("div",{class:Q(["decoration-item",{selected:s(i).isActive("underline"),disabled:_.value.underline}]),onClick:F[3]||(F[3]=V(()=>s(i).chain().toggleUnderline().focus().run(),["prevent","stop"]))},ti,2)),[[P,c("underline"),void 0,{top:!0}]]),me((n(),y("div",{class:Q(["decoration-item",{selected:s(i).isActive("code"),disabled:_.value.code}]),onClick:F[4]||(F[4]=V(()=>s(i).chain().toggleCode().focus().run(),["prevent","stop"]))},ni,2)),[[P,c("code"),void 0,{top:!0}]]),me((n(),y("div",{class:Q(["decoration-item",{selected:s(i).isActive("link"),disabled:_.value.link}]),onClick:F[5]||(F[5]=a=>B(p.value.LinkPanel))},[e("p",si,E(A.$t("CMS InlinePanel: Link")),1)],2)),[[P,c("link"),void 0,{top:!0}]]),e("div",{class:Q(["decoration-item -comment",{selected:s(i).isActive("comments"),disabled:_.value.comments}]),onClick:F[6]||(F[6]=a=>B(p.value.CommentsPanel))},[e("p",null,E(A.$t("CMS InlinePanel: Comment")),1)],2)],64)):D("",!0)],6)}}});const li=ie(so,[["__scopeId","data-v-369736c0"]]);so.__docgenInfo={exportName:"default",displayName:"InlinePanel",description:"",tags:{},props:[{name:"editor",required:!0,type:{name:"Editor"}}],events:[{name:"setFocusPanel"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/InlinePanel.vue"]};const lo=t=>($e("data-v-412a01ed"),t=t(),Ie(),t),ai={class:"header"},ii={key:0,class:"title"},ri=["href","disabled"],di={key:0,src:fs},ui={key:1,src:vs},ci={class:"row-group"},mi={class:"new-tab _w-full"},pi={class:"checkbox-parts"},fi={key:0,width:"9",height:"9"},vi=lo(()=>e("use",{href:"#i-9-check"},null,-1)),_i=[vi],gi={class:"label-text"},hi={class:"row-group"},yi={class:"new-tab"},bi={class:"checkbox-parts"},Ci={key:0,width:"9",height:"9"},ki=lo(()=>e("use",{href:"#i-9-check"},null,-1)),Pi=[ki],wi={class:"label-text _mr-4"},ao=ee({__name:"LinkPanel",props:{editor:{},panelBellowComments:{type:Boolean}},emits:["setFocusPanel"],setup(t,{emit:f}){const o=t,r=f,u=b(null),d=b(null),{editor:l,panelBellowComments:v}=he(o),i=b(""),g=b(),h=b(),p=b(""),C=b(!1),_=b(!1),c=b({left:"",top:"",marginTop:"10px",backgroundColor:"var(--base-color-1)"}),S=b(!1),B=T(()=>A.value===un.Custom),A=T(()=>cn(p.value)),F=()=>{const{view:L}=l.value,{state:M,dom:I}=L;L.composing||requestAnimationFrame(()=>{if(!u.value)return;const{selection:U}=M,{from:W,to:J}=U,ne=L.coordsAtPos(W),ye=L.coordsAtPos(J),ue=I.getBoundingClientRect(),pe=u.value.getBoundingClientRect(),oe=(ne.left+ye.left)/2-ue.left;Le(U)?(c.value.left=`${Math.round(ue.width-pe.width/2+5)}px`,c.value.top=`${Math.round(ne.bottom+ne.top-ne.bottom-ue.top-15)}px`):(c.value.left=`${Math.round(Math.min(ue.width-pe.width/2,Math.max(oe,pe.width/2)))}px`,c.value.top=`${Math.round(ye.bottom-ue.top)}px`),_.value=!0})},P=()=>{let L;const{selection:M}=l.value.view.state;return Le(M)?L=M.node.attrs:L=l.value.getAttributes("link")??{},L},a=L=>{const{selection:M}=l.value.view.state;Le(M)?M.node.type.name==="figure"&&l.value.commands.setImageAttrs(L):L?.href?l.value.chain().focus().extendMarkRange("link").setLink(L).run():l.value.chain().focus().extendMarkRange("link").unsetLink().run()},m=L=>{const M=g.value?"_blank":"_self",I=h.value?"noopener nofollow":"noopener";if((P()?.href??"")===L)return;a({href:L,target:M,rel:I}),i.value=L},q=(L=!1)=>{const M=P();L&&ct(M)||(i.value=M?.href||"",p.value=i.value,g.value=M?.target==="_blank",h.value=M.rel==="noopener nofollow")},$=()=>{S.value=!0,C.value=!1,p.value=i.value;const L=P();g.value=L?.target==="_blank",requestAnimationFrame(()=>{d.value?.focus()})},j=()=>{C.value=!0,S.value=!1,m(p.value)},O=()=>{C.value=!0,S.value=!1,m(null),r("setFocusPanel",ce.None)},w=L=>{L.target.select()},x=()=>{C.value||m(p.value)},G=()=>{C.value=!0,S.value=!1,d.value?.blur(),m(i.value),r("setFocusPanel",ce.None)},z=()=>{r("setFocusPanel",ce.None)},re=()=>{const{state:L,view:M}=l.value,{selection:I,tr:U}=L;let{from:W,to:J}=I;const{$from:ne,empty:ye}=I;if(ye){const oe=Fs(ne,l.value.schema.marks.link);oe&&(W=oe.from,J=oe.to)}const ue=U.delete(W,J).setMeta("addToHistory",!1).setMeta("preventUpdate",!0);M.dispatch(ue);const pe=dn(p.value);l.value.commands.createEmbedCode({src:pe})};return X(()=>l.value.state.selection,(L,M)=>{(M.from!==L.from||M.to!==L.to)&&(q(!0),F())},{}),X(S,L=>{L&&v.value?(c.value.marginTop="-60px",c.value.backgroundColor="var(--base-color-1-opacity-95)"):(c.value.marginTop="10px",c.value.backgroundColor="var(--base-color-1)")}),X(g,(L,M)=>{if(M===void 0)return;const I={href:p.value,target:L?"_blank":"_self"};a(I)}),X(h,(L,M)=>{if(M===void 0)return;const I={href:p.value,target:g.value?"_blank":"_self",rel:L?"noopener nofollow":"noopener"};a(I)}),Pe(()=>{q(),F(),C.value=!1,p.value===""&&$(),window.addEventListener("resize",F)}),Te(()=>{window.removeEventListener("resize",F)}),(L,M)=>{const I=Me("click-outside");return me((n(),y("div",{ref_key:"rootEl",ref:u,class:Q(["LinkPanel",{isEmbedCode:!s(B),"is-active":s(_)}]),style:se(s(c))},[e("div",ai,[s(S)?(n(),y("p",ii,E(L.$t("CMS LinkPanel: Link")),1)):(n(),y("a",{key:1,href:s(i),disabled:!s(i),target:"_blank",class:"link"},[s(i)?(n(),y(le,{key:0},[s(g)?(n(),y("img",di)):(n(),y("img",ui))],64)):D("",!0),Ye(" "+E(s(i)||L.$t("CMS LinkPanel: Link")),1)],8,ri)),!s(B)&&!s(S)?(n(),y("button",{key:2,class:"embed_button",onClick:re},E(L.$t("CMS LinkPanel: Embed")),1)):D("",!0),s(i)?(n(),y(le,{key:3},[s(S)?D("",!0):(n(),y("button",{key:"edit",onClick:$},E(L.$t("CMS LinkPanel: Edit")),1)),e("button",{key:"delete",onClick:O},E(L.$t("CMS LinkPanel: Delete")),1)],64)):(n(),y("button",{key:"delete",onClick:O},E(L.$t("CMS LinkPanel: Delete")),1))]),s(S)?(n(),y("form",{key:0,class:"link_menu",onSubmit:V(j,["prevent","stop"])},[me(e("input",{ref_key:"linkInput",ref:d,"onUpdate:modelValue":M[0]||(M[0]=U=>dt(p)?p.value=U:null),class:"link-input",type:"text",placeholder:"https://",onBlur:x,onKeydown:Ee(G,["esc"]),onFocus:w},null,544),[[Xe,s(p)]]),e("div",ci,[e("label",mi,[me(e("input",{"onUpdate:modelValue":M[1]||(M[1]=U=>dt(g)?g.value=U:null),class:"content-check",type:"checkbox"},null,512),[[kt,s(g)]]),e("span",pi,[s(g)?(n(),y("svg",fi,_i)):D("",!0)]),e("span",gi,E(L.$t("CMS LinkPanel: New Tab")),1)])]),e("div",hi,[e("label",yi,[me(e("input",{"onUpdate:modelValue":M[2]||(M[2]=U=>dt(h)?h.value=U:null),class:"content-check",type:"checkbox"},null,512),[[kt,s(h)]]),e("span",bi,[s(h)?(n(),y("svg",Ci,Pi)):D("",!0)]),e("span",wi,E(L.$t("CMS LinkPanel: Nofollow")),1),R(rn,{"pop-over-type":L.$_enum.PopOverType.CmsRichTextLinkRel,placement:"right"},null,8,["pop-over-type"])])])],32)):D("",!0)],6)),[[I,z]])}}});const $i=ie(ao,[["__scopeId","data-v-412a01ed"]]);ao.__docgenInfo={exportName:"default",displayName:"LinkPanel",description:"",tags:{},props:[{name:"editor",required:!0,type:{name:"Editor"}},{name:"panelBellowComments",required:!0,type:{name:"boolean"}}],events:[{name:"setFocusPanel",type:{names:["PanelTypeEnum"]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/LinkPanel.vue"]};const Ii=t=>{const f=b({top:0,left:0,bottom:0,right:0}),o=b(),r=T(()=>_s(o.value)),u=T(()=>!(!o.value||o.value.bottom-o.value.top!==1)),d=T(()=>!(!o.value||o.value.right-o.value.left!==1)),l=b(!1),v=b(!1),i=T(()=>f.value.top===1),g=T(()=>f.value.left===1),h=T(()=>!(f.value.top!==f.value.bottom||f.value.left!==f.value.right));return X(()=>t.value?.state,(p,C)=>{p&&(o.value=nt(p),f.value.top=(o.value?.top??0)+1,f.value.left=(o.value?.left??0)+1,f.value.bottom=o.value?.bottom??0,f.value.right=o.value?.right??0,l.value=o.value?.table.firstChild?.lastChild?.type.name==="tableHeader",v.value=o.value?.table.lastChild?.firstChild?.type.name==="tableHeader",C&&(p.selection.$anchor.parent.attrs.blockUid,C.selection.$anchor.parent.attrs.blockUid))}),{tablelRectIndex:f,tableRect:o,isSingleCellSelected:r,isSingleRowSelected:u,isSingleColSelected:d,rowIsHead:l,colIsHead:v,isRowHead:i,isColHead:g,selectMultipleCells:h}},io=Symbol(),et=()=>{const t=st(io);if(!t)throw new Error("useTableRect() is called without provider.");return t},Si=t=>{const f=Ii(t);return lt(io,f),f},rt=t=>($e("data-v-f19f57a2"),t=t(),Ie(),t),Ti=["href"],Ei={key:0,class:"_inline-block _min-w-full _py-2 _align-middle"},Fi={class:"_w-fit _border _border-solid _border-black"},Ri={class:"_w-fit _text-center"},Mi=rt(()=>e("caption",null," TableRect ",-1)),Ni=rt(()=>e("thead",{class:"_bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"_w-60 _py-3 _px-3 _text-sm _font-semibold _text-gray-900"},"top"),e("th",{scope:"col",class:"_w-60 _py-3 _px-3 _text-sm _font-semibold _text-gray-900"},"bottom"),e("th",{scope:"col",class:"_w-60 _py-3 _px-3 _text-sm _font-semibold _text-gray-900"},"left"),e("th",{scope:"col",class:"_w-60 _py-3 _px-3 _text-sm _font-semibold _text-gray-900"},"right")])],-1)),Ai={class:"_bg-white"},Bi={class:"_whitespace-nowrap _px-3 _py-4 _text-sm _text-gray-800"},xi={class:"_whitespace-nowrap _px-3 _py-4 _text-sm _text-gray-800"},Di={class:"_whitespace-nowrap _px-3 _py-4 _text-sm _text-gray-800"},Hi={class:"_whitespace-nowrap _px-3 _py-4 _text-sm _text-gray-800"},qi={class:"_inline-block _min-w-full _py-2 _align-middle"},Li={class:"_w-fit _border _border-solid _border-black"},Ui={class:"_w-fit _text-center"},Oi=rt(()=>e("thead",{class:"_bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"_w-96 _py-3 _pl-4 _pr-3 _text-sm _font-semibold _text-gray-900"},"who"),e("th",{scope:"col",class:"_w-60 _py-3 _px-3 _text-sm _font-semibold _text-gray-900"},"from"),e("th",{scope:"col",class:"_w-60 _py-3 _px-3 _text-sm _font-semibold _text-gray-900"},"to"),e("th",{scope:"col",class:"_w-60 _py-3 _px-3 _text-sm _font-semibold _text-gray-900"},"anchor"),e("th",{scope:"col",class:"_w-60 _py-3 _px-3 _text-sm _font-semibold _text-gray-900"},"head")])],-1)),zi={class:"_bg-white"},Ki=rt(()=>e("td",{class:"_whitespace-nowrap _py-4 _pl-4 _pr-3 _text-sm _font-medium _text-gray-900"},"myCaret",-1)),ji={class:"_whitespace-nowrap _px-3 _py-4 _text-sm _text-gray-800"},Gi={class:"_whitespace-nowrap _px-3 _py-4 _text-sm _text-gray-800"},Wi={class:"_whitespace-nowrap _px-3 _py-4 _text-sm _text-gray-800"},Vi={class:"_whitespace-nowrap _px-3 _py-4 _text-sm _text-gray-800"},Ji={class:"font _select-all _break-all _bg-gray-100 _p-4"},ro=ee({__name:"PostBodyDebugger",props:{value:{type:String,default:""},editor:{type:Rs},focused:{type:Boolean}},setup(t){const f=t,o="studio-7e371",{cmsProjectId:r}=at(),u=It("schemaId"),d=It("contentId"),{tableRect:l}=et(),v=b(null),{style:i}=mn(v,{initialValue:{x:800,y:600}}),g=T(()=>f.editor.state.doc.nodeSize),h=T(()=>{const{from:p,to:C,anchor:_,head:c}=f.editor.state.selection;return{from:p,to:C,anchor:_,head:c}});return(p,C)=>t.editor?(n(),y("div",{key:0,class:"_fixed _z-1 _flex _h-auto _max-h-[500px] _max-w-[672px] _flex-col _gap-4 _overflow-y-auto _rounded-2 _border-2 _border-solid _border-gray-800 _bg-const-gray-50 _p-4 _shadow-2",style:se(s(i))},[e("div",{ref_key:"el",ref:v,class:"_sticky _top-0 _left-0 _min-h-[20px] _w-full _cursor-move _bg-gray-800"},null,512),e("div",null,[e("a",{href:`https://console.firebase.google.com/u/0/project/${s(o)}/firestore/data/~2Fprojects~2F${s(r)}~2Fschemas~2F${s(u)}~2Fcontents~2F${s(d)}?hl=JA`,target:"_blank",class:"_text-blue-600 _underline _outline _outline-offset-2 _outline-blue-500 hover:_text-blue-800 focus:_outline-2"},"Firestore link",8,Ti),e("div",null,[e("div",null,"docSize: "+E(g.value),1),e("div",null,"focused: "+E(t.focused),1),e("div",null,"editor.value.isFocused: "+E(t.editor.isFocused),1),e("div",null,"editor.isActive('figure'): "+E(t.editor.isActive("figure")),1),e("div",null,"editor.isActive('table'): "+E(t.editor.isActive("table")),1),s(l)?(n(),y("div",Ei,[e("div",Fi,[e("table",Ri,[Mi,Ni,e("tbody",Ai,[e("tr",null,[e("td",Bi,E(s(l).top),1),e("td",xi,E(s(l).bottom),1),e("td",Di,E(s(l).left),1),e("td",Hi,E(s(l).right),1)])])])])])):D("",!0),e("div",qi,[e("div",Li,[e("table",Ui,[Oi,e("tbody",zi,[e("tr",null,[Ki,e("td",ji,E(h.value.from),1),e("td",Gi,E(h.value.to),1),e("td",Wi,E(h.value.anchor),1),e("td",Vi,E(h.value.head),1)])])])])]),e("div",null,E(t.editor.storage.studioCollaboration.currentEditBlockUids),1)])]),e("div",Ji,E(t.value),1)],4)):D("",!0)}});const Qi=ie(ro,[["__scopeId","data-v-f19f57a2"]]);ro.__docgenInfo={exportName:"default",displayName:"PostBodyDebugger",description:"",tags:{},props:[{name:"value",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"editor",type:{name:"Editor"}},{name:"focused",type:{name:"boolean"}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/PostBodyDebugger.vue"]};const uo=ee({components:{},props:{editor:{type:Object,default:null,required:!0},focused:{type:Boolean,default:!1,required:!0},schemaId:{type:String,required:!0},contentId:{type:String,required:!0},fieldKey:{type:String,required:!0},isEditing:{type:Boolean,required:!0},focusedPanelType:{type:String,required:!0}},setup(t,f){const{editor:o,schemaId:r,contentId:u,fieldKey:d,isEditing:l,focusedPanelType:v}=he(t),i=Ue(),g=us(),{isScrolling:h}=Kt(),{selectMultipleCells:p}=et(),C=b(!1),_=b([]),c=b({}),S=b([]),B=T(()=>[ce.LinkPanel,ce.CommentsPanel].includes(v.value)?!0:o.value.isActive("figure")||o.value.isActive("link")||o.value.isActive("comments")),A=T(()=>i.state.v2.account.id),F=T(()=>{const{from:M,to:I}=c.value;return x(M,I,"#0071ff")}),P=T(()=>{const{from:M,to:I}=c.value;return M===I}),a=T(()=>{const{head:M}=c.value;return O({from:M,to:M},"#0071ff")}),m=T(()=>i.getters["studioSelection/othersSessions"].filter(I=>{const{path:U,selectingCmsField:W}=I;if(!W||U!==g.fullPath)return!1;const{key:J}=W;return J===d.value})),q=T(()=>o.value.state.doc.nodeSize),$=()=>{const{from:M,to:I,anchor:U,head:W}=o.value.state.selection;c.value={from:M,to:I,anchor:U,head:W}},j=()=>{S.value=m.value.reduce((M,I)=>{const U=_.value.find(pe=>pe.sessionId===I.sessionId),{from:W,to:J,head:ne,anchor:ye}=U?.caret||{};if(W===void 0||J===void 0)return[];const ue=x(W,J,I.color);return M.push({sessionId:I.sessionId,account:I.account,color:I.color,carets:ue,cursorStyle:O({from:ne,to:ne},I.color)}),M},[])},O=(M,I)=>{try{const W=w.value?.offsetParent?.getBoundingClientRect(),{view:J}=o.value,ne=J.coordsAtPos(M.from),ye=J.coordsAtPos(M.to);let ue=0;if(!ue){const ve=J.coordsAtPos(M.from+1);if(ue=ve?.bottom-ve?.top,!ue){const N=J.coordsAtPos(M.from-1);ue=N?.bottom-N?.top}ue||(ue=ne?.bottom-ne?.top)}let pe=ye?.left-ne?.left;if(pe<0){const ve=J.coordsAtPos(M.from-1);pe=J.coordsAtPos(M.to-1)?.right-ve?.right}const oe=W?.bottom-ne?.top-ue,ae=ne?.left-W?.left;let fe=ue&&oe?"block":"none";return(ae>700||ae+pe<0||ae<0)&&(fe="none"),{background:`${I}`,borderColor:I,height:`${ue}px`,bottom:`${oe}px`,left:`${ae}px`,width:`${pe}px`,display:fe}}catch{return{display:"none"}}},w=b(null),x=(M,I,U)=>{if(M===0)return[];const W=[],{view:J,state:ne}=o.value,ye=ne.doc.nodeSize-1;for(let oe=M;oe>=0&&oe<=I&&oe<ye;oe++){const ae=J.coordsAtPos(oe),fe=W[W.length-1];if(Math.abs(fe?.top-ae.top)>10||W.length===0){if(fe){const Y=J.coordsAtPos(oe-1),_e=J.coordsAtPos(oe-2);fe.right+=Y.right-_e.right}W.push({top:ae.top,right:ae.right,bottom:ae.bottom,left:ae.left})}else fe?.right&&ae?.right&&(fe.right=ae.right,fe.top=ae.top,fe.bottom=ae.bottom)}const pe=w.value?.offsetParent?.getBoundingClientRect();return W.map(oe=>{const ae=oe.bottom-oe.top,fe=pe?.bottom-oe?.top-ae,ve=oe?.left-pe?.left,N=oe?.right-oe?.left;return{background:`${U}`,height:`${ae}px`,bottom:`${fe}px`,left:`${ve}px`,width:`${N}px`}}).filter(oe=>{const ae=parseInt(oe?.left??"",10),fe=parseInt(oe?.width??"",10);return!(ae>700||ae+fe<0)}).map(oe=>{const ae=parseInt(oe?.left??"",10),fe=parseInt(oe?.width??"",10);return ae+fe>700?oe.width=`${700-ae}px`:ae<0&&(oe.width=`${fe+ae}px`,oe.left="0px"),oe})},G=Ve(500,function(){C.value=!1;const M=c.value.from||null,I=c.value.to||null,U=c.value.anchor||null,W=c.value.head||null;i.dispatch("database/writeSelectionCMS",{selectingCmsField:{key:d.value,from:M,to:I,anchor:U,head:W,schemaId:r.value,contentId:u.value}})}),z=M=>({borderColor:M,backgroundColor:M}),re=M=>({borderColor:M,backgroundColor:M});X(h,M=>{M||requestAnimationFrame(()=>{L()})}),X(()=>o.value.state.selection,()=>{$()},{immediate:!0,deep:!0}),X(c,(M,I)=>{M?.from===I?.from&&M?.to===I?.to||(C.value=!0,requestAnimationFrame(()=>{C.value=!1}),G())},{deep:!0}),X(m,()=>{l.value||L()},{deep:!0});const L=()=>{_.value=m.value.map(M=>{const{from:I,to:U,head:W,anchor:J}=M.selectingCmsField,ne={from:I,to:U,head:W,anchor:J};return{sessionId:M.sessionId,caret:ne}}),j()};return X(q,(M,I)=>{const U=M-I;_.value.forEach(W=>{Object.keys(W.caret).forEach(J=>{W.caret[J]>c.value.to&&(W.caret[J]=W.caret[J]+U)})})}),Pe(()=>{window.addEventListener("resize",$),window.addEventListener("resize",j)}),Te(()=>{window.removeEventListener("resize",$),window.removeEventListener("resize",j)}),{isScrolling:h,selectMultipleCells:p,rootEl:w,isMoving:C,localOthersCarets:_,myCaret:c,caretAccountsByRows:S,focusedPanel:B,userId:A,mySelectionStyles:F,mySelectionIsSingle:P,myCursorStyle:a,othersSessions:m,docSize:q,calcMyPosition:$,calcOtherPosition:j,calcCaretStyle:O,calcSelectionRows:x,smallColorBallStyle:z,tipStyle:re}}});const Xi={key:0,ref:"rootEl",class:"PostBodyEditorCarets"},Yi={class:"othersSessions"},Zi=["data-key"],er={class:"selections"},tr={class:"avator"},or={key:0,class:"myCarets caret-group"},nr={key:1,class:"selections"};function sr(t,f,o,r,u,d){return t.isScrolling?D("",!0):(n(),y("div",Xi,[e("div",Yi,[(n(!0),y(le,null,Ce(t.caretAccountsByRows,l=>(n(),y("div",{key:l.sessionId,class:"caret-group","data-key":l.sessionId},[e("div",er,[(n(!0),y(le,null,Ce(l.carets,(v,i)=>(n(),y("div",{key:`${l.sessionId}_${i}`,class:Q(["selection",{isEmpty:v.left==="0px"&&v.width==="0px"}]),style:se(v)},null,6))),128))]),e("div",{class:"cursor",style:se(l.cursorStyle)},[e("div",tr,[e("div",{class:"small-color-ball",style:se(t.smallColorBallStyle(l.color))},null,4),e("div",{class:"tip",style:se(t.tipStyle(l.color))},[e("div",{style:se({backgroundImage:`url(${l.account.avatar})`}),class:"icon"},null,4),e("p",null,E(l.account.name),1)],4)])],4)],8,Zi))),128))]),t.focused||t.focusedPanel?(n(),y("div",or,[t.mySelectionIsSingle?(n(),y("div",{key:0,class:Q(["cursor my-cursor",{isMoving:t.isMoving,isSelecting:!t.mySelectionIsSingle}]),style:se(t.myCursorStyle)},null,6)):(n(),y("div",nr,[(n(!0),y(le,null,Ce(t.mySelectionStyles,(l,v)=>(n(),y("div",{key:`${v}`,class:Q(["selection",{isEmpty:l.left==="0px"&&l.width==="0px"}]),style:se(l)},null,6))),128))]))])):D("",!0)],512))}const lr=ie(uo,[["render",sr],["__scopeId","data-v-6efa0b84"]]);uo.__docgenInfo={exportName:"default",displayName:"PostBodyEditorCarets",description:"",tags:{},props:[{name:"editor",type:{name:"Editor"},required:!0,defaultValue:{func:!1,value:"null"}},{name:"focused",type:{name:"boolean"},required:!0,defaultValue:{func:!1,value:"false"}},{name:"schemaId",type:{name:"string"},required:!0},{name:"contentId",type:{name:"string"},required:!0},{name:"fieldKey",type:{name:"string"},required:!0},{name:"isEditing",type:{name:"boolean"},required:!0},{name:"focusedPanelType",type:{name:"PanelTypeEnum"},required:!0}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/PostBodyEditorCarets.vue"]};function ar(t,f){let o=0;return t.descendants((r,u)=>{if(r.attrs.threadId===f){o=u;return}r.marks.some(l=>l.attrs.threadId===f)&&(o=u)}),o}const co=ee({components:{},props:{editor:{type:Object,default:null,required:!0},comments:{type:Array,default:()=>[]}},setup(t,f){const{editor:o,comments:r}=he(t);return{threads:T(()=>{const{state:d,dom:l}=o.value.view;return r.value.reduce((v,i)=>{const g=ar(d.doc,i.comment.threadId);if(g===0)return v;const h=new Ms(o.value.state.doc.resolve(g));let p;if(h?.node?.attrs?.blockUid?p=h?.node?.attrs?.blockUid:p=Ns(_=>_.isBlock)(h)?.node?.attrs?.blockUid,!p)return v;if(v[p])v[p].authors.some(_=>_.id===i.comment.authorId)||v[p].authors.push(i.author);else{const _=l.querySelector(`[data-uid="${p}"]`)?.getBoundingClientRect(),c=l?.getBoundingClientRect();let S=0;_&&c&&(S=_.top-c.top+3),v[p]={authors:[i.author],visible:!!S,style:{top:`${S}px`}}}return{...v}},{})})}}});const ir={class:"PostBodyEditorComments"};function rr(t,f,o,r,u,d){return n(),y("div",ir,[(n(!0),y(le,null,Ce(t.threads,(l,v)=>(n(),y(le,null,[l.visible?(n(),y("div",{key:v,style:se(l.style),class:"thread"},[(n(!0),y(le,null,Ce(l.authors,i=>(n(),y("div",{key:i.id,class:"author"},[e("div",{class:"icon",style:se({backgroundImage:`url('${i.avatar}')`})},null,4)]))),128))],4)):D("",!0)],64))),256))])}const dr=ie(co,[["render",rr],["__scopeId","data-v-4f103ab4"]]);co.__docgenInfo={exportName:"default",displayName:"PostBodyEditorComments",description:"",tags:{},props:[{name:"editor",type:{name:"Editor"},required:!0,defaultValue:{func:!1,value:"null"}},{name:"comments",type:{name:"CmsComment[]"},defaultValue:{func:!0,value:"() => []"}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/PostBodyEditorComments.vue"]};const mo=ee({__name:"StudioComponentFontLoader",setup(t){return(f,o)=>(n(),y(le,null,[R(gs),R(hs)],64))}});mo.__docgenInfo={exportName:"default",displayName:"StudioComponentFontLoader",description:"",tags:{},sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/StudioComponentFontLoader.vue"]};const ur=["disabled"],cr={class:"image"},mr=["src"],po=ee({__name:"GuiImageInput",props:{rmValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1,required:!1},keyChain:{type:Array,required:!1,default:()=>[]}},emits:["click"],setup(t,{emit:f}){const o=t,r=f,{rmValue:u}=he(o),d=T(()=>u.value.value||"https://storage.googleapis.com/studio-front/default-img.png"),l=()=>{r("click")};return(v,i)=>(n(),y("div",{class:"GuiImageInput",disabled:t.disabled,onClick:l},[e("div",cr,[e("img",{src:d.value,alt:""},null,8,mr)])],8,ur))}});const pr=ie(po,[["__scopeId","data-v-66e6508c"]]);po.__docgenInfo={exportName:"default",displayName:"GuiImageInput",description:"",tags:{},props:[{name:"rmValue",type:{name:"RenderModelImage"},required:!0},{name:"disabled",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"keyChain",type:{name:"string[]"},required:!1,defaultValue:{func:!0,value:"() => []"}}],events:[{name:"click"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/StudioComponentPanel/GuiImageInput.vue"]};const fr={class:"ImagesPanelCollection"},vr={class:"tags"},_r=["onClick"],fo=ee({__name:"ImagesPanelCollection",props:{collection:{type:Object,required:!0}},emits:["open","search"],setup(t,{emit:f}){const o=f,r=u=>u.toString().replace(/(\d)(?=(\d{3})+$)/g,"$1,");return(u,d)=>(n(),y("div",fr,[e("div",{class:"collection-images",onClick:d[0]||(d[0]=l=>o("open",t.collection.id))},[(n(!0),y(le,null,Ce(t.collection.preview_photos,(l,v)=>(n(),y("div",{key:v,style:se({backgroundImage:`url(${l.urls.small})`})},null,4))),128))]),e("h3",null,E(t.collection.title),1),e("p",null,E(r(t.collection.total_photos))+" photos · Curated by "+E(t.collection.user.first_name)+" "+E(t.collection.user.last_name),1),e("ul",vr,[(n(!0),y(le,null,Ce(t.collection.tags,(l,v)=>(n(),y(le,null,[v<4?(n(),y("span",{key:v,onClick:i=>o("search",l.title)},E(l.title),9,_r)):D("",!0)],64))),256))])]))}});const gr=ie(fo,[["__scopeId","data-v-1acc3831"]]);fo.__docgenInfo={exportName:"default",displayName:"ImagesPanelCollection",description:"",tags:{},props:[{name:"collection",type:{name:"any"},required:!0}],events:[{name:"open",type:{names:["string"]}},{name:"search",type:{names:["string"]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/StudioComponentPanel/ImagesPanel/ImagesPanelCollection.vue"]};const vo=ee({__name:"ImageSelector",props:{studioDom:{}},emits:["select"],setup(t,{emit:f}){const o=t,r=T(()=>o.studioDom.content?.src),u=f,d=()=>{u("select",r.value)};return(l,v)=>(n(),y("div",{onClick:d},[Yo(l.$slots,"default")]))}});vo.__docgenInfo={exportName:"default",displayName:"ImageSelector",description:"",tags:{},props:[{name:"studioDom",required:!0,type:{name:"StudioDom"}}],events:[{name:"select",type:{names:["union"],elements:[{name:"string"},{name:"undefined"}]}}],slots:[{name:"default"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/StudioComponentPanel/ImagesPanel/ImageSelector.vue"]};const _o=t=>($e("data-v-4a00d753"),t=t(),Ie(),t),hr={class:"img"},yr=["src"],br=_o(()=>e("div",{class:"cover"},null,-1)),Cr={class:"photographer"},kr=["href"],Pr=_o(()=>e("i",{class:"material-icons"},"photo_camera",-1)),wr=[Pr],go=ee({__name:"ImagesPanelPhoto",props:{photo:{type:Object,required:!0}},emits:["select"],setup(t,{emit:f}){const o=t,r=f,u=T(()=>o.photo.urls.regular),d=T(()=>vt({uuid:"template-img"+o.photo.id,name:"Image",style:{width:"200px",height:`${Math.round(200*o.photo.height/o.photo.width)}px`},content:{type:"image",src:u.value}})),l=v=>{r("select",v)};return(v,i)=>(n(),H(vo,{class:Q(["ImagesPanelPhoto",{add:!0}]),"studio-dom":s(d),style:se({height:`${Math.round(139*t.photo.height/t.photo.width)}px`}),onSelect:l},{default:Z(()=>[e("div",hr,[e("img",{src:t.photo.urls.regular,style:se({background:t.photo.color})},null,12,yr),br]),e("div",{class:"content",onClick:i[0]||(i[0]=V(()=>{},["stop"]))},[e("div",Cr,[e("a",{href:`https://unsplash.com/photos/${t.photo.id}?utm_source=STUDIO&utm_medium=referral`,target:"_blank"},wr,8,kr),e("p",null,E(t.photo.user.name),1)])])]),_:1},8,["studio-dom","style"]))}});const Ft=ie(go,[["__scopeId","data-v-4a00d753"]]);go.__docgenInfo={exportName:"default",displayName:"ImagesPanelPhoto",description:"",tags:{},props:[{name:"photo",type:{name:"any"},required:!0}],events:[{name:"select",type:{names:["union"],elements:[{name:"string"},{name:"undefined"}]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/StudioComponentPanel/ImagesPanel/ImagesPanelPhoto.vue"]};const tt=t=>($e("data-v-4f2d0718"),t=t(),Ie(),t),$r={class:"ImagesPanel"},Ir={class:"input"},Sr=["value"],Tr=tt(()=>e("i",{class:"fa fa-random"},null,-1)),Er=[Tr],Fr=tt(()=>e("i",{class:"unsplash-icon"},[e("svg",{width:"16",height:"16"},[e("use",{href:"#i-16-unsplash"})])],-1)),Rr={class:"nav"},Mr={key:0,class:"collection-title"},Nr=tt(()=>e("i",{class:"material-icons"},"expand_more",-1)),Ar=[Nr],Br={class:"uls"},xr={class:"left"},Dr={class:"right"},Hr={class:"loading"},qr=tt(()=>e("div",{class:"spinner-2"},[e("span")],-1)),Lr=[qr],Ur={class:"collections"},Or={class:"loading"},zr=tt(()=>e("div",{class:"spinner-2"},[e("span")],-1)),Kr=[zr],ho=ee({__name:"ImagesPanel",emits:["select"],setup(t,{emit:f}){const o=["Minimal","One color","Beige","Beach","Wallpapers","Textures & Patterns","Nature","Architecture","Business & Work","Animals","Travel","Fashion","Food & Drink","Spirituality","People","Spring","Summer","Autumn","Winter"],r=f,u=Ue(),d=b(),l=b("photos"),v=b(null),i=b(null),g=b(null),h=T(()=>u.state.unsplash.keyword),p=T(()=>u.state.unsplash.loading),C=T(()=>u.state.unsplash.collections),_=T(()=>u.state.unsplash.collectionId),c=T(()=>[{value:"photos",label:`${G(A.value?.total)} Photos`},{value:"collections",label:`${G(C.value.total)} Collections`}]),S=T(()=>A.value?A.value.list.length<A.value.total:!1),B=T(()=>C.value.list.length<C.value.total),A=T(()=>{const I=u.state.unsplash.collectionPhotos,U=u.state.unsplash.photos;return _.value?I:U}),F=T(()=>A.value?A.value.list.filter(I=>I.side==="left"):[]),P=T(()=>A.value?A.value.list.filter(I=>I.side==="right"):[]),a=T(()=>_.value?C.value.list.find(I=>I.id===_.value):null),m=()=>{u.dispatch("unsplash/loadPhotos")},q=()=>{u.dispatch("unsplash/loadCollections")},$=()=>{u.dispatch("unsplash/loadCollectionPhotos")},j=I=>{I.target instanceof HTMLInputElement&&(I.target.blur(),O(I.target.value))},O=I=>{u.dispatch("unsplash/searchByKeyword",{keyword:I}),u.dispatch("unsplash/closeCollectionPhotos")},w=I=>{u.dispatch("unsplash/searchByCollectionId",{collectionId:I})},x=()=>{u.dispatch("unsplash/closeCollectionPhotos")},G=I=>I.toString().replace(/(\d)(?=(\d{3})+$)/g,"$1,"),z=()=>{u.dispatch("studioAction/cancel")},re=I=>{l.value=I},L=()=>{const I=o.filter(W=>W!==h.value),U=I[Math.floor(Math.random()*I.length)];O(U)},M=I=>{r("select",I)};return Pe(()=>{if(!h.value){const I=o[Math.floor(Math.random()*o.length)];O(I)}d.value=new IntersectionObserver(I=>{if(!h.value)return;const U=I[0]&&I[0].isIntersecting&&I[0].target;U&&(U.id==="more-photos"?_.value?$():m():U.id==="more-collections"&&q())}),v.value&&d.value.observe(v.value),i.value&&d.value.observe(i.value)}),Te(()=>{const I=v.value,U=i.value;d.value&&(I&&d.value.unobserve(I),U&&d.value.unobserve(U))}),(I,U)=>{const W=Me("tooltip");return n(),y("div",$r,[e("div",Ir,[e("input",{ref_key:"searchRef",ref:g,value:s(h),onChange:j},null,40,Sr),me((n(),y("button",{class:"random",onClick:L},Er)),[[W,{content:"Random",delay:{show:0,hide:0}},void 0,{bottom:!0}]]),Fr]),e("div",Rr,[s(_)?(n(),y("div",Mr,[e("h2",null,E(s(a).title),1),e("button",{onClick:x},Ar)])):(n(),H(ys,{key:1,options:s(c),value:s(l),"onUpdate:value":re},null,8,["options","value"]))]),me(e("div",{class:"photos",onMouseleave:z},[e("div",Br,[e("ul",xr,[(n(!0),y(le,null,Ce(s(F),(J,ne)=>(n(),H(Ft,{key:J.id+ne,photo:J,onSelect:M},null,8,["photo"]))),128))]),e("ul",Dr,[(n(!0),y(le,null,Ce(s(P),(J,ne)=>(n(),H(Ft,{key:J.id+ne,photo:J,onSelect:M},null,8,["photo"]))),128))]),me(e("div",Hr,Lr,512),[[qe,s(p)]]),me(e("div",{id:"more-photos",ref_key:"morePhotosRef",ref:v,class:"more"},null,512),[[qe,!s(p)&&s(S)]])])],544),[[qe,s(l)==="photos"||s(_)]]),me(e("div",Ur,[e("ul",null,[(n(!0),y(le,null,Ce(s(C).list,J=>(n(),H(gr,{key:J.id,collection:J,onSearch:O,onOpen:w},null,8,["collection"]))),128)),me(e("div",Or,Kr,512),[[qe,s(p)]]),me(e("div",{id:"more-collections",ref_key:"moreCollectionsRef",ref:i,class:"more",onClick:q},null,512),[[qe,!s(p)&&s(B)]])])],512),[[qe,s(l)==="collections"&&!s(_)]])])}}});const jr=ie(ho,[["__scopeId","data-v-4f2d0718"]]);ho.__docgenInfo={exportName:"default",displayName:"ImagesPanel",description:"",tags:{},events:[{name:"select",type:{names:["union"],elements:[{name:"string"},{name:"undefined"}]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/StudioComponentPanel/ImagesPanel/ImagesPanel.vue"]};const Gr=["data-prop-key"],Wr={class:"title"},Vr={class:"key"},Jr={class:"input"},yo=ee({__name:"DefItem",props:{rm:{type:Object,required:!0},def:{type:Object,required:!0},indexChain:{type:Array,required:!0},keyChain:{type:Array,required:!0}},setup(t){const f=t,{modifyState:o,confirm:r}=bs(),u=b(!1),d=()=>{u.value=!0},l=C=>{C&&(o?.(f.def.key,C),r(),u.value=!1)},{rm:v,def:i}=he(f),g=b(!0),h=T(()=>i.value.type),p=T(()=>{const C=v.value[i.value.key];return C.value!==void 0?C:{value:C}});return Pe(()=>{i.value.type==="cmsRequest"&&(g.value=!0),i.value.type==="json"&&(g.value=!1)}),(C,_)=>(n(),y(le,null,[u.value?(n(),H(jr,{key:0,onSelect:l})):D("",!0),u.value?D("",!0):(n(),y("div",{key:1,class:"DefItem","data-prop-key":s(i).key},[e("div",Wr,[e("p",Vr,E(s(i).name||s(i).key),1)]),e("div",Jr,[h.value==="number"?(n(),H(Cs,{key:0,"rm-value":p.value,"key-chain":t.keyChain},null,8,["rm-value","key-chain"])):D("",!0),h.value==="string"?(n(),H(ks,{key:1,"rm-value":p.value,"key-chain":t.keyChain},null,8,["rm-value","key-chain"])):D("",!0),h.value==="image"?(n(),H(pr,{key:2,"rm-value":p.value,"key-chain":t.keyChain,onClick:d},null,8,["rm-value","key-chain"])):D("",!0),h.value==="boolean"?(n(),H(Ps,{key:3,"rm-value":p.value,"key-chain":t.keyChain},null,8,["rm-value","key-chain"])):D("",!0),h.value==="color"?(n(),H(ws,{key:4,"rm-value":p.value,"key-chain":t.keyChain},null,8,["rm-value","key-chain"])):D("",!0)])],8,Gr))],64))}});const Qr=ie(yo,[["__scopeId","data-v-a239526c"]]);yo.__docgenInfo={exportName:"default",displayName:"DefItem",description:"",tags:{},props:[{name:"rm",type:{name:"RenderModel"},required:!0},{name:"def",type:{name:"StudioDef"},required:!0},{name:"indexChain",type:{name:"number[]"},required:!0},{name:"keyChain",type:{name:"string[]"},required:!0}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/StudioComponentPanel/DefItem.vue"]};const Xr={class:"preview"},Yr={class:"title"},Zr=236,bo=ee({__name:"StudioComponentPanelComponentListItem",props:{studioDom:{},info:{},symbol:{}},emits:["select"],setup(t,{emit:f}){const o=t,r=f,u=()=>{r("select",o.symbol.uuid)},d=Nt(),{targetRenderTree:l}=_t(d),{studioDom:v,info:i,symbol:g}=he(o),h=T(()=>l.value({studioDom:vt(v.value)})),p=T(()=>{const{defaultSize:c}=i.value;if(!c)return 0;const S=Math.max(c.width,c.height);return Math.min(Zr/S,1)}),C=()=>{const{defaultSize:c}=i.value;return{width:c.width*p.value+"px",height:c.height*p.value+"px"}},_=()=>{const{defaultSize:c}=i.value;return{width:c.width+"px",height:c.height+"px",transform:`scale(${p.value})`}};return(c,S)=>(n(),y("div",{onClick:u},[e("div",Xr,[e("div",{class:"outer",style:C},[e("div",{class:"inner",style:_},[R(s($s),{"render-dom":s(h),role:"template"},null,8,["render-dom"])])])]),e("div",Yr,[e("p",null,E(s(g).name),1)])]))}});const ed=ie(bo,[["__scopeId","data-v-ad1d0300"]]);bo.__docgenInfo={exportName:"default",displayName:"StudioComponentPanelComponentListItem",description:"",tags:{},props:[{name:"studioDom",required:!0,type:{name:"StudioDom"}},{name:"info",required:!0,type:{name:"{ defaultSize: { width: number; height: number } }"}},{name:"symbol",required:!0,type:{name:"StudioSymbol"}}],events:[{name:"select"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/StudioComponentPanel/StudioComponentPanelComponentListItem.vue"]};const Co=ee({__name:"StudioComponentPanelComponentList",emits:["select"],setup(t,{emit:f}){const o=f,r=Ue(),u=T(()=>r.state.studioSymbol.symbols.map(v=>({view:{type:"ref",uuid:"ref",refId:v.uuid,style:{}},info:{defaultSize:v.defaultSize},symbolUuid:v.uuid,symbol:v}))),d=l=>{o("select",l)};return(l,v)=>(n(),y("ul",null,[(n(!0),y(le,null,Ce(s(u),i=>(n(),y("li",{key:i.symbol.uuid},[R(ed,{"studio-dom":i.view,info:i.info,symbol:i.symbol,onSelect:d},null,8,["studio-dom","info","symbol"])]))),128))]))}});Co.__docgenInfo={exportName:"default",displayName:"StudioComponentPanelComponentList",description:"",tags:{},events:[{name:"select"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/StudioComponentPanel/StudioComponentPanelComponentList.vue"]};const ko=t=>($e("data-v-a95fb1ea"),t=t(),Ie(),t),td={class:"header"},od=ko(()=>e("div",{class:"title"},[e("i",{class:"material-icons"},"widgets"),e("p",null,"Component")],-1)),nd={key:0},sd={key:0,class:"properties"},ld=ko(()=>e("div",{class:"title"},"Property",-1)),ad={key:0,class:"no-property"},id={class:"actions"},rd={key:1,class:"components"},Po=ee({__name:"StudioComponentPanel",props:{editor:{default:null},focusedPanelType:{default:null}},emits:["setFocusPanel"],setup(t,{emit:f}){const o=t,r=f,u=Nt();Is({add:()=>{},move:()=>{},remove:()=>{},renameKey:()=>{},modifyDef:()=>{},modifyState:($,j)=>{_.value={..._.value,[$]:j}},modifyProp:()=>{},removeProps:()=>{},confirm:()=>{}});const d=b(null),{editor:l,focusedPanelType:v}=he(o),i=b(!1),g=b({left:"",top:""}),h=b(!1),p=()=>{h.value=!0},C=b(""),_=b({}),c=T(()=>!C.value),S=T(()=>!!C.value),B=T(()=>{if(!C.value)return null;const $={type:"ref",uuid:"ref",refId:C.value,state:_.value,style:{}};return u.targetRenderTree({studioDom:vt($)})}),A=T(()=>B.value?.defs.filter($=>["string","image","boolean","number","icon","color","array"].includes($.type))||[]),F=()=>{C.value=l?.value?.state.selection?.node.attrs.refUuid??"",_.value=l?.value?.state.selection?.node.attrs.state??""},P=()=>{const{view:$}=l.value,{state:j,dom:O}=$;setTimeout(()=>{if(!d.value)return;const{from:w,to:x}=j.selection,G=$.coordsAtPos(w),z=$.coordsAtPos(x),re=O.getBoundingClientRect(),L=d.value.getBoundingClientRect(),M=(G.left+z.left)/2-re.left;g.value.left=`${Math.round(Math.min(re.width-L.width/2,Math.max(M,L.width/2)))}px`,g.value.top=`${Math.round(G.top-re.top)}px`,i.value=!0},0)},a=$=>{C.value=$,l?.value?.commands.updateStudioComponent({refUuid:$,state:{}})},m=()=>{h.value=!1,l?.value?.commands.updateStudioComponent({refUuid:C.value,state:_.value}),l?.value?.commands.focus()},q=()=>{h.value=!1};return X(()=>l.value.state.selection,($,j)=>{($.from!==j.from||$.to!==j.to)&&(h.value=!1,F(),P())}),X(v,$=>{$==="StudioComponentPanel"&&P()},{immediate:!0}),Pe(()=>{F(),P(),window.addEventListener("resize",P)}),Te(()=>{r("setFocusPanel",ce.None),window.removeEventListener("resize",P)}),($,j)=>(n(),y("div",{ref_key:"rootEl",ref:d,class:Q(["StudioComponentPanel",{"is-active":i.value}]),style:se(g.value)},[e("div",td,[od,h.value?(n(),y("button",{key:0,onClick:q},"Cancel")):(n(),y("button",{key:1,onClick:p},"Edit"))]),h.value?(n(),y("div",nd,[s(S)&&s(B)?(n(),y("div",sd,[ld,s(A).length===0?(n(),y("div",ad,[e("span",null,E($.$t("No properties")),1)])):D("",!0),(n(!0),y(le,null,Ce(s(A),(O,w)=>(n(),H(Qr,{key:O.uid,"index-chain":[w],"key-chain":[O.key],rm:s(B).rm,def:O},null,8,["index-chain","key-chain","rm","def"]))),128)),e("div",id,[e("button",{class:"btn-submit",type:"submit",onClick:m},E($.$t("CMS EmbedPanel: Update")),1)])])):D("",!0),s(c)?(n(),y("div",rd,[R(Co,{onSelect:a})])):D("",!0)])):D("",!0)],6))}});const dd=ie(Po,[["__scopeId","data-v-a95fb1ea"]]);Po.__docgenInfo={exportName:"default",displayName:"StudioComponentPanel",description:"",tags:{},props:[{name:"editor",required:!1,type:{name:"Editor"},defaultValue:{func:!1,value:"null"}},{name:"focusedPanelType",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"null"}}],events:[{name:"setFocusPanel"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/StudioComponentPanel/StudioComponentPanel.vue"]};const ud={class:"group"},cd={class:"_flex _flex-row _items-center _gap-8"},md={class:"label-sm2-normal _text-black"},pd={class:"text"},fd={class:"text"},vd={class:"text"},wo=ee({__name:"TablePanelCellLeft",props:{editor:{}},setup(t){const f=t,{editor:o}=he(f),{tableRect:r,isSingleRowSelected:u,isRowHead:d,rowIsHead:l}=et(),v=xe(),i=g=>{switch(g){case"addRowBefore":{if(l.value===!0&&r.value?.top===0){alert(v.t("The operation is not allowed"));break}o.value.chain().focus().addRowBefore().run();break}case"addRowAfter":o.value.chain().focus().addRowAfter().run();break;case"deleteRow":o.value.chain().focus().deleteRow().run();break;case"toggleHeaderRow":{f.editor.chain().focus().toggleHeaderRow().run();break}}};return(g,h)=>{const p=te("PfIcon"),C=te("PfToggleSwitch");return n(),y(le,null,[e("div",ud,E(g.$t("CMS TablePanel: Edit row")),1),s(d)&&s(u)?(n(),y("label",{key:0,class:"button-common _flex _w-full _flex-row _items-center _justify-between _px-16 _py-8",onClick:h[0]||(h[0]=V(_=>i("toggleHeaderRow"),["stop"]))},[e("div",cd,[R(p,{class:"_pointer-events-none",icon:"tableHeaderRow",size:"16"}),e("span",md,E(g.$t("CMS TablePanel: Header row")),1)]),R(C,{class:"_pointer-events-none","model-value":s(l)},null,8,["model-value"])])):s(d)?D("",!0):(n(),y("button",{key:1,class:"button-common",onClick:h[1]||(h[1]=_=>i("addRowBefore"))},[R(p,{class:"_pointer-events-none",icon:"insertRowBefore",size:"16"}),e("span",pd,E(g.$t("CMS TablePanel: Insert above")),1)])),e("button",{class:"button-common",onClick:h[2]||(h[2]=_=>i("addRowAfter"))},[R(p,{class:"_pointer-events-none",icon:"insertRowAfter",size:"16"}),e("span",fd,E(g.$t("CMS TablePanel: Insert below")),1)]),e("button",{class:"button-common",onClick:h[3]||(h[3]=_=>i("deleteRow"))},[R(p,{class:"_pointer-events-none",icon:"dustbox",size:"16"}),e("span",vd,E(g.$t("CMS TablePanel: Delete row")),1)])],64)}}});const _d=ie(wo,[["__scopeId","data-v-4ff63af3"]]);wo.__docgenInfo={exportName:"default",displayName:"TablePanelCellLeft",description:"",tags:{},props:[{name:"editor",required:!0,type:{name:"Editor"}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/TablePanel/TablePanelCellLeft.vue"]};const gd={class:"group"},hd={class:"_flex _flex-row _items-center _gap-8"},yd={class:"label-sm2-normal _text-black"},bd={class:"text"},Cd={class:"text"},kd={class:"text"},$o=ee({__name:"TablePanelCellTop",props:{editor:{}},setup(t){const f=t,{editor:o}=he(f),{tableRect:r,isSingleColSelected:u,isColHead:d,colIsHead:l}=et(),v=xe(),i=g=>{switch(g){case"addColumnBefore":{if(l.value===!0&&r.value?.left===0){alert(v.t("The operation is not allowed"));break}o.value.chain().focus().addColumnBefore().run();break}case"addColumnAfter":o.value.chain().focus().addColumnAfter().run();break;case"deleteColumn":o.value.chain().focus().deleteColumn().run();break;case"toggleHeaderColumn":o.value.chain().focus().toggleHeaderColumn().run();break}};return(g,h)=>{const p=te("PfIcon"),C=te("PfToggleSwitch");return n(),y(le,null,[e("div",gd,E(g.$t("CMS TablePanel: Edit column")),1),s(d)&&s(u)?(n(),y("label",{key:0,class:"button-common _flex _w-full _flex-row _items-center _justify-between _px-16 _py-8",onClick:h[0]||(h[0]=V(_=>i("toggleHeaderColumn"),["stop"]))},[e("div",hd,[R(p,{class:"_pointer-events-none",icon:"tableHeaderColumn",size:"16"}),e("span",yd,E(g.$t("CMS TablePanel: Header column")),1)]),R(C,{class:"_pointer-events-none","model-value":s(l)},null,8,["model-value"])])):s(d)?D("",!0):(n(),y("button",{key:1,class:"button-common",onClick:h[1]||(h[1]=_=>i("addColumnBefore"))},[R(p,{class:"_pointer-events-none",icon:"insertColumnBefore",size:"16"}),e("span",bd,E(g.$t("CMS TablePanel: Insert left")),1)])),e("button",{class:"button-common",onClick:h[2]||(h[2]=_=>i("addColumnAfter"))},[R(p,{class:"_pointer-events-none",icon:"insertColumnAfter",size:"16"}),e("span",Cd,E(g.$t("CMS TablePanel: Insert right")),1)]),e("button",{class:"button-common",onClick:h[3]||(h[3]=_=>i("deleteColumn"))},[R(p,{class:"_pointer-events-none",icon:"dustbox",size:"16"}),e("span",kd,E(g.$t("CMS TablePanel: Delete column")),1)])],64)}}});const Pd=ie($o,[["__scopeId","data-v-fb5186cc"]]);$o.__docgenInfo={exportName:"default",displayName:"TablePanelCellTop",description:"",tags:{},props:[{name:"editor",required:!0,type:{name:"Editor"}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/TablePanel/TablePanelCellTop.vue"]};const Ae=b(void 0),Be=b(void 0),Io=()=>{const t=T(()=>{if(Ae.value===void 0&&Be.value==="auto")return"left";if(Ae.value==="auto"&&Be.value==="auto")return"center";if(Ae.value==="auto"&&Be.value===void 0)return"right"});return{tableMarginLeft:Ae,tableMarginRight:Be,tablePosition:t,onChangeTableMargin:o=>{t.value===o?(Ae.value=void 0,Be.value=void 0):o==="left"?(Ae.value=void 0,Be.value="auto"):o==="center"?(Ae.value="auto",Be.value="auto"):o==="right"&&(Ae.value="auto",Be.value=void 0)}}},So=ee({__name:"TablePanelCell",props:{editor:{}},setup(t){const f=t,{tablelRectIndex:o}=et(),r=b(null),u=b(null),d=b(!1),{editor:l}=he(f),v=b(!1),i=b({left:"",top:""}),g=b({left:"",top:""}),h=b({left:"",top:""}),{tablePosition:p}=Io(),{isScrolling:C}=Kt(),_=()=>{B.value===!1&&(v.value=!1,d.value=!1);const{view:F}=l.value,{state:P,dom:a}=F;l.value.view.composing||setTimeout(()=>{if(!r.value||!u.value)return;const m=P.selection.$anchor,q=Wt(P.selection)?P.selection.node:m.node(m.depth),$=jt(P.doc,q,a);if(!$)return;const{levelOneDom:j}=$,O=j.querySelector("table"),w=j.querySelector(`table tbody tr:nth-child(${o.value.top}) :nth-child(${o.value.left})`),x=j.querySelector(`table tbody tr:nth-child(${o.value.bottom}) :nth-child(${o.value.right})`),G=O?.getBoundingClientRect(),z=w?.getBoundingClientRect(),re=x?.getBoundingClientRect();if(!G||!z||!re)return;const L=a.getBoundingClientRect(),M=r.value.getBoundingClientRect(),I=u.value.getBoundingClientRect(),U=(z.left+re.right)/2-L.left-M.width/2;i.value.left=`${Math.round(Math.min(Math.max(U,M.width/2),L.width-15))}px`,i.value.top=`${Math.round(G.top-L.top-M.height/2)+1}px`;const W=(z.top+re.bottom)/2-L.top-I.height/2;g.value.left=`${Math.round(Math.max(-I.width/2,G.left-L.left-I.width/2))+1}px`,g.value.top=`${Math.round(Math.min(L.height-I.height/2,Math.max(W,I.height/2)))}px`,v.value=!0},0)},c=b(),S=F=>{c.value===F?(c.value=void 0,d.value=!d.value):(c.value=F,d.value=!0),F==="row"?(A("row"),h.value.left=`${parseInt(g.value.left,10)+23}px`,h.value.top=`${parseInt(g.value.top,10)}px`):F==="col"&&(A("col"),h.value.left=`${parseInt(i.value.left,10)}px`,h.value.top=`${parseInt(i.value.top,10)+23}px`)},B=b(!1),A=F=>{B.value=!0,F==="col"?l.value.commands.selectColCells():F==="row"&&l.value.commands.selectRowCells(),setTimeout(()=>{requestAnimationFrame(()=>{B.value=!1})},200)};return X(C,(F,P)=>{B.value=!0,v.value=!F,F===!1&&P===!0&&(_(),requestAnimationFrame(()=>{c.value==="row"?(h.value.left=`${parseInt(g.value.left,10)+23}px`,h.value.top=`${parseInt(g.value.top,10)}px`):c.value==="col"&&(h.value.left=`${parseInt(i.value.left,10)}px`,h.value.top=`${parseInt(i.value.top,10)+23}px`)})),setTimeout(()=>{requestAnimationFrame(()=>{B.value=!1})},200)}),X(()=>l.value.state,(F,P)=>{const a=()=>{_(),B.value===!1&&(c.value=void 0)},m=nt(F);if(!m)return;const q=nt(P);if(!q){a();return}if(F.selection.$anchor.parent.attrs.blockUid!==P.selection.$anchor.parent.attrs.blockUid){a();return}m.top===q.top&&m.bottom===q.bottom&&m.left===q.left&&m.right===q.right||a()}),X(p,()=>{v.value=!1,d.value=!1,_()}),Pe(()=>{_(),window.addEventListener("resize",_)}),Te(()=>{window.removeEventListener("resize",_)}),(F,P)=>{const a=te("PfIcon");return n(),y("div",{class:Q(["TablePanelCell",{"is-active":v.value}])},[e("button",{ref_key:"handleColEl",ref:r,class:"handle col",style:se(i.value),onClick:P[0]||(P[0]=m=>S("col"))},[R(a,{"icon-color":"gray-500",class:"_pointer-events-none",icon:"arrowDropDown",size:"16"})],4),e("button",{ref_key:"handleRowEl",ref:u,class:"handle row",style:se(g.value),onClick:P[1]||(P[1]=m=>S("row"))},[R(a,{"icon-color":"gray-500",class:"_pointer-events-none",icon:"arrowDropRight",size:"16"})],4),d.value?(n(),y("div",{key:0,class:"menu",style:se(h.value)},[c.value==="col"?(n(),H(Pd,{key:0,editor:s(l)},null,8,["editor"])):D("",!0),c.value==="row"?(n(),H(_d,{key:1,editor:s(l)},null,8,["editor"])):D("",!0)],4)):D("",!0)],2)}}});const wd=ie(So,[["__scopeId","data-v-67de364e"]]);So.__docgenInfo={exportName:"default",displayName:"TablePanelCell",description:"",tags:{},props:[{name:"editor",required:!0,type:{name:"Editor"}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/TablePanel/TablePanelCell.vue"]};const $d=t=>($e("data-v-477f07b3"),t=t(),Ie(),t),Id=$d(()=>e("div",{class:"left"},null,-1)),Sd={class:"right"},Td={class:"tableMargin_menu"},To=ee({__name:"TablePanelHead",props:{editor:{}},emits:["setFocusPanel"],setup(t,{emit:f}){const o=t,r=f,u=b(null),{editor:d}=he(o),l=b(!1),v=b(""),i=b(!1),g=b({left:"",top:"",width:""}),{tableMarginLeft:h,tableMarginRight:p,tablePosition:C,onChangeTableMargin:_}=Io(),{width:c}=Gt(),S=()=>{l.value=!1;const{view:a}=d.value,{state:m,dom:q}=a;d.value.view.composing||setTimeout(()=>{if(!u.value)return;const $=m.selection.$anchor,j=Wt(m.selection)?m.selection.node:$.node($.depth),O=jt(m.doc,j,q);if(!O)return;const{levelOneDom:w}=O,x=w?.getBoundingClientRect();if(!x)return;const G=q.getBoundingClientRect();G&&(g.value.left="0",g.value.top=`${Math.round(x.top-G.top)}px`,g.value.width=`${Math.round(G.width)}px`,l.value=!0)},0)},B=()=>{d.value.isActive("table")&&F()},A=(a,m=!1)=>{d.value.commands.setTableAttrs(a),m&&d.value.commands.focus()},F=()=>{const a=d.value.commands.getTableAttrs()||{},{blockUid:m,marginLeft:q,marginRight:$}=a;v.value=m||"",h.value=q||void 0,p.value=$||void 0},P=a=>{i.value=!0,_(a),A({marginLeft:h.value,marginRight:p.value},!0),r("setFocusPanel",ce.None)};return X(()=>d.value.state.selection,(a,m)=>{(a.from!==m.from||a.to!==m.to)&&(S(),B())},{immediate:!1}),X(c,()=>{S()}),Pe(()=>{S(),B(),window.addEventListener("resize",S)}),Te(()=>{window.removeEventListener("resize",S)}),(a,m)=>{const q=te("PfIcon");return n(),y("div",{ref_key:"rootEl",ref:u,key:v.value,class:Q(["TablePanelHead",{"is-active":l.value}]),style:se(g.value)},[Id,e("div",Sd,[e("div",Td,[e("button",{class:"button-common",onClick:m[0]||(m[0]=$=>P("left"))},[R(q,{"icon-color":s(C)==="left"?"black":"gray-500",class:"_pointer-events-none",icon:"alignLeft",size:"16"},null,8,["icon-color"])]),e("button",{class:"button-common",onClick:m[1]||(m[1]=$=>P("center"))},[R(q,{"icon-color":s(C)==="center"?"black":"gray-500",class:"_pointer-events-none",icon:"alignCenter",size:"16"},null,8,["icon-color"])]),e("button",{class:"button-common",onClick:m[2]||(m[2]=$=>P("right"))},[R(q,{"icon-color":s(C)==="right"?"black":"gray-500",class:"_pointer-events-none",icon:"alignRight",size:"16"},null,8,["icon-color"])])])])],6)}}});const Ed=ie(To,[["__scopeId","data-v-477f07b3"]]);To.__docgenInfo={exportName:"default",displayName:"TablePanelHead",description:"",tags:{},props:[{name:"editor",required:!0,type:{name:"Editor"}}],events:[{name:"setFocusPanel",type:{names:["PanelTypeEnum"]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/TablePanel/TablePanelHead.vue"]};const Eo=ee({__name:"TablePanel",props:{editor:{},comments:{}},emits:["setFocusPanel"],setup(t,{emit:f}){const o=f;return(r,u)=>(n(),y(le,null,[R(Ed,{editor:r.editor,comments:r.comments,onSetFocusPanel:u[0]||(u[0]=d=>o("setFocusPanel",d))},null,8,["editor","comments"]),R(wd,{editor:r.editor},null,8,["editor"])],64))}});Eo.__docgenInfo={exportName:"default",displayName:"TablePanel",description:"",tags:{},props:[{name:"editor",required:!0,type:{name:"Editor"}},{name:"comments",required:!1,type:{name:"Array",elements:[{name:"CmsComment"}]}}],events:[{name:"setFocusPanel",type:{names:["PanelTypeEnum"]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/TablePanel/TablePanel.vue"]};async function Fd(t,f){const{projectId:o}=f,r=gt(o),u=ht.now();return(await pn(r,{...t,resolved:!1,createdAt:u,updatedAt:u})).id}async function Rd(t,f,o){const{projectId:r}=o,u=At(r,f),d=ht.now();await fn(u,{...t,updatedAt:d},{merge:!0})}async function Md(t,f){const{projectId:o}=f,r=At(o,t);await vn(r)}async function Nd(t,f){const o=_n(hn()),{projectId:r}=f,u=Bt(gt(r),mt("threadId","==",t)),d=await gn(u),l=ht.now();d.docs.forEach(v=>{o.set(v.ref,{resolved:!0,resolvedAt:l},{merge:!0})}),await o.commit()}const ot={update:Rd,create:Fd,remove:Md,resolve:Nd};function Ad(t){const f=Bt(gt(t.path.cmsId),yn("createdAt","desc"),mt("contentId","==",t.path.contentId),mt("resolved","==",!1));return bn(f,o=>{const r=o.docs.map(Bd);t.subscribe(r)})}function Bd(t){const f=t.data();return{commentId:t.id,authorId:f.authorId,content:f.content,threadId:f.threadId,targetText:f.targetText,schemaId:f.schemaId,contentId:f.contentId,createdAt:f.createdAt?.toDate(),updatedAt:f.updatedAt?.toDate(),resolvedAt:f.resolvedAt?.toDate(),resolved:f.resolved}}const xd={findSubscribe:Ad},Qe={subscribeComments(t,f){const o=Ge.cmsProjectId;return xd.findSubscribe({path:{cmsId:o,contentId:t},subscribe:r=>{const u=r.map(d=>{const l=Ge.findUserById(d.authorId);return{comment:d,author:l.camelCase()}});f(u)}})},async add(t){const f=Cn().state.v2.account.id,o=Ge.cmsProjectId;return await ot.create({...t,authorId:f},{projectId:o})},async update(t){const{commentId:f,partial:o}=t;await ot.update(o,f,{projectId:Ge.cmsProjectId})},async delete(t){const{commentId:f}=t;await ot.remove(f,{projectId:Ge.cmsProjectId})},async resolve(t){const{threadId:f}=t;await ot.resolve(f,{projectId:Ge.cmsProjectId})}},Dd={key:0,class:"post-body-editor"},Fo=ee({__name:"PostBodyEditor",props:{collaboration:{},contentId:{},field:{},isScheduled:{type:Boolean},schemaId:{},value:{}},emits:["input"],setup(t,{emit:f}){const o=t,r=f,{value:u,field:d,collaboration:l,schemaId:v,contentId:i}=he(o),g=kn(),h=Ve(300,async function(k){P.value=!1;const K={[d.value.key]:k};if(r("input",K),!i.value)return;const{deletedListForRequest:de,retrivedListForRequest:ge}=c.value.extensionStorage.studioCollaboration.nodeBlockList;if(!(ct(de)&&ct(ge)))try{await B({schemaId:v.value,contentId:i.value,fieldKey:d.value.key,deleteUids:de,retrieveUids:ge})}catch(be){console.log("err",be)}finally{console.log("finish 🍅")}}),p=async k=>{const K=new DataTransfer;K.items.add(k);const de=K.files;return(await g.uploadAssets(de,"cms_asset"))[0]},C=k=>{F.value=k},_=b(!1),c=As({content:"",editorProps:{attributes:{class:"in-cms"}},extensions:[Ss.configure({studioCollaboration:!0,tableEditable:!0,onRemoteHasDelayValue:k=>{h(k.getHTML())},onUpload:p,onEditFigure:C,setFocusPanel:k=>ve(k)})],onUpdate:k=>{k.transaction.getMeta(Ts)||h(k.editor.getHTML())},onCreate(){_.value=!0}}),{isSingleCellSelected:S}=Si(c),{updateCollaborationDeletedBlockUids:B}=Pn(),A=b(!1),F=b(!1),P=b(!1),a=b(!1),m=b(null),q=b([]),$=b(""),j=b(ce),O=b(null),{setEl:w}=Gt();X(O,k=>{k&&w(k.$el)});const x=T(()=>{if(c?.value?.isActive("table"))return S.value;const k=c.value.state.selection.$anchor,K=c.value.state.selection.$head,de=k.depth>0?1:0,ge=K.depth>0?1:0;if(!k.node(de).eq(K.node(ge)))return!1;const{from:be,to:Se}=c.value.state.selection;return!0}),G=T(()=>c?.value?.isActive("table")??!1),z=T(()=>c.value.isActive("figure")?ce.ImagePanel:c.value.isActive("embed_code")||c.value.isActive("embed_code_sandbox")?ce.EmbedPanel:c.value.isActive("studio_component")?ce.StudioComponentPanel:c.value.isActive("table_of_contents")?ce.None:$.value===ce.LinkPanel?ce.None:$.value===ce.CommentsPanel?ce.None:ce.InlinePanel),re=k=>{const K=c.value.getAttributes(k);return Object.keys(K).length>0},L=T(()=>$.value===ce.LinkPanel?!0:re("link")),M=T(()=>$.value===ce.CommentsPanel?!0:re("comments")),I=k=>{if(["ArrowRight","ArrowLeft","ArrowDown","ArrowUp"].some(Re=>Re===k.key)){J();return}if(a.value=k.isComposing&&k.key!=="Enter",k.isComposing&&k.key==="Enter")return;const de=k.key==="Backspace",ge=/^[\x20-\x7F]$/.test(k.key);(de||ge)&&(A.value=!0,W());const{from:be,to:Se}=c.value.view.state.selection;de&&be===1&&Se===1&&(!m.value||m.value?.from===1&&m.value?.to===1)&&U(),J()},U=()=>{const K=O.value.$el.querySelectorAll("[tabindex]")[0],de=Array.from(document.querySelectorAll("[tabindex]")),ge=de.findIndex(Re=>Re===K),be=(de.length+ge-1)%de.length;de[be].focus()},W=Ve(2e3,async function(){A.value=!1}),J=()=>{requestAnimationFrame(()=>{m.value=Vt.cloneDeep(c.value.view.state.selection)})},ne=b(!1),ye=({content:k})=>{_.value&&(c.value.chain().setContent(k).setMeta("addToHistory",!1).run(),ne.value=!0)},ue=Ve(200,async function(){P.value=!1,c.value.commands.studioCollaborationReceive({content:u.value,deletedBlockUids:l.value?.deletedBlockUids||{}})}),pe=({threadId:k,targetText:K,content:de})=>{Qe.add({threadId:k,targetText:K,content:de,schemaId:v.value,contentId:i.value})},oe=({commentId:k})=>{Qe.delete({commentId:k})},ae=({commentId:k,content:K})=>{Qe.update({commentId:k,partial:{content:K}})},fe=({threadId:k})=>{Qe.resolve({threadId:k}),ve(ce.None)},ve=k=>{$.value=k},N=()=>{r("input",{[d.value.key]:u.value})};let Y=()=>{};X(i,k=>{k&&(Y(),Y=Qe.subscribeComments(i.value,K=>{q.value=K}))},{immediate:!0}),X([u,_],()=>{if(ne.value)ue();else{if(u.value==="")return;ye({content:u.value})}},{immediate:!0,deep:!0}),X(l,()=>{_.value&&ue()},{immediate:!0,deep:!0}),X(()=>c.value?.state?.selection,(k,K)=>{K&&k.from===K.from&&k.to===K.to||(ve(ce.None),_e())},{deep:!0}),Te(()=>{Y(),_e&&_e.cancel&&_e.cancel(),c.value&&c.value.destroy()});const _e=Ve(5e3,function(){i.value&&(P.value||a.value||(P.value=!0,c.value.commands.studioCollaborationForceReceive({content:u.value})))});return(k,K)=>s(c)?(n(),y("div",Dd,[R(mo),e("div",{class:Q([[!k.isScheduled&&"_pointer-events-none"],"_left_0 _absolute _top-0 _z-1 _h-full _w-full"]),onClick:N},null,2),R(la,{editor:s(c),"is-editing-figure":F.value,onSetFocusPanel:ve},null,8,["editor","is-editing-figure"]),ne.value&&_.value?(n(),y(le,{key:0},[G.value?(n(),H(Eo,{key:0,comments:q.value,editor:s(c),onSetFocusPanel:ve},null,8,["comments","editor"])):D("",!0)],64)):D("",!0),x.value&&ne.value&&_.value?(n(),y(le,{key:1},[z.value===j.value.ImagePanel?(n(),H(Wa,{key:0,comments:q.value,editor:s(c),"editor-body":s(u),"focused-panel-type":$.value,upload:p,onSetFocusPanel:ve},null,8,["comments","editor","editor-body","focused-panel-type"])):z.value===j.value.EmbedPanel?(n(),H(Na,{key:1,editor:s(c),"focused-panel-type":$.value,onSetFocusPanel:ve},null,8,["editor","focused-panel-type"])):z.value===j.value.InlinePanel?(n(),H(li,{key:2,editor:s(c),"focused-panel-type":$.value,onSetFocusPanel:ve},null,8,["editor","focused-panel-type"])):D("",!0),M.value?(n(),H($a,{key:3,comments:q.value,editor:s(c),"focused-panel-type":$.value,"panel-bellow-link":L.value,onAddComment:pe,onDeleteComment:oe,onResolveThread:fe,onSetFocusPanel:ve,onUpdateComment:ae},null,8,["comments","editor","focused-panel-type","panel-bellow-link"])):D("",!0),L.value?(n(),H($i,{key:4,editor:s(c),"panel-bellow-comments":M.value,onSetFocusPanel:ve},null,8,["editor","panel-bellow-comments"])):z.value===j.value.StudioComponentPanel?(n(),H(dd,{key:5,editor:s(c),"focused-panel-type":$.value,onSetFocusPanel:ve},null,8,["editor","focused-panel-type"])):D("",!0)],64)):D("",!0),e("div",{class:"editor-main",onKeydown:I},[_.value?(n(),H(s(Bs),{key:0,ref_key:"editorContentRef",ref:O,editor:s(c),class:"content"},null,8,["editor"])):D("",!0),R(dr,{comments:q.value,editor:s(c)},null,8,["comments","editor"]),s(c)?(n(),H(lr,{key:1,"content-id":s(i),editor:s(c),"field-key":s(d).key,focused:s(c).isFocused,"focused-panel-type":$.value,"is-editing":A.value,"schema-id":s(v)},null,8,["content-id","editor","field-key","focused","focused-panel-type","is-editing","schema-id"])):D("",!0),k.$store.state.studioEditor.isDebugMode?(n(),H(Qi,{key:2,editor:s(c),value:s(u)},null,8,["editor","value"])):D("",!0)],32)])):D("",!0)}});const Hd=ie(Fo,[["__scopeId","data-v-d51925af"]]);Fo.__docgenInfo={exportName:"default",displayName:"PostBodyEditor",description:"",tags:{},props:[{name:"collaboration",required:!0,type:{name:"CmsContentCollaboration"}},{name:"contentId",required:!0,type:{name:"string"}},{name:"field",required:!0,type:{name:"CmsSchemaFieldForDetail"}},{name:"isScheduled",required:!0,type:{name:"boolean"}},{name:"schemaId",required:!0,type:{name:"string"}},{name:"value",required:!0,type:{name:"string"}}],events:[{name:"input",type:{names:["Partial"],elements:[{name:"CmsContent"}]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/PostBodyEditor.vue"]};const Ro=ee({__name:"PostTitleEditor",props:{field:{},isScheduled:{type:Boolean},value:{default:""}},emits:["change","update:value"],setup(t,{emit:f}){const o=t,r=f,u=b(),{value:d,field:l,isScheduled:v}=he(o),i=b(null),g=b(""),h=T(()=>l.value.key==="title"),p=m=>{g.value!==m&&(g.value=m,r("update:value",m))},C=()=>{u.value&&(u.value.textContent=d.value)},_=m=>{const{key:q,metaKey:$,ctrlKey:j,isComposing:O}=m;if(!O&&(q==="Enter"&&(m.preventDefault(),A()),($||j)&&/^[biu]$/.test(q))){m.preventDefault();return}m.stopPropagation()},c=m=>{const{isComposing:q}=m;q||F()},S=m=>{if(!m.clipboardData)return;const q=m.clipboardData.getData("text/plain"),j=xt(q).replace(/&nbsp;/g," ").replace(/\r?\n/g," ").replace(/<br>/g," ");document.execCommand("insertHTML",!1,j),m.preventDefault(),m.stopPropagation(),F()},B=()=>{if(!u.value)return;const m=u.value.textContent||"";m!==d.value&&(p(m),r("change",m))},A=()=>{const m=Array.from(document.querySelectorAll("[tabindex]")),q=m.findIndex(O=>O===u.value),$=(m.length+q+1)%m.length;m[$].focus()},F=()=>{requestAnimationFrame(()=>{i.value(u.value?.textContent)})},P=()=>{v.value&&r("change",d.value)};X(d,()=>{C()}),Pe(()=>{i.value=Vt.debounce(m=>p(m),400),C()});const a=()=>Zo("div",{ref:u,class:["title-div","focusable",...h.value?["title"]:[]],contenteditable:!0,tabindex:0,placeholder:"Input Title",onKeyup:c,onKeydown:_,onPaste:S,onCopy:F,onBlur:B,onInput:P});return(m,q)=>(n(),H(a))}});const qd=ie(Ro,[["__scopeId","data-v-525848a4"]]);Ro.__docgenInfo={exportName:"default",displayName:"PostTitleEditor",description:"",tags:{},props:[{name:"field",required:!0,type:{name:"CmsSchemaFieldForDetail"}},{name:"isScheduled",required:!0,type:{name:"boolean"}},{name:"value",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"''"}}],events:[{name:"change",type:{names:["string"]}},{name:"update:value",type:{names:["string"]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/post-edit/PostTitleEditor.vue"]};const Ld={class:"o-post-editor-header-live-preview-button"},Ud={class:"label-sm-normal _overflow-hidden _text-ellipsis _whitespace-nowrap"},Mo=ee({__name:"PostEditorHeaderLivePreviewButton",props:{pagePaths:{}},setup(t){const f=t,{openPreview:o}=Dt(),r=b(!1),u=b({top:0,right:0}),d=T(()=>({top:`${u.value.top}px`,right:`${u.value.right}px`,width:"200px"})),l=v=>{if(f.pagePaths.length===1){o(f.pagePaths[0].path);return}const i=v.currentTarget,{bottom:g,right:h}=i.getBoundingClientRect();u.value={top:g,right:window.innerWidth-h},r.value=!0};return(v,i)=>{const g=te("PfIcon"),h=te("PfButton"),p=te("PfRow"),C=te("PfColumn");return n(),y("div",Ld,[R(h,{size:"sm",variant:"tertiary",onClick:l},{default:Z(()=>[Ye(E(v.$t("CMS:Live Preview"))+" ",1),R(g,{icon:"openWindow","icon-color":"gray-500"})]),_:1}),(n(),H(Fe,{to:"#teleport-post-editor-overlay"},[R(Ne,null,{default:Z(()=>[s(r)?(n(),y("div",{key:0,class:"_fixed _top-0 _left-0 _z-dropdown _h-full _w-full",onClick:i[0]||(i[0]=V(_=>r.value=!1,["stop"])),onMouseover:i[1]||(i[1]=V(()=>{},["stop"]))},[R(C,{style:se(s(d)),class:"dropdown _absolute _bg-white",rounded:"6",shadow:"12"},{default:Z(()=>[(n(!0),y(le,null,Ce(v.pagePaths,_=>(n(),H(p,{key:_.path,align:"center",class:"border-b-1 _cursor-pointer _px-16 last:_border-none hover:_bg-gray-50",h:"44",w:"full",onClick:c=>s(o)(_.path)},{default:Z(()=>[e("span",Ud,E(_.label),1)]),_:2},1032,["onClick"]))),128))]),_:1},8,["style"])],32)):D("",!0)]),_:1})]))])}}});Mo.__docgenInfo={exportName:"default",displayName:"PostEditorHeaderLivePreviewButton",description:"",tags:{},props:[{name:"pagePaths",required:!0,type:{name:"Array",elements:[{name:"ContentPagePath"}]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorHeaderLivePreviewButton.vue"]};const Od={class:"o-post-editor-header-published-site-button"},zd=["href"],Kd={class:"label-sm-normal _overflow-hidden _text-ellipsis _whitespace-nowrap"},No=ee({__name:"PostEditorHeaderPublishedSiteButton",props:{pageUrls:{type:Array,required:!0},customDomain:{type:String,required:!0},subdomain:{type:String,required:!0}},setup(t){const f=t,{pageUrls:o}=he(f),r=b(!1),u=b({top:0,right:0}),d=T(()=>({top:`${u.value.top}px`,right:`${u.value.right}px`,width:"200px"})),l=v=>{if(o.value.length===1){window.open(o.value[0].url,"_blank");return}const i=v.currentTarget,{bottom:g,right:h}=i.getBoundingClientRect();u.value={top:g,right:window.innerWidth-h},r.value=!0};return(v,i)=>{const g=te("PfIcon"),h=te("PfButton"),p=te("PfColumn");return n(),y("div",Od,[R(h,{size:"sm",variant:"tertiary",disabled:!t.customDomain&&!t.subdomain,onClick:l},{default:Z(()=>[Ye(E(v.$t("CMS:Published Site"))+" ",1),R(g,{icon:"openWindow","icon-color":"gray-500"})]),_:1},8,["disabled"]),(n(),H(Fe,{to:"#teleport-post-editor-overlay"},[R(Ne,null,{default:Z(()=>[r.value?(n(),y("div",{key:0,class:"_fixed _top-0 _left-0 _z-[100] _h-full _w-full",onClick:i[0]||(i[0]=V(C=>r.value=!1,["stop"])),onMouseover:i[1]||(i[1]=V(()=>{},["stop"]))},[R(p,{style:se(d.value),class:"dropdown _absolute _bg-white",rounded:"6",shadow:"12"},{default:Z(()=>[(n(!0),y(le,null,Ce(s(o),C=>(n(),y("a",{key:C.url,href:C.url,class:"border-b-1 _flex _h-44 _w-full _cursor-pointer _items-center _px-16 last:_border-none hover:_bg-gray-50",rel:"noopener noreferrer",target:"_blank"},[e("span",Kd,E(C.label),1)],8,zd))),128))]),_:1},8,["style"])],32)):D("",!0)]),_:1})]))])}}});No.__docgenInfo={exportName:"default",displayName:"PostEditorHeaderPublishedSiteButton",description:"",tags:{},props:[{name:"pageUrls",type:{name:"ContentPageUrl[]"},required:!0},{name:"customDomain",type:{name:"string"},required:!0},{name:"subdomain",type:{name:"string"},required:!0}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorHeaderPublishedSiteButton.vue"]};const Ao=ee({__name:"PostEditorMoreButton",emits:["deleteContent","duplicateContent"],setup(t,{emit:f}){const o=f,r=b(),u=b({top:0,right:0}),d=b(!1),l=()=>{if(!r.value)return;const{bottom:g,right:h}=r.value.getBoundingClientRect();u.value={top:g,right:h},d.value=!0},v=()=>{d.value=!1,o("duplicateContent")},i=()=>{d.value=!1,o("deleteContent")};return(g,h)=>{const p=te("PfIcon");return n(),y("button",{ref_key:"rootRef",ref:r,style:{width:"36px",height:"36px"},class:"o-post-editor-more-button hover:bg-gray _relative _flex _flex-row _items-center _rounded-6 _transition",onClick:l},[R(p,{icon:"moreHoriz",size:"20"}),(n(),H(Fe,{to:"#teleport-post-editor-overlay"},[R(Ne,null,{default:Z(()=>[d.value?(n(),y("div",{key:0,class:"_fixed _top-0 _left-0 _z-1 _h-full _w-full",onClick:h[0]||(h[0]=C=>d.value=!1)},[R(wn,{"dropdown-position":u.value,"is-duplicatable":"",onDeleteItem:i,onDuplicateItem:v},null,8,["dropdown-position"])])):D("",!0)]),_:1})]))],512)}}});Ao.__docgenInfo={exportName:"default",displayName:"PostEditorMoreButton",description:"",tags:{},events:[{name:"deleteContent"},{name:"duplicateContent"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorMoreButton.vue"]};const Bo=ee({name:"PostEditorStatusButton",components:{CmsContentStatusDropdown:$n,DropdownTransition:Ne},props:{contentId:{type:String,required:!0},schemaId:{type:String,required:!0}},setup(t){const{contentId:f,schemaId:o}=he(t),{t:r}=xe(),{publish:u,publishTypeWithSchedule:d,publishedAt:l,unPublish:v}=In(f),i=b(!1),g=b(null),h=b({top:0,left:0}),p=T(()=>Ot.getStatusLightClass(d.value)),C=T(()=>r(Tn(d.value)));return{dropdownPosition:h,isDropdownOpen:i,openDropdown:()=>{const{width:B,height:A}=g.value.getBoundingClientRect();h.value={top:g.value.offsetTop+A,left:g.value.offsetLeft-(Sn-B)},i.value=!0},publishAndCloseDropdown:async()=>{await u(o.value,f.value),i.value=!1},publishStatusClass:p,publishTypeLabel:C,publishTypeWithSchedule:d,publishedAt:l,rootRef:g,unPublishAndCloseDropdown:async()=>{await v({schemaId:o.value,contentId:f.value}),i.value=!1}}}}),jd={class:"label-sm-bold"};function Gd(t,f,o,r,u,d){const l=te("PfIcon"),v=te("CmsContentStatusDropdown"),i=te("DropdownTransition");return n(),y("button",{ref:"rootRef",class:"o-post-editor-status-button hover:bg-gray _flex _flex-row _items-center _gap-8 _rounded-6 _px-12 _py-10 _transition",onClick:f[1]||(f[1]=(...g)=>t.openDropdown&&t.openDropdown(...g))},[e("span",{class:Q(t.publishStatusClass)},null,2),e("span",jd,E(t.publishTypeLabel),1),R(l,{icon:"chevronDown",size:"16"}),(n(),H(Fe,{to:"#teleport-post-editor-overlay"},[R(i,null,{default:Z(()=>[t.isDropdownOpen?(n(),y("div",{key:0,class:"_absolute _top-0 _left-0 _z-dropdown _h-full _w-full",onClick:f[0]||(f[0]=V(g=>t.isDropdownOpen=!1,["stop"]))},[R(v,{"dropdown-position":t.dropdownPosition,"publish-type-with-schedule":t.publishTypeWithSchedule,"published-at":t.publishedAt,onPublish:t.publishAndCloseDropdown,onUnPublish:t.unPublishAndCloseDropdown},null,8,["dropdown-position","publish-type-with-schedule","published-at","onPublish","onUnPublish"])])):D("",!0)]),_:1})]))],512)}const Wd=ie(Bo,[["render",Gd]]);Bo.__docgenInfo={displayName:"PostEditorStatusButton",exportName:"default",description:"",tags:{},props:[{name:"contentId",type:{name:"string"},required:!0},{name:"schemaId",type:{name:"string"},required:!0}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorStatusButton.vue"]};const Vd={class:"label-sm-normal _max-w-[200px] _overflow-hidden _text-ellipsis _text-gray-500"},Jd={class:"label-sm-normal _max-w-[200px] _overflow-hidden _text-ellipsis _text-gray-500"},Qd=e("div",{class:"_flex _flex-1"},null,-1),Xd={class:"label-sm-bold _text-gray-600"},Yd={class:"label-sm-normal"},xo=ee({__name:"PostEditorHeader",props:{isNewContent:{type:Boolean},newableContent:{},schema:{}},emits:["close","deleteContent","duplicateContent"],setup(t){const f=t,{isNewContent:o,newableContent:r,schema:u}=he(f),{projectUrl:d}=En(),{subdomain:l,customDomain:v}=Dt(),{cmsProjectId:i}=at(),{t:g}=xe(),h=xs(),{updateCmsContentPublishedAt:p}=Fn(),C=Ue(),_=b(!1),c=b(),S=b({top:0,left:0}),B=b(""),A=T(()=>{const O=C.getters["studioPage/findCmsDetailPages"],w=u.value.key,x=r.value.slug,G=O(w);return x?G.map(z=>{const re=[String(z.id).replace(/:slug/,x)].filter(L=>L).join("/");return{label:z.name??"",path:re}}):[]}),F=T(()=>it.getCmsPublishTypeWithSchedule(r.value._meta)),P=T(()=>{const O=v.value||l.value+d.value.domain;return A.value.map(w=>{const x=w.path.replace(/\/[^/]*$/,`/${B.value}`);return{label:w.label,url:d.value.protocol+O+"/"+x}})}),a=T(()=>F.value!=="draft"&&F.value!=="scheduled"&&!!m.value),m=T(()=>r.value._meta?.publishedAt?r.value._meta.publishedAt:null),q=T(()=>m.value?Mt.toDefaultFormat(m.value):g("CMSPublishStatus: current time")),$=()=>{if(!c.value)return;const{bottom:O,right:w}=c.value.$el.getBoundingClientRect();S.value={top:O,left:w-Nn},_.value=!0},j=async O=>{if(o.value)return;_.value=!1;const w=r.value;await p(w,i.value,O)||h.push("update-published-at-and-back-to-draft",!0)};return Pe(()=>{Rn(i.value,u.value.id,r.value.id).then(O=>{O&&(B.value=O.default.slug)})}),(O,w)=>{const x=te("PfIcon"),G=te("PfButton"),z=te("PfRow"),re=te("PfDivider");return n(),H(z,{align:"center",class:"border-b-1 _h-48 _bg-white _px-16 _py-6",justify:"start",w:"full"},{default:Z(()=>[R(z,{align:"center",gap:"16"},{default:Z(()=>[R(G,{size:"sm",variant:"tertiary",onClick:w[0]||(w[0]=L=>O.$emit("close"))},{default:Z(()=>[R(x,{icon:"arrowLeft"}),Ye(" "+E(O.$t("CMS:Back")),1)]),_:1}),R(z,{class:"_overflow-hidden _whitespace-nowrap",gap:"4"},{default:Z(()=>[e("span",Vd,E(s(u).name),1),R(x,{icon:"slash","icon-color":"gray-400",size:"16"}),e("span",Jd,E(s(r).title),1)]),_:1})]),_:1}),Qd,s(r)&&!s(o)?(n(),H(z,{key:0,gap:"8",h:"full"},{default:Z(()=>[s(A).length>0?(n(),y(le,{key:0},[R(Mo,{"page-paths":s(A)},null,8,["page-paths"]),s(a)&&s(P).length>0?(n(),H(No,{key:0,"page-urls":s(P),"custom-domain":s(v),subdomain:s(l)},null,8,["page-urls","custom-domain","subdomain"])):D("",!0),R(re,{direction:"row"})],64)):D("",!0),R(z,{ref_key:"publishedAtRef",ref:c,align:"center",class:"_cursor-pointer _px-16 hover:_bg-gray-50",gap:"16",h:"full",rounded:"6",onClick:$},{default:Z(()=>[e("span",Xd,E(O.$t("CMS:publishedAt")),1),e("span",Yd,E(s(q)),1),(n(),H(Fe,{to:"#teleport-post-editor-overlay"},[R(Ne,null,{default:Z(()=>[s(_)?(n(),y("div",{key:0,class:"_fixed _top-0 _left-0 _z-dropdown _h-full _w-full",onClick:w[1]||(w[1]=V(L=>_.value=!1,["stop"])),onMouseover:w[2]||(w[2]=V(()=>{},["stop"]))},[R(Mn,{"clear-button":!1,"date-value":s(m),"dropdown-position":s(S),"is-draft":s(F)==="draft",type:s(F)==="public"||s(F)==="change"?"past-only":"default",onUpdate:j},null,8,["date-value","dropdown-position","is-draft","type"])],32)):D("",!0)]),_:1})]))]),_:1},512),R(Wd,{"content-id":s(r).id,"schema-id":s(u).id},null,8,["content-id","schema-id"]),R(Ao,{onDeleteContent:w[3]||(w[3]=L=>O.$emit("deleteContent")),onDuplicateContent:w[4]||(w[4]=L=>O.$emit("duplicateContent"))})]),_:1})):D("",!0)]),_:1})}}});xo.__docgenInfo={exportName:"default",displayName:"PostEditorHeader",description:"",tags:{},props:[{name:"isNewContent",required:!0,type:{name:"boolean"}},{name:"newableContent",required:!0,type:{name:"NewableCmsContent"}},{name:"schema",required:!0,type:{name:"CmsSchema"}}],events:[{name:"close"},{name:"deleteContent"},{name:"duplicateContent"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorHeader.vue"]};const Do=Symbol("StopPostEditorScrolling"),Ho=Symbol("CmsPostEditorCursorMode"),qo=Symbol("CmsPostEditorCursorPosition"),Zd=["slug"],eu=t=>{const{cmsProjectId:f}=at(),{cmsDashboardSetting:o}=_t(An()),{cmsSchema:r}=yt({schemaId:t}),u=b([]),d=b([]),l=b([]),v=T(()=>u.value.map(p=>p.key)),i=async(p,C)=>{const _=u.value[p],c=u.value.slice();return c.splice(p,1),c.splice(C,0,_),l.value=[...d.value,...c],await St.updateDetailPageFieldOrders({cmsProjectId:f.value,schemaId:t.value,cmsSchemaFieldsForDetail:l.value}),c},g=async p=>{const{fieldKey:C,newName:_}=p,c=l.value.findIndex(S=>S.key===C);l.value[c]={...l.value[c],name:_},await St.update({...r.value,fields:l.value},t.value,{projectId:f.value})},h=p=>!p._system||Zd.includes(p.key);return X(l,p=>{const C=p.filter(c=>h(c));JSON.stringify(u.value)!==JSON.stringify(C)&&(u.value=C);const _=p.filter(c=>!h(c));JSON.stringify(d.value)!==JSON.stringify(_)&&(d.value=_)},{immediate:!0}),X([r,o],([p,C])=>{if(!p)return;const{fields:_}=p,c=C[t.value];let S;!c||c.detail.length===0?S=ut.initCmsDashboardFieldSetting(_).detail:S=ut.adjustToOriginalFields(_,c).detail,l.value=ut.buildCmsDashboardDetailFields(_,S)},{immediate:!0}),{fieldKeyList:v,localCmsSchemaFieldsForDetail:l,sortableFields:u,updateDetailPageFieldOrders:i,updateFieldName:g}},tu=t=>{lt(Do,t)},ou=()=>st(Do),nu=t=>{lt(Ho,t)},Ke=()=>st(Ho),su=t=>{lt(qo,t)},je=()=>st(qo),lu={class:"_pointer-events-none"},Lo=ee({__name:"PostEditorRightItemBooleanField",props:{content:{},field:{},schemaId:{},value:{type:Boolean,default:!1}},emits:["editCell"],setup(t){const f=t,o=Ke(),r=je(),u=T(()=>{if(!r.value)return!1;const{contentId:l,fieldKey:v}=r.value;return l===f.content.id&&v===f.field.key}),d=T(()=>u.value&&o?o.value:null);return(l,v)=>{const i=te("PfToggleSwitch"),g=te("PfRow");return n(),H(g,{align:"center",class:"o-post-editor-right-item-boolean-field hover:bg-gray _relative _p-16 _transition",flex:"1",justify:"between",onClick:v[0]||(v[0]=V(h=>l.$emit("editCell"),["stop"]))},{default:Z(()=>[e("div",lu,[R(i,{"model-value":l.value},null,8,["model-value"])]),d.value==="selecting"?(n(),H(Oe,{key:0})):D("",!0),R(ze,{"content-id":l.content.id,"field-key":l.field.key,"schema-id":l.schemaId},null,8,["content-id","field-key","schema-id"])]),_:1})}}});Lo.__docgenInfo={exportName:"default",displayName:"PostEditorRightItemBooleanField",description:"",tags:{},props:[{name:"content",required:!0,type:{name:"NewableCmsContent"}},{name:"field",required:!0,type:{name:"CmsSchemaFieldForDetail"}},{name:"schemaId",required:!0,type:{name:"string"}},{name:"value",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],events:[{name:"editCell"}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorRightItemBooleanField.vue"]};const au={class:"color-square _overflow-hidden _rounded-4"},iu={class:"label-md-normal _whitespace-nowrap"},ru={key:0,class:"label-md-normal _whitespace-nowrap"},du={key:0,class:"_fixed _top-0 _left-0 _z-1 _h-full _w-full"},Uo=ee({__name:"PostEditorRightItemColorField",props:{content:{},field:{},schemaId:{},value:{default:Tt}},emits:["editCell","selectCell","submitContent"],setup(t,{emit:f}){const o=t,r=f,u=Ke(),d=je(),l=b(),v=b({top:0,left:0}),i=T(()=>{if(!d||!d.value)return!1;const{contentId:_,fieldKey:c}=d.value;return _===o.content.id&&c===o.field.key}),g=T(()=>i.value&&u?u.value:null),h=T(()=>o.value===Tt),p=T(()=>Dn(o.value)),C=_=>{_!==o.value&&r("submitContent",_),r("selectCell")};return X(g,_=>{if(l.value&&_==="editing"){const{left:c,bottom:S}=l.value.$el.getBoundingClientRect();v.value={top:S,left:c}}}),(_,c)=>{const S=te("PfRow");return n(),H(S,{ref_key:"rootRef",ref:l,align:"center",class:"o-post-editor-right-item-color-field _relative _overflow-hidden _p-12 _transition hover:_bg-gray-100",flex:"1",onClick:c[0]||(c[0]=V(B=>_.$emit("editCell"),["stop"]))},{default:Z(()=>[s(h)?D("",!0):(n(),H(S,{key:0,align:"center",gap:"8"},{default:Z(()=>[e("div",au,[e("span",{style:se({backgroundColor:_.value}),class:"_block _h-full _w-full _rounded-4"},null,4)]),e("span",iu,E(s(Bn)(_.value)),1),s(p)?(n(),y("span",ru,E(s(p)),1)):D("",!0)]),_:1})),s(g)==="selecting"?(n(),H(Oe,{key:1})):D("",!0),R(ze,{"content-id":_.content.id,"field-key":_.field.key,"schema-id":_.schemaId},null,8,["content-id","field-key","schema-id"]),(n(),H(Fe,{to:"#teleport-post-editor-overlay"},[R(Ne,null,{default:Z(()=>[s(g)==="editing"?(n(),y("div",du,[R(xn,{"dropdown-position":s(v),value:_.value,onUpdate:C},null,8,["dropdown-position","value"])])):D("",!0)]),_:1})]))]),_:1},512)}}});const uu=ie(Uo,[["__scopeId","data-v-8b2856ff"]]);Uo.__docgenInfo={exportName:"default",displayName:"PostEditorRightItemColorField",description:"",tags:{},props:[{name:"content",required:!0,type:{name:"NewableCmsContent"}},{name:"field",required:!0,type:{name:"CmsSchemaFieldForDetail"}},{name:"schemaId",required:!0,type:{name:"string"}},{name:"value",required:!1,type:{name:"ColorInput"},defaultValue:{func:!1,value:"CMS_COLOR_FIELD_DEFAULT_VALUE"}}],events:[{name:"editCell"},{name:"selectCell"},{name:"submitContent",type:{names:["union"],elements:[{name:"ColorInput"},{name:"null"}]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorRightItemColorField.vue"]};const Ct=t=>($e("data-v-8f284e99"),t=t(),Ie(),t),cu={class:"thumbnail-image-wrap _relative _bg-gray-50"},mu=["src","width"],pu=Ct(()=>e("span",null,null,-1)),fu=Ct(()=>e("div",{class:"thumbnail-image-mask _absolute _h-full _w-full _rounded-4"},null,-1)),vu={key:0,class:"uploading _absolute _h-full _w-full _rounded-2 _bg-alpha-40"},_u=Ct(()=>e("div",{class:"bar _absolute"},null,-1)),gu=[_u],Oo=ee({__name:"PostEditorRightItemImageField",props:{content:{},field:{},schemaId:{},value:{default:""}},emits:["editCell","selectCell","submitContent"],setup(t,{emit:f}){const o=t,r=f,u=Ke(),d=je(),{t:l}=xe(),{isUploadingImage:v,uploadImage:i}=Hn(),{showConfirmDialog:g}=Ht(),h=b(),p=b(!1),C=b(!1),_=T(()=>{if(!d||!d.value)return!1;const{contentId:P,fieldKey:a}=d.value;return P===o.content.id&&a===o.field.key}),c=T(()=>_.value&&u?u.value:null),S=async()=>{await g({text:l("CMS:deleteImageConfirm"),label:l("delete"),variant:"destructive"})&&B("")},B=P=>{P!==o.value&&r("submitContent",P),r("selectCell")},A=async P=>{if(P.length===0)return;const a=P[0],m=await i(a);m&&B(m[0])},F=P=>{if(p.value=!1,P.dataTransfer){const a=P.dataTransfer.files[0];/^image\//.test(a.type)?A([a]):alert(l("CMS:Invalid image file type"))}};return X(c,P=>{P==="editing"&&h.value.click()}),(P,a)=>{const m=te("PfRow"),q=te("PfIcon"),$=te("PfChipDeleteButton");return n(),H(m,{align:"center",class:"o-post-editor-right-item-image-field _relative _p-16 _transition hover:_bg-gray-100",flex:"1",justify:"between",onClick:a[2]||(a[2]=V(j=>P.$emit("editCell"),["stop"])),onDragover:a[3]||(a[3]=V(j=>p.value=!0,["prevent"])),onDragleave:a[4]||(a[4]=V(j=>p.value=!1,["prevent"])),onDrop:V(F,["prevent"])},{default:Z(()=>[e("div",cu,[P.value?(n(),y("img",{key:0,src:P.value,width:s(C)?240:120,alt:"field-image",class:"thumbnail-image _rounded-2 _align-bottom"},null,8,mu)):(n(),H(m,{key:1,class:Q([[s(C)&&"isExpanded"],"default-logo _bg-gray-200"]),align:"center",justify:"center"},{default:Z(()=>[pu]),_:1},8,["class"])),fu,s(v)?D("",!0):(n(),y(le,{key:2},[R(m,{class:Q([[s(p)&&"_opacity-100"],"upload-icon-wrap _absolute _bg-alpha-40 _opacity-0"]),align:"center",h:"full",justify:"center",rounded:"2",w:"full"},{default:Z(()=>[R(q,{icon:"upload","icon-color":"const-white",size:"24"})]),_:1},8,["class"]),e("input",{ref_key:"fileInputRef",ref:h,accept:"image/*",class:"_hidden",type:"file",onChange:a[0]||(a[0]=V(j=>A(j.target.files),["prevent"]))},null,544)],64)),R(ft,null,{default:Z(()=>[s(v)?(n(),y("div",vu,gu)):D("",!0)]),_:1}),P.value?(n(),H($,{key:3,class:"delete-btn",size:"sm",onClick:V(S,["stop"]),onMouseover:a[1]||(a[1]=V(()=>{},["stop"]))})):D("",!0)]),s(c)==="selecting"?(n(),H(Oe,{key:0})):D("",!0),R(ze,{"content-id":P.content.id,"field-key":P.field.key,"schema-id":P.schemaId},null,8,["content-id","field-key","schema-id"])]),_:1})}}});const hu=ie(Oo,[["__scopeId","data-v-8f284e99"]]);Oo.__docgenInfo={exportName:"default",displayName:"PostEditorRightItemImageField",description:"",tags:{},props:[{name:"content",required:!0,type:{name:"NewableCmsContent"}},{name:"field",required:!0,type:{name:"CmsSchemaFieldForDetail"}},{name:"schemaId",required:!0,type:{name:"string"}},{name:"value",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"''"}}],events:[{name:"editCell"},{name:"selectCell"},{name:"submitContent",type:{names:["string"]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorRightItemImageField.vue"]};const yu={class:"label-md-normal _h-full _w-full _break-words"},bu={key:0,class:"_fixed _top-0 _left-0 _z-1 _h-full _w-full"},zo=ee({__name:"PostEditorRightItemNumberField",props:{content:{},field:{},schemaId:{},value:{default:void 0}},emits:["editCell","selectCell","submitContent"],setup(t,{emit:f}){const o=t,r=f,u=Ke(),d=je(),l=b(),v=b({top:0,left:0,width:0,height:0}),i=T(()=>{if(!d||!d.value)return!1;const{contentId:p,fieldKey:C}=d.value;return p===o.content.id&&C===o.field.key}),g=T(()=>i.value&&u?u.value:null),h=p=>{p!==o.value&&r("submitContent",p),r("selectCell")};return X(g,p=>{if(l.value&&p==="editing"){const C=l.value.$el,{top:_,left:c,width:S,height:B}=C.getBoundingClientRect();v.value={top:_,left:c,width:S,height:B}}}),(p,C)=>{const _=te("PfRow");return n(),H(_,{ref_key:"rootRef",ref:l,align:"center",class:"o-post-editor-right-item-number-field hover:bg-gray _relative _p-16 _transition",flex:"1",justify:"between",onClick:C[1]||(C[1]=V(c=>p.$emit("editCell"),["stop"]))},{default:Z(()=>[e("p",yu,E(p.value),1),g.value==="selecting"?(n(),H(Oe,{key:0})):D("",!0),R(ze,{"content-id":p.content.id,"field-key":p.field.key,"schema-id":p.schemaId},null,8,["content-id","field-key","schema-id"]),(n(),H(Fe,{to:"#teleport-post-editor-overlay"},[g.value==="editing"?(n(),y("div",bu,[R(qn,{"dropdown-display-setting":v.value,"newable-content":p.content,value:p.value,onUpdate:h,onSelectCell:C[0]||(C[0]=c=>p.$emit("selectCell"))},null,8,["dropdown-display-setting","newable-content","value"])])):D("",!0)]))]),_:1},512)}}});zo.__docgenInfo={exportName:"default",displayName:"PostEditorRightItemNumberField",description:"",tags:{},props:[{name:"content",required:!0,type:{name:"NewableCmsContent"}},{name:"field",required:!0,type:{name:"CmsSchemaFieldForDetail"}},{name:"schemaId",required:!0,type:{name:"string"}},{name:"value",required:!1,type:{name:"number"},defaultValue:{func:!1,value:"undefined"}}],events:[{name:"editCell"},{name:"selectCell"},{name:"submitContent",type:{names:["union"],elements:[{name:"number"},{name:"null"}]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorRightItemNumberField.vue"]};const Ko=ee({name:"EditReferenceFieldDefaultTag",props:{content:{type:Object,required:!0},icon:{type:String,required:!0}},setup(t,f){const{content:o}=he(t),r=T(()=>{const d=it.getCmsPublishTypeWithSchedule(o.value._meta);return Ot.getStatusLightClass(d)});return{CMS_REFERENCE_FIELD_DEFAULT_TAG_HEIGHT:qt,onClickDelete:()=>{f.emit("unlinkReference",o.value)},statusLightClassFromCmsPublishState:r}}});const Cu={style:{fontSize:"14px"},class:"material-icons-outlined _text-gray-800"},ku={class:"label-xs2-bold _overflow-hidden _text-ellipsis _text-gray-800"};function Pu(t,f,o,r,u,d){const l=te("PfRow"),v=te("PfChipDeleteButton");return n(),H(l,{style:se({height:`${t.CMS_REFERENCE_FIELD_DEFAULT_TAG_HEIGHT}px`}),title:t.content.title,align:"center",class:"o-edit-reference-field-default-tag border-1 _relative _select-none _bg-white _px-8 _transition hover:_bg-gray-100",gap:"6",rounded:"4",onMouseover:f[0]||(f[0]=V(()=>{},["stop"]))},{default:Z(()=>[e("span",{class:Q(t.statusLightClassFromCmsPublishState)},null,2),R(l,{align:"center",class:"_overflow-hidden _whitespace-nowrap",gap:"4",w:"full"},{default:Z(()=>[e("i",Cu,E(t.icon),1),e("p",ku,E(t.content.title),1)]),_:1}),R(v,{class:"close-btn _hidden",size:"sm",onClick:V(t.onClickDelete,["stop"])},null,8,["onClick"])]),_:1},8,["style","title"])}const wu=ie(Ko,[["render",Pu],["__scopeId","data-v-937fb17d"]]);Ko.__docgenInfo={displayName:"EditReferenceFieldDefaultTag",exportName:"default",description:"",tags:{},props:[{name:"content",type:{name:"CmsContent"},required:!0},{name:"icon",type:{name:"string"},required:!0}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/EditReferenceFieldDefaultTag.vue"]};const jo=ee({__name:"PostEditorRightItemReferenceField",props:{content:{},field:{},schemaId:{},value:{default:void 0}},emits:["createAndLinkReference","editCell","jumpTo","selectCell","submitContent"],setup(t,{emit:f}){const o=t,r=f,u=Ke(),d=je(),l=T(()=>o.field.reference.schemaId),v=b(null),{bottom:i,left:g,update:h}=Lt(v),p=Ue(),{contents:C}=Ut(l),{cmsSchema:_}=yt({schemaId:l}),c=b(!1),S=T(()=>({top:i.value,left:g.value})),B=T(()=>{if(!d||!d.value)return!1;const{contentId:w,fieldKey:x}=d.value;return w===o.content.id&&x===o.field.key}),A=T(()=>B.value&&u?u.value:null),F=T(()=>o.field.reference.isMultiple),P=T(()=>o.field.reference.postType),a=T(()=>_.value?_.value.icon:""),m=T(()=>o.value?Array.isArray(o.value)?o.value:[o.value]:[]),q=(w,x)=>{const G=p.getters["CmsStore/findSchemaById"](w);r("jumpTo",On.buildContentRoute(G,x))},$=w=>{r("submitContent",w)},j=w=>{F.value?$(m.value.filter(x=>x.id!==w.id)):$(null)},O=async w=>{r("createAndLinkReference",{newContentSchemaId:l.value,title:w,linkToField:o.field})};return X(A,w=>{v.value&&w==="editing"&&h()}),(w,x)=>{const G=te("PfRow");return n(),H(G,{ref_key:"rootRef",ref:v,class:Q([[s(c)&&"isHovered"],"o-post-editor-right-item-reference-field _relative _select-none _p-12"]),align:"center",flex:"1",onClick:x[3]||(x[3]=V(z=>w.$emit("editCell"),["stop"])),onMouseover:x[4]||(x[4]=V(z=>c.value=!0,["stop"])),onMouseout:x[5]||(x[5]=V(z=>c.value=!1,["stop"]))},{default:Z(()=>[s(P)==="user"?(n(),H(G,{key:0,style:se({minHeight:`${s(Ln)}px`}),align:"center",class:"_flex-wrap",gap:"8"},{default:Z(()=>[(n(!0),y(le,null,Ce(s(m),z=>(n(),H(Un,{key:z.id,content:z,"schema-id":s(l),onUnlinkReference:j,onClick:V(re=>q(s(l),z.id),["stop"])},null,8,["content","schema-id","onClick"]))),128))]),_:1},8,["style"])):(n(),H(G,{key:1,style:se({minHeight:`${s(qt)}px`}),align:"center",class:"_flex-wrap _content-center",gap:"8",h:"full",w:"full"},{default:Z(()=>[(n(!0),y(le,null,Ce(s(m),z=>(n(),H(wu,{key:z.id,content:z,icon:s(a),"schema-id":s(l),onUnlinkReference:j,onClick:V(re=>q(s(l),z.id),["stop"])},null,8,["content","icon","schema-id","onClick"]))),128))]),_:1},8,["style"])),s(A)==="selecting"?(n(),H(Oe,{key:2})):D("",!0),R(ze,{"content-id":w.content.id,"field-key":w.field.key,"schema-id":w.schemaId},null,8,["content-id","field-key","schema-id"]),(n(),H(Fe,{to:"#teleport-post-editor-overlay"},[R(Ne,null,{default:Z(()=>[s(A)==="editing"?(n(),y("div",{key:0,class:"_fixed _top-0 _left-0 _z-1 _h-full _w-full",onClick:x[2]||(x[2]=V(z=>w.$emit("selectCell"),["stop"]))},[s(F)?(n(),H(Et,{key:0,contents:s(C),"dropdown-position":s(S),"post-type":s(P),"selected-contents":s(m),onClear:$,onClose:x[0]||(x[0]=z=>w.$emit("selectCell")),onSelect:$,onCreateAndLinkItem:O,onUpdateSelectedOrder:$},null,8,["contents","dropdown-position","post-type","selected-contents"])):(n(),H(Et,{key:1,contents:s(C),"dropdown-position":s(S),"post-type":s(P),"selected-content":s(m)[0],onClear:$,onClose:x[1]||(x[1]=z=>w.$emit("selectCell")),onSelect:$,onCreateAndLinkItem:O,onUpdateSelectedOrder:$},null,8,["contents","dropdown-position","post-type","selected-content"]))])):D("",!0)]),_:1})]))]),_:1},8,["class"])}}});jo.__docgenInfo={exportName:"default",displayName:"PostEditorRightItemReferenceField",description:"",tags:{},props:[{name:"content",required:!0,type:{name:"NewableCmsContent"}},{name:"field",required:!0,type:{name:"CmsSchemaReferenceField"}},{name:"schemaId",required:!0,type:{name:"string"}},{name:"value",required:!1,type:{name:"union",elements:[{name:"CmsContent"},{name:"Array",elements:[{name:"CmsContent"}]}]},defaultValue:{func:!1,value:"undefined"}}],events:[{name:"editCell"},{name:"selectCell"},{name:"createAndLinkReference",type:{names:["CreateAndLinkReferencePayload"]}},{name:"jumpTo",type:{names:["RouteLocationRaw"]}},{name:"submitContent",type:{names:["union"],elements:[{name:"CmsContent"},{name:"Array",elements:[{name:"CmsContent"}]},{name:"null"}]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorRightItemReferenceField.vue"]};const $u=["onKeydown"],Iu={key:1,class:"label-sm-normal _flex _w-full _items-center _overflow-hidden _text-ellipsis _break-words _text-gray-600",contenteditable:"false"},Go=ee({__name:"PostEditorRightItemSlugField",props:{content:{},field:{},schemaId:{},value:{default:""}},emits:["editCell","moveSelectionTo","selectCell","submitContent"],setup(t,{emit:f}){const o=t,r=f,u=en(o,"schemaId"),d=Ke(),l=je(),v=ou(),{t:i}=xe(),{contents:g}=Ut(u),{cmsSlugValidation:h}=yt({schemaId:u}),p=b(o.value),C=b(),_=b(),c=b(""),S=T(()=>{if(!l||!l.value)return!1;const{contentId:w,fieldKey:x}=l.value;return w===o.content.id&&x===o.field.key}),B=T(()=>S.value&&d?d.value:null),A=T(()=>B.value==="editing"),F=()=>{_.value&&(_.value.innerText=p.value)},P=w=>{if(window.getSelection().removeAllRanges(),c.value){zn({type:"error",text:c.value,duration:3e3}),F();return}const z=w.target.innerText.replace(/&nbsp;/g," ").replace(/\r?\n/g," ").replace(/<br>/g," ");z!==p.value&&(p.value=z,r("submitContent",z)),r("selectCell"),C.value&&(r("moveSelectionTo",C.value),C.value=void 0)},a=w=>{w.isComposing||(F(),_.value?.blur())},m=w=>{w.isComposing||(C.value="down",_.value?.blur())},q=()=>{const w=_.value,x=document.createRange();x.selectNodeContents(w);const G=window.getSelection();G.removeAllRanges(),G.addRange(x)},$=()=>{it.isPublishTypeSchedule(o.content._meta)&&(O(),_.value?.blur())},j=w=>{const x=w.clipboardData.getData("text/plain"),G=xt(x),z=Kn(G);document.execCommand("insertHTML",!1,z)},O=()=>{if(!_.value)return;const w=_.value.innerText;if(w===""){c.value=i("CMS:SlugValidate");return}if(!h.test(w)){c.value=i("CMS:SlugValidateRestrictedStrings");return}if(g.value.some(G=>G.slug===w&&G.slug!==p.value)){c.value=i("CMS:SlugValidateDuplicated");return}c.value=""};return X(()=>o.value,w=>p.value=w),X(B,async(w,x)=>{w==="editing"?(await Rt(),_.value?.focus(),v.value=!0):(x==="editing"&&_.value?.blur(),v.value=!1)}),(w,x)=>{const G=te("PfRow");return n(),H(G,{ref:"rootRef",class:Q([[s(A)?"_z-1 _bg-white _shadow-8":"hover:_bg-gray-100"],"o-post-editor-right-item-slug-field _relative _w-full _overflow-hidden _p-12 _transition"]),title:s(p),align:"stretch",flex:"1",gap:"4",onClick:x[3]||(x[3]=V(z=>w.$emit("editCell"),["stop"]))},{default:Z(()=>[e("span",{class:Q([[!s(A)&&"_flex _items-center"],"label-sm-normal _text-gray-600"])},"/",2),s(A)?(n(),y("p",{key:0,ref_key:"pRef",ref:_,style:{minWidth:"1px"},class:"label-sm-normal _w-full _break-words _text-gray-600",contenteditable:"true",onBlur:P,onFocus:q,onClick:x[0]||(x[0]=V(()=>{},["stop"])),onInput:V($,["stop"]),onKeydown:[Ee(V(m,["stop"]),["enter"]),Ee(V(a,["stop"]),["esc"])],onKeyup:[x[1]||(x[1]=Ee(V(z=>z.target.blur(),["stop"]),["esc"])),V(O,["stop"])],onMousedown:x[2]||(x[2]=V(()=>{},["stop"])),onPaste:V(j,["prevent"])},E(s(p)),41,$u)):(n(),y("p",Iu,E(s(p)),1)),s(B)==="selecting"?(n(),H(Oe,{key:2})):D("",!0),R(ze,{"content-id":w.content.id,"field-key":w.field.key,"schema-id":s(u)},null,8,["content-id","field-key","schema-id"])]),_:1},8,["class","title"])}}});Go.__docgenInfo={exportName:"default",displayName:"PostEditorRightItemSlugField",description:"",tags:{},props:[{name:"content",required:!0,type:{name:"NewableCmsContent"}},{name:"field",required:!0,type:{name:"CmsSchemaFieldForDetail"}},{name:"schemaId",required:!0,type:{name:"string"}},{name:"value",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"''"}}],events:[{name:"editCell"},{name:"moveSelectionTo",type:{names:["CmsContentCursorMoveDirection"]}},{name:"selectCell"},{name:"submitContent",type:{names:["string"]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorRightItemSlugField.vue"]};const Su={class:"label-md-normal _h-full _w-full _whitespace-pre-wrap _break-words"},Tu={key:0,class:"_fixed _top-0 _left-0 _z-1 _h-full _w-full"},Wo=ee({__name:"PostEditorRightItemTextField",props:{content:{},field:{},schemaId:{},value:{default:""}},emits:["editCell","moveSelectionTo","selectCell","submitContent"],setup(t,{emit:f}){const o=t,r=f,u=Ke(),d=je(),l=b(),v=b({top:0,left:0,width:0,height:0}),i=T(()=>o.field.allowNewline??!1),g=T(()=>i.value?Gn(o.value):o.value),h=T(()=>{if(!d||!d.value)return!1;const{contentId:_,fieldKey:c}=d.value;return _===o.content.id&&c===o.field.key}),p=T(()=>h.value&&u?u.value:null),C=_=>{_!==o.value&&r("submitContent",Wn(_)),r("selectCell")};return X(p,_=>{if(l.value&&_==="editing"){const c=l.value.$el,{top:S,left:B,width:A,height:F}=c.getBoundingClientRect();v.value={top:S,left:B,width:A,height:F}}}),(_,c)=>{const S=te("PfRow");return n(),H(S,{ref_key:"rootRef",ref:l,align:"center",class:"o-post-editor-right-item-text-field _relative _overflow-hidden _p-12 _transition hover:_bg-gray-100",flex:"1",onClick:c[2]||(c[2]=V(B=>_.$emit("editCell"),["stop"]))},{default:Z(()=>[e("p",Su,E(s(g)),1),s(p)==="selecting"?(n(),H(Oe,{key:0})):D("",!0),R(ze,{"content-id":_.content.id,"field-key":_.field.key,"schema-id":_.schemaId},null,8,["content-id","field-key","schema-id"]),(n(),H(Fe,{to:"#teleport-post-editor-overlay"},[s(p)==="editing"?(n(),y("div",Tu,[R(jn,{"allow-newline":s(i),"dropdown-display-setting":s(v),"newable-content":_.content,value:s(g),onMoveSelectionTo:c[0]||(c[0]=B=>_.$emit("moveSelectionTo","down")),onSelectCell:c[1]||(c[1]=B=>_.$emit("selectCell")),onUpdateTextFieldValue:C},null,8,["allow-newline","dropdown-display-setting","newable-content","value"])])):D("",!0)]))]),_:1},512)}}});Wo.__docgenInfo={exportName:"default",displayName:"PostEditorRightItemTextField",description:"",tags:{},props:[{name:"content",required:!0,type:{name:"NewableCmsContent"}},{name:"field",required:!0,type:{name:"CmsSchemaTextFieldForDetail"}},{name:"schemaId",required:!0,type:{name:"string"}},{name:"value",required:!1,type:{name:"string"},defaultValue:{func:!1,value:"''"}}],events:[{name:"editCell"},{name:"moveSelectionTo",type:{names:["CmsContentCursorMoveDirection"]}},{name:"selectCell"},{name:"submitContent",type:{names:["string"]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorRightItemTextField.vue"]};const Eu=e("i",{style:{fontSize:"16px"},class:"material-icons _pointer-events-none _text-gray-300"},"drag_indicator",-1),Fu=[Eu],Ru={class:"label-sm-bold _overflow-hidden _text-ellipsis _text-gray-600"},Mu=e("div",{style:{width:"20px",top:0,right:"100%"},class:"_absolute _h-full"},null,-1),Nu=88,Vo=ee({__name:"PostEditorRightItem",props:{content:{},field:{},isDragging:{type:Boolean,default:!1},schemaId:{}},emits:["createAndLinkReference","deleteField","editCell","jumpTo","moveSelectionTo","selectCell","submitContent","updateFieldName"],setup(t,{emit:f}){const o=t,r=f,u=b(null),{bottom:d,right:l,update:v}=Lt(u),{t:i}=xe(),{showConfirmDialog:g}=Ht(),h=b(!1),p=b(!1),C=T(()=>({top:d.value,left:l.value})),_=async()=>{await g({text:i("CMS: Delete confirm",{name:o.field.name||""}),label:i("delete"),variant:"destructive"})&&r("deleteField",o.field.key)},c=a=>r("createAndLinkReference",a),S=a=>r("editCell",a),B=a=>r("jumpTo",a),A=a=>r("moveSelectionTo",a),F=a=>r("selectCell",a),P=a=>r("submitContent",a);return X(p,a=>{u.value&&a&&v()}),(a,m)=>{const q=te("PfRow");return n(),H(q,{class:Q([[a.isDragging&&"isDragging _shadow-8"],"o-post-editor-right-item _relative _bg-gray-50"]),"data-post-editor-field-key":a.field.key,align:"stretch",w:"full",onMouseleave:m[22]||(m[22]=$=>h.value=!1),onMouseover:m[23]||(m[23]=$=>h.value=!0)},{default:Z(()=>[me(R(q,{align:"center",class:"drag-indicator-wrap _absolute _top-0 _h-full"},{default:Z(()=>[e("div",{ref_key:"dragIndicatorRef",ref:u,class:"knob _z-1 _cursor-grab",onClick:m[0]||(m[0]=$=>p.value=!a.isDragging)},Fu,512),(n(),H(Fe,{to:"#teleport-post-editor-overlay"},[R(Ne,null,{default:Z(()=>[s(p)?(n(),y("div",{key:0,class:"_fixed _top-0 _left-0 _z-2 _h-full _w-full",onClick:m[2]||(m[2]=V($=>p.value=!1,["stop"]))},[R(Vn,{"dropdown-position":s(C),field:a.field,"schema-id":a.schemaId,onDeleteField:_,onUpdateFieldName:m[1]||(m[1]=$=>a.$emit("updateFieldName",{fieldKey:a.field.key,newName:$}))},null,8,["dropdown-position","field","schema-id"])])):D("",!0)]),_:1})]))]),_:1},512),[[qe,s(h)||a.isDragging||s(p)]]),R(q,{style:se({width:`${Nu}px`}),align:"center",class:"field-name-wrap _relative _px-8 _py-12"},{default:Z(()=>[e("span",Ru,E(a.field.name),1),R(Jn,{content:a.content,"property-name":a.field.key,class:"_absolute _top-0 _right-0"},null,8,["content","property-name"])]),_:1},8,["style"]),s(He).isBooleanField(a.field)?(n(),H(Lo,{key:0,content:a.content,field:a.field,"schema-id":a.schemaId,value:a.content[a.field.key],onEditCell:m[3]||(m[3]=$=>S({contentId:a.content.id,fieldKey:a.field.key}))},null,8,["content","field","schema-id","value"])):s(He).isColorField(a.field)?(n(),H(uu,{key:1,content:a.content,field:a.field,"schema-id":a.schemaId,value:a.content[a.field.key],onEditCell:m[4]||(m[4]=$=>S({contentId:a.content.id,fieldKey:a.field.key})),onSelectCell:m[5]||(m[5]=$=>F({contentId:a.content.id,fieldKey:a.field.key})),onSubmitContent:m[6]||(m[6]=$=>P({[a.field.key]:$}))},null,8,["content","field","schema-id","value"])):s(He).isImageField(a.field)?(n(),H(hu,{key:2,content:a.content,field:a.field,"schema-id":a.schemaId,value:a.content[a.field.key],onEditCell:m[7]||(m[7]=$=>S({contentId:a.content.id,fieldKey:a.field.key})),onSelectCell:m[8]||(m[8]=$=>F({contentId:a.content.id,fieldKey:a.field.key})),onSubmitContent:m[9]||(m[9]=$=>P({[a.field.key]:$}))},null,8,["content","field","schema-id","value"])):s(He).isNumberField(a.field)?(n(),H(zo,{key:3,content:a.content,field:a.field,"schema-id":a.schemaId,value:a.content[a.field.key],onEditCell:m[10]||(m[10]=$=>S({contentId:a.content.id,fieldKey:a.field.key})),onSelectCell:m[11]||(m[11]=$=>F({contentId:a.content.id,fieldKey:a.field.key})),onSubmitContent:m[12]||(m[12]=$=>P({[a.field.key]:$}))},null,8,["content","field","schema-id","value"])):s(He).isReferenceField(a.field)?(n(),H(jo,{key:4,content:a.content,field:a.field,"schema-id":a.schemaId,value:a.content[a.field.key],onCreateAndLinkReference:c,onEditCell:m[13]||(m[13]=$=>S({contentId:a.content.id,fieldKey:a.field.key})),onJumpTo:B,onSelectCell:m[14]||(m[14]=$=>F({contentId:a.content.id,fieldKey:a.field.key})),onSubmitContent:m[15]||(m[15]=$=>P({[a.field.key]:$}))},null,8,["content","field","schema-id","value"])):s(He).isSlugField(a.field)?(n(),H(Go,{key:5,content:a.content,field:a.field,"schema-id":a.schemaId,value:a.content[a.field.key],onEditCell:m[16]||(m[16]=$=>S({contentId:a.content.id,fieldKey:a.field.key})),onMoveSelectionTo:A,onSelectCell:m[17]||(m[17]=$=>F({contentId:a.content.id,fieldKey:a.field.key})),onSubmitContent:m[18]||(m[18]=$=>P({[a.field.key]:$}))},null,8,["content","field","schema-id","value"])):s(He).isTextField(a.field)?(n(),H(Wo,{key:6,content:a.content,field:a.field,"schema-id":a.schemaId,value:a.content[a.field.key],onEditCell:m[19]||(m[19]=$=>S({contentId:a.content.id,fieldKey:a.field.key})),onMoveSelectionTo:A,onSelectCell:m[20]||(m[20]=$=>F({contentId:a.content.id,fieldKey:a.field.key})),onSubmitContent:m[21]||(m[21]=$=>P({[a.field.key]:$}))},null,8,["content","field","schema-id","value"])):D("",!0),Mu]),_:1},8,["class","data-post-editor-field-key"])}}});Vo.__docgenInfo={exportName:"default",displayName:"PostEditorRightItem",description:"",tags:{},props:[{name:"content",required:!0,type:{name:"NewableCmsContent"}},{name:"field",required:!0,type:{name:"CmsSchemaFieldForDetail"}},{name:"isDragging",required:!1,type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"schemaId",required:!0,type:{name:"string"}}],events:[{name:"updateFieldName",type:{names:["{ fieldKey: string; newName: string }"]}},{name:"createAndLinkReference",type:{names:["CreateAndLinkReferencePayload"]}},{name:"deleteField",type:{names:["string"]}},{name:"editCell",type:{names:["CmsContentCursorPosition"]}},{name:"jumpTo",type:{names:["RouteLocationRaw"]}},{name:"moveSelectionTo",type:{names:["CmsContentCursorMoveDirection"]}},{name:"selectCell",type:{names:["CmsContentCursorPosition"]}},{name:"submitContent",type:{names:["Partial"],elements:[{name:"CmsContent"}]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorRightItem.vue"]};const Au=t=>($e("data-v-1fbe477c"),t=t(),Ie(),t),Bu={class:"label-md-bold"},xu=Au(()=>e("div",{style:{height:"1px"},class:"top-line _w-full"},null,-1)),Du={class:"label-md-normal _text-gray-600"},Jo=ee({__name:"PostEditorRight",props:{content:{},isDraft:{type:Boolean},schema:{},sortableFields:{},userFields:{}},emits:["addField","deleteField","deselectCell","editCell","jumpTo","move","moveSelectionTo","onChangeField","selectCell","updateFieldName"],setup(t,{emit:f}){const o=t,r=f,{content:u,schema:d}=he(o),l=T(()=>d.value.id),{isDebugMode:v}=Qn(),{cmsProjectId:i}=at(),{createCmsContentAndLinkReference:g}=Xn(u),h=b(!1),p=b({}),C=b(),_=b(!1),c=async P=>{await g(P)},S=()=>{if(!C.value)return;const{left:P}=C.value.getBoundingClientRect();p.value={bottom:window.innerHeight-8,left:P-ts},h.value=!0,r("deselectCell")},B=P=>{h.value=!1;const a=os.create({cmsSchemaField:P});r("addField",a)},A=()=>{v.value&&confirm("詳細フィールドをリセットしますか？")&&ns.resetDetailPageFields({cmsProjectId:i.value,schemaId:l.value,fields:d.value.fields})},F=(P,a)=>r("move",P,a);return tu(_),(P,a)=>{const m=te("PfRow"),q=te("PfSpacer"),$=te("PfIcon"),j=te("CanUse"),O=te("PfColumn");return n(),H(O,{class:Q([[s(pt)],"o-post-editor-right _overflow-y-auto _bg-gray-50 _p-16 _pb-64"]),h:"full"},{default:Z(()=>[R(m,{align:"center",class:"_p-8",gap:"8",w:"full"},{default:Z(()=>[e("p",Bu,E(P.$t("CMS:Property")),1),s(v)?(n(),y("button",{key:0,class:"_rounded-2 _bg-black _px-4 _py-2 _text-white hover:_bg-black",onClick:A}," Reset fields ")):D("",!0)]),_:1}),R(Yn,{content:s(u),fields:P.sortableFields,"show-border":!0},null,8,["content","fields"]),R(q,{direction:"column",size:"8"}),xu,R(Zn,{"auto-scroll-end-range":30,"auto-scroll-speed":3,"auto-scroll-start-range":30,"scroller-class":s(pt),class:"_w-full","handle-class":"knob",onMove:a[7]||(a[7]=w=>F(w.fromIndex,w.toIndex))},{default:Z(({dragging:w})=>[(n(!0),y(le,null,Ce(P.sortableFields,(x,G)=>(n(),H(Vo,{key:x.key,content:s(u),field:x,"is-dragging":w.isDragging&&G===w.index,"schema-id":l.value,onCreateAndLinkReference:c,onDeleteField:a[0]||(a[0]=z=>P.$emit("deleteField",z)),onEditCell:a[1]||(a[1]=z=>P.$emit("editCell",z)),onJumpTo:a[2]||(a[2]=z=>P.$emit("jumpTo",z)),onMoveSelectionTo:a[3]||(a[3]=z=>P.$emit("moveSelectionTo",z)),onSelectCell:a[4]||(a[4]=z=>P.$emit("selectCell",z)),onSubmitContent:a[5]||(a[5]=z=>P.$emit("onChangeField",z)),onUpdateFieldName:a[6]||(a[6]=z=>P.$emit("updateFieldName",z))},null,8,["content","field","is-dragging","schema-id"]))),128))]),_:1},8,["scroller-class"]),R(j,{permission:P.$_enum.PermissionType.ProductEditor},{default:Z(()=>[e("button",{ref_key:"addFieldRef",ref:C,style:{height:"48px"},class:"border-b-1 _flex _w-full _flex-none _flex-row _items-center _justify-start _gap-8 _overflow-hidden _px-8 _py-10",onClick:V(S,["stop"])},[R(m,{style:{width:"16px",height:"16px"},align:"center",justify:"center"},{default:Z(()=>[R($,{icon:"plus","icon-color":"gray-600",size:"16"})]),_:1}),e("span",Du,E(P.$t("CMS:Add property")),1)],512)]),_:1},8,["permission"]),R(j,{permission:P.$_enum.PermissionType.ProductEditor},{default:Z(()=>[(n(),H(Fe,{to:"#teleport-post-editor-overlay"},[R(Ne,null,{default:Z(()=>[h.value?(n(),y("div",{key:0,class:"_absolute _top-0 _left-0 _z-[100] _h-full _w-full",onClick:a[8]||(a[8]=V(w=>h.value=!1,["stop"])),onMouseover:a[9]||(a[9]=V(()=>{},["stop"]))},[R(es,{"dropdown-position":p.value,onSubmit:B},null,8,["dropdown-position"])],32)):D("",!0)]),_:1})]))]),_:1},8,["permission"])]),_:1},8,["class"])}}});const Hu=ie(Jo,[["__scopeId","data-v-1fbe477c"]]);Jo.__docgenInfo={exportName:"default",displayName:"PostEditorRight",description:"",tags:{},props:[{name:"content",required:!0,type:{name:"NewableCmsContent"}},{name:"isDraft",required:!0,type:{name:"boolean"}},{name:"schema",required:!0,type:{name:"CmsSchema"}},{name:"sortableFields",required:!0,type:{name:"Array",elements:[{name:"CmsSchemaField"}]}},{name:"userFields",required:!0,type:{name:"Array",elements:[{name:"CmsSchemaField"}]}}],events:[{name:"deleteField",type:{names:["string"]}},{name:"editCell",type:{names:["CmsContentCursorPosition"]}},{name:"jumpTo",type:{names:["RouteLocationRaw"]}},{name:"moveSelectionTo",type:{names:["CmsContentCursorMoveDirection"]}},{name:"selectCell",type:{names:["CmsContentCursorPosition"]}},{name:"onChangeField",type:{names:["Partial"],elements:[{name:"CmsContent"}]}},{name:"updateFieldName",type:{names:["{ fieldKey: string; newName: string }"]}},{name:"addField",type:{names:["CmsSchemaField"]}},{name:"deselectCell"},{name:"move",type:{names:["number"]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEditorRight.vue"]};const qu={class:"o-post-editor _flex _h-full _w-full _flex-col _bg-white"},Lu={key:0,class:"_flex _w-full _flex-1 _overflow-y-auto _overflow-x-hidden"},Uu={class:"left-block _relative"},Ou={class:"container"},Qo=ee({__name:"PostEdit",props:{newableContent:{},isNewContent:{type:Boolean},progress:{type:Boolean},schema:{}},emits:["addField","close","deleteContent","deleteField","duplicateContent","submit","updateFields"],setup(t,{emit:f}){const o=t,r=f,u=cs(),{newableContent:d,schema:l}=he(o),v=T(()=>l.value.id),i=T(()=>d.value.id),g=ss("modal"),{deselectCell:h,editCell:p,mode:C,selectCell:_,selectedCursorPosition:c}=ls(v),S=as(),{moveDirection:B}=_t(S),{fieldKeyList:A,sortableFields:F,updateDetailPageFieldOrders:P,updateFieldName:a}=eu(v),{handleRef:m,isChangingPostEditRightWidth:q,changedPostEditRightWidth:$,resetPostEditRightWidth:j}=Ds();Es();const O=b(We),w=b(!0),x=b([]),G=b([]),z=b([]),re=T(()=>l.value.fields),L=T(()=>d.value?.body||""),M=T(()=>re.value.find(k=>k.key==="title")),I=T(()=>re.value.find(k=>k.key==="body")),U=T(()=>!d.value._meta||d.value._meta.publishType==="draft"),W=T(()=>d.value?._collaboration?.default),J=T(()=>!!d.value._meta&&it.isPublishTypeSchedule(d.value._meta)),ne=()=>{w.value=!w.value},ye=k=>r("submit",k),ue=async k=>{G.value=G.value.filter(K=>K.key!==k),r("deleteField",k)},pe=async(k,K)=>{z.value=await P(k,K);const de=G.value[k];G.value.splice(k,1),G.value.splice(K,0,de),r("updateFields",[...x.value,...G.value])},oe=k=>{G.value.push(k);const K=[...x.value,...G.value];r("addField",k,K)},ae=k=>{u.push(k)},fe=({fieldKey:k})=>{const K=document.querySelector(`.${pt}`),de=document.querySelector(`[data-post-editor-field-key="${k}"]`),{top:ge,bottom:be}=de.getBoundingClientRect(),{top:Se,bottom:Re}=K.getBoundingClientRect();let Je=0;ge<Se?Je=ge-Se:Re-be<10&&(Je=10-(Re-be)),K.scrollBy({top:Je,behavior:"smooth"})},ve=k=>l.value.fields.find(de=>de.key===k)?.type==="boolean",N=async k=>{await _(k),fe(k)},Y=async k=>{const{fieldKey:K}=k,de=ve(K);await p(k,de,async()=>{const be=d.value[K];await r("submit",{[K]:!be})}),B.value&&(_e(B.value),S.$reset())},_e=k=>{if(C.value==="editing")throw new Error("開発者向けのエラー: mode を selecting にした状態で呼び出してください");const{contentId:K,fieldKey:de}=c.value,ge=A.value.indexOf(de);if(ge===-1){h();return}k==="up"?ge>0&&N({contentId:K,fieldKey:A.value[ge-1]}):k==="down"&&ge<A.value.length-1&&N({contentId:K,fieldKey:A.value[ge+1]})};return is({passive:!1,onEventFired(k){k.type==="keydown"&&C.value==="selecting"?["ArrowUp","ArrowDown"].includes(k.key)?(k.preventDefault(),_e(ds.createByKeyboard(k.key))):k.key==="Tab"?(k.preventDefault(),_e(k.shiftKey?"up":"down")):k.key==="Enter"?(k.preventDefault(),ve(c.value.fieldKey)&&S.setMoveDirection("down"),Y(c.value)):k.key==="Escape"&&h():k.type==="keydown"&&C.value==="editing"&&k.key==="Escape"&&N(c.value)}}),X(g,()=>{h()}),X(re,k=>{x.value=k.filter(K=>K._system),G.value=k.filter(K=>!K._system)},{immediate:!0}),X(F,k=>{z.value=k},{immediate:!0}),X(w,k=>{k?(j(),O.value=We):O.value=0}),X($,k=>{O.value=k}),nu(C),su(c),(k,K)=>{const de=te("PfIcon"),ge=Me("click-outside");return n(),y("div",qu,[R(xo,{"is-new-content":k.isNewContent,"newable-content":s(d),schema:s(l),onClose:K[0]||(K[0]=be=>k.$emit("close")),onDeleteContent:K[1]||(K[1]=be=>k.$emit("deleteContent")),onDuplicateContent:K[2]||(K[2]=be=>k.$emit("duplicateContent"))},null,8,["is-new-content","newable-content","schema"]),s(d)?(n(),y("div",Lu,[e("div",Uu,[e("div",Ou,[M.value?(n(),H(qd,{key:0,field:M.value,"is-scheduled":J.value,value:s(d)[M.value.key],class:"main-title",onChange:K[3]||(K[3]=be=>ye({[M.value.key]:be}))},null,8,["field","is-scheduled","value"])):D("",!0),I.value?(n(),H(Hd,{key:1,collaboration:W.value&&W.value[I.value.key],"content-id":i.value,field:I.value,"is-scheduled":J.value,"schema-id":v.value,value:L.value,class:"main-body",onInput:K[4]||(K[4]=be=>k.$emit("submit",be))},null,8,["collaboration","content-id","field","is-scheduled","schema-id","value"])):D("",!0)]),s(d)._meta?.updatedAt?(n(),y("div",{key:0,style:se({right:`${O.value+24}px`,bottom:"20px"}),class:Q(["update _fixed",[!w.value&&"wide"]])},[R(rs,{progress:k.progress,"updated-at":s(d)._meta.updatedAt},null,8,["progress","updated-at"])],6)):D("",!0)]),e("div",{class:Q([[s(q)&&"isChangingWidth"],"post-editor-right _relative _bg-gray-50"]),style:se({width:`${O.value}px`})},[e("button",{class:"handle hover:bg-gray _flex _flex-row _items-center _rounded-6 _transition",onClick:ne},[e("span",{class:Q([w.value&&"active"])},[R(de,{icon:"propertyClose","icon-color":"black",size:"16"})],2)]),w.value?(n(),y("span",{key:0,ref_key:"handleRef",ref:m,class:Q([[s(q)&&"isChangingWidth"],"grip _h-full _cursor-col-resize"]),onClick:K[5]||(K[5]=V(()=>{},["prevent","stop"])),onMousedown:K[6]||(K[6]=V(()=>{},["prevent","stop"]))},null,34)):D("",!0),w.value?me((n(),H(Hu,{key:1,content:s(d),"is-draft":U.value,schema:s(l),"sortable-fields":z.value,"user-fields":G.value,onMove:pe,onAddField:oe,onDeleteField:ue,onDeselectCell:s(h),onEditCell:Y,onJumpTo:ae,onOnChangeField:ye,onSelectCell:N,onUpdateFieldName:s(a)},null,8,["content","is-draft","schema","sortable-fields","user-fields","onDeselectCell","onUpdateFieldName"])),[[ge,s(h)]]):D("",!0)],6)])):D("",!0)])}}});const Zu=ie(Qo,[["__scopeId","data-v-65c38293"]]);Qo.__docgenInfo={exportName:"default",displayName:"PostEdit",description:"",tags:{},props:[{name:"newableContent",required:!0,type:{name:"NewableCmsContent"}},{name:"isNewContent",required:!0,type:{name:"boolean"}},{name:"progress",required:!0,type:{name:"boolean"}},{name:"schema",required:!0,type:{name:"CmsSchema"}}],events:[{name:"close"},{name:"deleteContent"},{name:"duplicateContent"},{name:"submit",type:{names:["Partial"],elements:[{name:"CmsContent"}]}},{name:"addField",type:{names:["CmsSchemaField"]}},{name:"deleteField",type:{names:["string"]}},{name:"updateFields",type:{names:["Array"],elements:[{name:"CmsSchemaField"}]}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Cms/content-detail/PostEdit.vue"]};export{Zu as P};
