import{f as P,x as U,e as w,b as A,a7 as H,G as l,H as n,K as p,J as m,A as s,U as L,_ as $,F as q,Z as z,W as J,S as f,N as W}from"./vue.esm-bundler-33967e91.js";import{G as Z,ar as o,a1 as y,bR as Q}from"./ModalPvLimitAlertView-cb9178ae.js";import{N as X}from"./NodeCardBackground-e1c3a5e9.js";import{b as Y,e as ee,f as ae}from"./Editor-e2ebb077.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";import"./vue-i18n.cjs-bd62fc86.js";import"./_commonjsHelpers-042e6b4d.js";import"./ModalUpgradeRequired-a455cfd7.js";import"./BasicModal-000dc82b.js";import"./PfButton-db6d6722.js";import"./PfIconContext-bd54ca9b.js";import"./lodash-bf1bac5c.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./iframe-4066d2cc.js";import"../sb-preview/runtime.js";import"./PfIcon-bb1c3c10.js";import"./mapValues-a1d744f5.js";import"./SelectSwitch-b6107958.js";import"./tiptap-extension-paragraph.esm-72054cce.js";import"./draggable-203bb716.js";import"./ApiIcon-4990672b.js";import"./useSearch-b8b0ad67.js";const oe={class:"label"},re={key:0,class:"menu"},se={class:"selections"},le=["onClick"],ne={class:"selection-label"},_=P({__name:"NodeCardVariableKey",props:{node:{}},setup(N){const b=N;Z();const{node:e}=U(b),{allNodes:g,findNode:k,findParent:C,updateNode:h,isUsed:V,draggingNode:i,findChildIds:B,hasParent:x,replaceNode:K}=Y(),{nodeResult:D}=ee(w(()=>e.value.id)),{scopeData:c}=ae(),I=o(()=>{const a=String(e.value.value).replace(".value",""),t=g.value.find(r=>(r.type==="variable"||r.type==="argument")&&r.value===a);return t?t.label:y.getNameFromKey(a,c.value)}),R=o(()=>{const a=String(e.value.value).replace(".value","");return y.getTypeFromKey(a,c.value)||typeof D.value}),v=o(()=>C(e.value.id)),S=o(()=>Q(c.value,v.value?.value??"")),F=o(()=>{const a=v.value?.children||[],t=a.indexOf(e.value.id);return a.slice(0,t).map(r=>k(r)?.value)}),M=o(()=>F.value.reduce((a,t)=>a&&a[t],S.value)),E=o(()=>Object.keys(M.value||{})),T=a=>{u.value=!1;const t=e.value.type==="variableIndex"?parseInt(a,10):a;h(e.value.id,{value:t})},u=A(!1),j=()=>{u.value=!1},G=o(()=>V(e.value.id)&&i.value?i.value.id===e.value.id||B(i.value.id).includes(e.value.id)||!x(e.value.id)?!1:/number|variable/.test(e.value.type):!1),O=()=>{K(e.value,i.value)};return(a,t)=>{const r=H("click-outside");return l(),n("div",{class:W(["NodeCardVariableKey",[s(e).type]]),onDblclick:t[0]||(t[0]=d=>u.value=!0)},[p("span",oe,m(s(I)),1),L(X,{node:s(e),"value-type":s(R)},null,8,["node","value-type"]),u.value?$((l(),n("div",re,[p("div",se,[(l(!0),n(q,null,z(s(E),d=>(l(),n("div",{key:d,class:"selection",onClick:J(ie=>T(d),["stop"])},[p("p",ne,m(d),1)],8,le))),128))])])),[[r,j]]):f("",!0),s(G)?(l(),n("div",{key:1,class:"replace-droppable",onMouseup:O},null,32)):f("",!0)],34)}}});const Se=te(_,[["__scopeId","data-v-3c0a5398"]]);_.__docgenInfo={exportName:"default",displayName:"NodeCardVariableKey",description:"",tags:{},props:[{name:"node",required:!0,type:{name:"BlueprintNode"}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/BlueprintEditor/NodeCard/NodeCardVariableKey.vue"]};export{Se as default};
