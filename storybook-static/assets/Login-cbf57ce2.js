import{c as H,_ as Q,P as z,u as Y,s as Z,d as J,e as X,C as U,f as v,g as A,S as ee,l as se,j as oe,h as te,k as ae,m as ie,n as re}from"./ModalPvLimitAlertView-cb9178ae.js";import{u as ne}from"./vue-i18n.cjs-bd62fc86.js";import{u as le,a as ce}from"./ModalUpgradeRequired-a455cfd7.js";import{_ as de}from"./PfButton-db6d6722.js";import{f as ue,b as r,e as me,a1 as _e,O as m,G as $,H as T,K as o,J as l,I as p,U as d,R as g,W as pe,_ as I,$ as ge,N as F,S as R,a0 as fe}from"./vue.esm-bundler-33967e91.js";import{_ as he}from"./_plugin-vue_export-helper-c27b6911.js";import"./BasicModal-000dc82b.js";import"./_commonjsHelpers-042e6b4d.js";import"./lodash-bf1bac5c.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./iframe-4066d2cc.js";import"../sb-preview/runtime.js";import"./PfIcon-bb1c3c10.js";import"./PfIconContext-bd54ca9b.js";import"./mapValues-a1d744f5.js";const B=ue({components:{LanguageLink:H,PfButton:de,PfPasswordVisibleToggleButton:Q,PrivacyPolicyText:z},setup(){const e=le(),t=ce(),{locale:w}=ne(),{account:b}=Y(),{device:E,os:P}=Z(J()),{fetchCountryCodeFromIp:_}=ae(),f=X([U]),u=v("token"),y=v("client_id"),c=v("redirect_url"),k=v("state"),i=r(!1),N=r(e.query.error==="facebook"),L=r({email:"",password:""}),G=r({email:!1,password:!1}),h=r(!1),C=r(null),D=r(!1),S=r(!1),O=r(""),j=r(!1),M=()=>{const a=document.createElement("script");a.setAttribute("src","https://www.google.com/recaptcha/api.js?render=6LewsbwUAAAAAMtWVUfjTZ-1_9H7mMauwoXvZTlQ"),document.head.appendChild(a)},V=()=>{A(window)!==""&&t.push({query:{[ee]:A(window)}})},W=async()=>{h.value=!0,C.value=null,se.emailLogin({email:L.value.email,password:L.value.password,token:u.value??void 0,redirectUrl:c.value??void 0}).then(async a=>{if(h.value=!1,await oe.update(a.data.oneTimeToken),a.data.redirectUrl?.startsWith("https://studio.design")){location.href=a.data.redirectUrl;return}await t.push({path:a.data.redirectUrl}),setTimeout(()=>{te.signedIn({accountId:b.value.id,certificationType:"email",device:E.value?.type||"",email:b.value.email,os:P.value?.name||"",osVersion:P.value?.version||""})},3e3)}).catch(()=>{h.value=!1,C.value="The email address or password is incorrect."})},q=async()=>{D.value=!0;const a=await _(),s=new URL("https://api.studiodesignapp.com/api/v2/facebook/login");s.searchParams.set("token",u.value??""),s.searchParams.set("language",w.value),s.searchParams.set("country_code",a??""),s.searchParams.set("redirect_url",c.value??"");const n=f.get(U);s.searchParams.set("utm_source",n?.utm_source??""),s.searchParams.set("utm_medium",n?.utm_medium??""),s.searchParams.set("utm_campaign",n?.utm_campaign??""),s.searchParams.set("via",n?.via??""),location.href=s.href},x=async()=>{S.value=!0;const a=await _(),s=new URL("https://api.studiodesignapp.com/api/v2/google/login");s.searchParams.set("token",u.value??""),s.searchParams.set("language",w.value),s.searchParams.set("client_id",y.value??""),s.searchParams.set("redirect_url",c.value??""),s.searchParams.set("state",k.value??""),s.searchParams.set("country_code",a??"");const n=f.get(U);s.searchParams.set("utm_source",n?.utm_source??""),s.searchParams.set("utm_medium",n?.utm_medium??""),s.searchParams.set("utm_campaign",n?.utm_campaign??""),s.searchParams.set("via",n?.via??""),location.href=s.href},K=me(()=>c.value?`/signup?redirect_url=${encodeURIComponent(c.value)}`:"/signup");return V(),M(),_e(()=>{V()}),{fb_error:N,token:u,postData:L,validation:G,isEmailLoading:h,emailError:C,isFbLoading:D,isGoogleLoading:S,reCaptchaToken:O,checkboxValue:j,loginWithEmail:W,clickFacebook:q,clickGoogle:x,isPasswordVisible:i,signupUrl:K}}}),ve={class:"_flex _flex-col _items-center _gap-24 tablet:_gap-40"},we={class:"_heading-md tablet:_heading-lg"},be={class:"_mb-40 _flex _w-full _max-w-login _flex-col _items-center _justify-center _gap-32 tablet:_w-login"},Pe={class:"_flex _w-full _flex-col _items-stretch _justify-center _gap-16"},ye=o("img",{width:"20",height:"20",src:ie,class:"_absolute _left-14"},null,-1),ke=o("img",{width:"18",height:"18",src:re,class:"_absolute _left-14",alt:"google icon"},null,-1),Le={class:"_flex _flex-col _items-stretch _gap-8"},Ce={for:"email"},Ue=["placeholder"],$e={key:0,class:"_text-sm _text-const-red-500"},Te={class:"_flex _flex-col _items-stretch _gap-8"},Ee={for:"password"},De=["placeholder","type"],Se={key:0,class:"_text-sm _text-const-red-500"},Ve={class:"_flex _gap-16"};function Ae(e,t,w,b,E,P){const _=m("PfButton"),f=m("PfPasswordVisibleToggleButton"),u=m("PfRow"),y=m("PrivacyPolicyText"),c=m("LanguageLink"),k=m("PfDivider");return $(),T("div",ve,[o("h1",we,l(e.$t("Login: Sign in")),1),o("div",be,[o("div",Pe,[o("button",{class:"_relative _flex _h-44 _flex-row _items-center _rounded-6 _bg-[#1A77F2] _text-md _font-bold _text-white hover:_bg-[#2A6DDC]",onClick:t[0]||(t[0]=(...i)=>e.clickFacebook&&e.clickFacebook(...i))},[ye,p(" "+l(e.$t("Login with Facebook")),1)]),d(_,{variant:"outline",class:"_relative",loading:e.isGoogleLoading,onClick:e.clickGoogle},{default:g(()=>[ke,p(" "+l(e.$t("Login with Google")),1)]),_:1},8,["loading","onClick"])]),o("form",{class:"_flex _w-full _flex-col _items-stretch _gap-16",onSubmit:t[4]||(t[4]=pe((...i)=>e.loginWithEmail&&e.loginWithEmail(...i),["prevent"]))},[o("div",Le,[o("label",Ce,l(e.$t("Login: Email address")),1),I(o("input",{id:"email","onUpdate:modelValue":t[1]||(t[1]=i=>e.postData.email=i),class:F(["_h-44 _rounded-6 _border-1 _border-solid _border-const-gray-100 _bg-const-white _px-16",e.emailError?["_border-const-red-500","_bg-const-red-50"]:[]]),placeholder:e.$t("Login: Enter your email address"),type:"email",name:"email",required:""},null,10,Ue),[[ge,e.postData.email]]),e.emailError?($(),T("p",$e,l(e.$t(`LoginError: ${e.emailError}`)),1)):R("",!0)]),o("div",Te,[o("label",Ee,l(e.$t("Login: Password")),1),d(u,{align:"center",class:"_relative",w:"full"},{default:g(()=>[I(o("input",{id:"password","onUpdate:modelValue":t[2]||(t[2]=i=>e.postData.password=i),class:F(["_h-44 _w-full _rounded-6 _border-1 _border-solid _border-const-gray-100 _bg-const-white _px-16",e.validation.password?["_border-const-red-500","_bg-const-red-50"]:[]]),placeholder:e.$t("Login: Enter your password"),type:e.isPasswordVisible?"text":"password",name:"password",required:""},null,10,De),[[fe,e.postData.password]]),e.validation.password?($(),T("p",Se,"Error message.")):R("",!0),d(f,{"is-password-visible":e.isPasswordVisible,class:"_absolute _right-12",onClick:t[3]||(t[3]=i=>e.isPasswordVisible=!e.isPasswordVisible)},null,8,["is-password-visible"])]),_:1})]),d(_,{size:"md","button-type":"submit",disabled:!(e.postData.email&&e.postData.password),loading:e.isEmailLoading},{default:g(()=>[p(l(e.$t("Login: Sign in")),1)]),_:1},8,["disabled","loading"])],32),d(y,{class:"_w-full"}),o("div",Ve,[d(c,{class:"label-sm-bold hover:_text-const-gray-800",to:"/login/recover"},{default:g(()=>[p(l(e.$t("Login: Forgot password?")),1)]),_:1}),d(k,{direction:"row"}),d(c,{class:"label-sm-bold hover:_text-const-gray-800",to:e.signupUrl},{default:g(()=>[p(l(e.$t("Login: New to STUDIO? Sign up")),1)]),_:1},8,["to"])])])])}const ze=he(B,[["render",Ae]]);B.__docgenInfo={exportName:"default",displayName:"Login",description:"",tags:{},sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/Login/Login.vue"]};export{ze as default};
