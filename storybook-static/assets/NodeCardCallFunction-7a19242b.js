import{f as G,G as r,H as u,K as C,N as c,A as a,J,F as O,Z as R,U as f,Q as T,S as F}from"./vue.esm-bundler-33967e91.js";import{u as q}from"./vue-i18n.cjs-bd62fc86.js";import{N as z}from"./NodeCardBackground-e1c3a5e9.js";import{V as K}from"./ValueInput-7a78c064.js";import{g as Q,b as W,f as Z,N as $}from"./Editor-e2ebb077.js";import{ar as l,h4 as X}from"./ModalPvLimitAlertView-cb9178ae.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";import"./_commonjsHelpers-042e6b4d.js";import"./ModalUpgradeRequired-a455cfd7.js";import"./BasicModal-000dc82b.js";import"./PfButton-db6d6722.js";import"./PfIconContext-bd54ca9b.js";import"./lodash-bf1bac5c.js";import"./SelectSwitch-b6107958.js";import"./tiptap-extension-paragraph.esm-72054cce.js";import"./PfIcon-bb1c3c10.js";import"./iframe-4066d2cc.js";import"../sb-preview/runtime.js";import"./draggable-203bb716.js";import"./ApiIcon-4990672b.js";import"./useSearch-b8b0ad67.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./mapValues-a1d744f5.js";const ee={key:0,class:"node-frame"},ne={key:0,class:"node-frame"},k=G({__name:"NodeCardCallFunction",props:{node:{}},setup(x){const N={"$fn.stringSplit":[{type:"string",label:"text",valueNode:null},{type:"string",label:"splitter",valueNode:null}],"$fn.numberToFixed":[{type:"number",label:"num",valueNode:null},{type:"number",label:"digits",valueNode:null}],"$fn.mathPow":[{type:"number",label:"x",valueNode:null},{type:"number",label:"y",valueNode:null}],"$fn.mathMin":[{type:"number",label:"x",valueNode:null},{type:"number",label:"y",valueNode:null}],"$fn.mathMax":[{type:"number",label:"x",valueNode:null},{type:"number",label:"y",valueNode:null}],"$fn.mathLog":[{type:"number",label:"x",valueNode:null}]},o=x,B=q(),{getLabelFromRm:I}=Q(),{findNode:d,findParent:M,selectedNodeId:y,draggingNode:i,updateNode:p}=W(),{scopeData:g}=Z(),b=l(()=>{const e=o.node.value;if(e.startsWith("$fn."))return N[e]?N[e].map((t,n)=>({...t,valueNode:d(node.value.args[n])})):[{label:"arg1",type:"any",valueNode:d(node.value.args[0])}];{const t=e.replace(".func",""),n=g.value[t]?.__def__.nodeId;return n?d(n).args.map((s,j)=>{const h=d(s),H=d(h.args[0]);return{label:h.label,type:H.value,valueNode:d(node.value.args[j])}}):[]}}),S=l(()=>node.value.args.map(e=>d(e))),P=l(()=>{const e=M(o.node.id);return!(e&&e.type==="pipeline"&&e.children.indexOf(node.value.id)>0)}),V=l(()=>node.value.children.map(e=>d(e))),w=l(()=>i.value?.id===o.node.id?!1:node.value.id===y.value||node.value.args.includes(y.value)),A=(e,t)=>{p(e,{position:null});const n=b.value.map((v,s)=>s===t?e:node.value.args[s]||null);p(node.value.id,{args:n})},D=()=>{i.value&&i.value.id!==o.node.id&&(p(i.value.id,{position:null}),p(o.node.id,{children:[i.value.id]}))},E=l(()=>S.value[0]),m=l(()=>V.value[0]),_=l(()=>o.node.value==="$fn.arrayMap"||o.node.value==="$fn.arrayFilter"),L=l(()=>o.node.value.indexOf("$fn.array")!=-1),U=l(()=>{const e=B.locale.value==="JP"?"ja":"default",t=X.find(n=>`$fn.${n.name}`===o.node.value);return t?t.label[e]:I(o.node.value||"",g.value)});return(e,t)=>(r(),u("div",{class:c(["NodeCardCallFunction",{canSelectChildren:a(w)}])},[C("div",{class:c(["self",{enableChildren:a(_)}])},[C("span",{class:c(["operator-label",{isArrayFunction:a(L)}])},J(a(U)),3),a(P)?(r(),u("div",{key:0,class:c(["args-container",{hasChild:a(E)}])},[(r(!0),u(O,null,R(a(b),(n,v)=>(r(),u("div",{key:n.label,class:"arg-item"},[n.valueNode?(r(),u("div",ee,[f($,{node:n.valueNode},null,8,["node"])])):(r(),T(K,{key:1,node:e.node,"allow-type":n.type,onUpdate:s=>A(s,v)},null,8,["node","allow-type","onUpdate"]))]))),128))],2)):F("",!0)],2),a(_)?(r(),u("div",{key:0,class:c(["children-container",{hasChild:a(m)}])},[a(m)?(r(),u("div",ne,[f($,{node:a(m)},null,8,["node"])])):(r(),u("div",{key:1,class:"node-empty",onMouseup:D},null,32))],2)):F("",!0),f(z,{node:e.node},null,8,["node"])],2))}});const ke=Y(k,[["__scopeId","data-v-3e7c92d9"]]);k.__docgenInfo={exportName:"default",displayName:"NodeCardCallFunction",description:"",tags:{},props:[{name:"node",required:!0,type:{name:"BlueprintNode"}}],sourceFiles:["/Users/h.kamiyama/GitHub/studio-front/src/components/BlueprintEditor/NodeCard/NodeCardCallFunction.vue"]};export{ke as default};
